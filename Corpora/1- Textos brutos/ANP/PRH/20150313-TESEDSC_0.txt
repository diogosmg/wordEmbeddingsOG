(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:2)(cid:3)(cid:2)(cid:0)(cid:4)(cid:2)(cid:0)(cid:5)(cid:6)(cid:7)(cid:8)(cid:6)(cid:9)(cid:10)(cid:4)(cid:6)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:3)(cid:7)(cid:8)(cid:3)(cid:8)(cid:9)(cid:10)(cid:7)(cid:11)(cid:4)(cid:5)(cid:12)(cid:13)(cid:1)(cid:8)(cid:2)(cid:5)(cid:8)(cid:9)(cid:1)(cid:4)(cid:11)(cid:14)(cid:10)(cid:4)(cid:10)(cid:2)(cid:5)(cid:2)(cid:3)(cid:8)(cid:2)(cid:3)(cid:8)(cid:9)(cid:5)(cid:10)(cid:15)(cid:8)(cid:3)(cid:7)(cid:8)(cid:9)(cid:10)(cid:15)(cid:16)(cid:3)(cid:7)(cid:5)(cid:15)(cid:8)(cid:17)(cid:18)(cid:11)(cid:1)(cid:15)(cid:1)(cid:15)(cid:8)(cid:19)(cid:1)(cid:7)(cid:8)(cid:0)(cid:1)(cid:20)(cid:1)(cid:3)(cid:16)(cid:10)(cid:4)(cid:3)(cid:20)(cid:1)(cid:6)(cid:4)(cid:10)(cid:19)(cid:1)(cid:4)(cid:8)(cid:8)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:2)(cid:3)(cid:4)(cid:0)(cid:5)(cid:6)(cid:7)(cid:6)(cid:3)(cid:8)(cid:2)(cid:0)(cid:9)(cid:6)(cid:10)(cid:8)(cid:11)(cid:12)(cid:2)(cid:0)(cid:12)(cid:13)(cid:0)(cid:14)(cid:15)(cid:16)(cid:17)(cid:13)(cid:16)(cid:10)(cid:11)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:18)(cid:11)(cid:8)(cid:11)(cid:15)(cid:19)(cid:0)(cid:20)(cid:6)(cid:21)(cid:22)(cid:2)(cid:0)(cid:12)(cid:13)(cid:0)(cid:23)(cid:24)(cid:25)(cid:26)(cid:0)José Augusto Furtado de Oliveira

Modelagem e Simulação da Solubilidade de Sais em

Sistemas Aquosos com Monoetilenoglicol

Tese de Doutorado apresentada ao Pro-
grama de Pós-Graduação em Engenharia Quí-
mica (PPGEQ), da Universidade Federal do
Rio Grande do Norte (UFRN), como parte
dos requisitos necessários para a obtenção
do título de Doutor em Engenharia Química,
sob a orientação do Prof. Dr. Osvaldo Chia-
vone Filho e coorientação do Prof. Dr. Afonso
Avelino Dantas Neto.

Natal/RN
Junho/2014

UFRN / Biblioteca Central Zila Mamede

Catalogação da Publicação na Fonte

Modelagem e Simulação da Solubilidade de Sais em Sistemas Aquosos com

Monoetilenoglicol / José Augusto Furtado de Oliveira. - Natal, 2014.

Oliveira, José Augusto Furtado de.

176 p.; il.

Orientador: Prof. Dr. Osvaldo Chiavone Filho
Coorientador: Prof. Dr. Afonso Avelino Dantas Neto

Tese de Doutorado - Universidade Federal do Rio Grande do Norte.
Centro de Tecnologia. Departamento de Engenharia Química. Programa de
Pós-Graduação em Engenharia Química.

1. Solubilidade - Tese. 2. Eletrólitos - Tese. 3. Monoetilenoglicol - Tese.
4. Mistura de Solventes - Tese. 5. Processamento de Gás Natural - Tese.
6. Python - Tese. I. Chiavone Filho, Osvaldo. II. Dantas Neto, Afonso Avelino.
III. Universidade Federal do Rio Grande do Norte. IV. Título.

RN/UF/BCZM

CDU 544.77.051.7

Resumo

OLIVEIRA, José Augusto Furtado de - Modelagem e Simulação da Solubilidade
de Sais em Sistemas Aquosos com Monoetilenoglicol. Tese de Doutorado, Universidade
Federal do Rio Grande do Norte (UFRN), Programa de Pós-Graduação em Engenharia
Química (PPGEQ), Natal/RN, Brasil. Área de Concentração: Engenharia de Processos.
Orientador: Prof. Dr. Osvaldo Chiavone Filho
Coorientador: Prof. Dr. Afonso Avelino Dantas Neto

O processamento primário do gás natural em plataformas como a do Campo de Mexilhão
(PMXL-1) na Bacia de Santos, onde o Monoetileno glicol (MEG) tem sido utilizado
como inibidor da formação de hidratos, apresenta problemas operacionais causados por
incrustações de sal na unidade de recuperação do MEG. Pesquisa bibliográﬁca e análise
dos dados de solubilidade de sal em misturas de solventes, a saber: água e MEG, revelam
que estudos experimentais estão disponíveis para um número relativamente restrito das
espécies iônicas presentes na água produzida, tais como NaCl e KCl. O objetivo deste
trabalho foi desenvolver um método de cálculo para a solubilidade de um sal em misturas
de solventes, neste caso, para o NaCl ou KCl em misturas aquosas contendo MEG. O
método de cálculo estendeu o modelo de Pitzer, com a abordagem de Lorimer, para
sistemas aquosos contendo um sal e um outro solvente (MEG). A linguagem Python no
ambiente de desenvolvimento integrado (IDE) Eclipse foi usada na criação de aplicativos
computacionais. Os resultados indicam a viabilidade da modelagem proposta para uma
série de dados de solubilidade do sal (NaCl ou KCl) em misturas de água e MEG. Além
disso, o aplicativo desenvolvido em Python tem demonstrado ser adequado para estimação
de parâmetros e de simulação.

Palavras-chave: solubilidade. eletrólitos. monoetilenoglicol. mistura de solventes. proces-
samento de gás natural. Python.

José Augusto Furtado de Oliveira

Modelagem e Simulação da Solubilidade de Sais em

Sistemas Aquosos com Monoetilenoglicol

Tese de Doutorado apresentada ao Pro-
grama de Pós-Graduação em Engenharia Quí-
mica (PPGEQ), da Universidade Federal do
Rio Grande do Norte (UFRN), como parte
dos requisitos necessários para a obtenção do
título de Doutor em Engenharia Química.

Trabalho aprovado. Natal, 02 de Junho de 2014:

Prof. Dr. Osvaldo Chiavone Filho

Orientador - UFRN

Prof. Dr. Afonso Avelino Dantas

Neto

Coorientador - UFRN

Prof. Dr. Edson Luiz Foletto

Membro Externo - UFSM

Prof. Dr. André Luís Novais Mota

Membro Externo - UFERSA

Prof. Dr. Humberto Neves Maia de

Oliveira

Membro Interno - UFRN

Drª. Dannielle Janainne da Silva

Membro Interno - UFRN

Abstract

OLIVEIRA, José Augusto Furtado de - Modeling and Simulation of the Solubility
of Salts in Aqueous Systems with Monoethyleneglycol. Doctoral Thesis, Federal University
of Rio Grande do Norte (UFRN), Program of Postgraduation in Chemical Enginner-
ing (PPGEQ), Natal/RN, Brazil. Concentration Area: Process Engineering.
Supervisor: Prof. Dr. Osvaldo Chiavone Filho
Joint Supervisor: Prof. Dr. Afonso Avelino Dantas Neto

Primary processing of natural gas platforms as Mexilhão Field (PMXL-1 ) in the Santos
Basin, where monoethylene glycol (MEG) has been used to inhibit the formation of
hydrates, present operational problems caused by salt scale in the recovery unit of MEG.
Bibliographic search and data analysis of salt solubility in mixed solvents, namely water
and MEG, indicate that experimental reports are available to a relatively restricted number
of ionic species present in the produced water, such as NaCl and KCl. The aim of this study
was to develop a method for calculating of salt solubilities in mixed solvent mixtures, in
explantion, NaCl or KCl in aqueous mixtures of MEG. The method of calculating extend
the Pitzer model, with the approach Lorimer, for aqueous systems containing a salt and
another solvent (MEG). Python language in the Integrated Development Environment
(IDE) Eclipse was used in the creation of the computational applications. The results
indicate the feasibility of the proposed calculation method for a systematic series of salt
(NaCl or KCl) solubility data in aqueous mixtures of MEG at various temperatures.
Moreover, the application of the developed tool in Python has proven to be suitable for
parameter estimation and simulation purposes.

Keywords: solubility. electrolytes. monoethyleneglycol. mixture of solvents. natural gas
processing. Python.

Dedico este trabalho à minha esposa Marizete de Melo Oliveira e aos meus ﬁlhos,

Jéssica de Melo Oliveira e Samuel Furtado de Oliveira,

cuja simples existência faz tudo valer a pena!

Agradecimentos

Ao Senhor Jesus, em primeiro lugar, por TUDO! Sem Ele nada seria possível e realizável!
À minha esposa Marizete e meus ﬁlhos, Jéssica e Samuel, pelo AMOR!
À minha mãe, Eudézia, pela EDUCAÇÃO e SUPORTE, além do natural para uma mãe,
que foram-me dados!
À Agência Nacional do Petróleo, Gás Natural e Biocombustíveis (ANP) pelo APOIO
FINANCEIRO.
Ao Centro de Pesquisas da Petrobras (CENPES) pela formação do grupo de PESQUISA
do MEG no Laboratório de Fotoquímica e Equilíbrio de Fases (FOTEQ).
Ao Prof. Osvaldo Chiavone Filho pela ORIENTAÇÃO e DEDICAÇÃO no desenvolvimento
desta tese de doutorado.
Ao Prof. Afonso Avelino Dantas Neto pelo APOIO junto ao Programa de Recursos
Humanos ANP-14 (PRH ANP-14).
Ao Prof. Eduardo Lins de Barros Neto pelo INCENTIVO.
Ao Prof. Humberto Neves Maia de Oliveira pelo "CAFEZINHO"!
Ao Prof. José Romualdo Dantas Vidal e Maria Carlenise Paiva de Alencar Moura pelo
ESTÍMULO e AMIZADE.
À Maria José de Sousa Brunet pela PACIÊNCIA e RAPIDEZ nas diversas solicitações de
vital importância deste projeto.
À Profª Márcia Maria Lima Duarte pela COMPREENSÃO.
À Eusamar Coelho de Lima e à José Medeiros dos Santos pela AMIZADE e pelo APOIO
ADMINISTRATIVO rápido e eﬁciente.
Ao aluno de iniciação cientíﬁca Bruno Dezan Samorini pela EFICIÊNCIA.
Ao pessoal do Núcleo de Ensino e Pesquisa em Petróleo e Gás (NUPEG) e do laboratório
de Fotoquímica e Equilíbrio de Fases (FOTEQ) pelo COLEGUISMO.
E a todos que, embora não citados aqui, COLABORARAM de forma direta ou indireta
para o desenvolvimento desta tese de doutorado. MUITÍSSIMO OBRIGADO!

.

“Tudo tem o seu tempo determinado, e há
tempo para todo o propósito debaixo do céu.
(Bíblia ACF, Eclesiastes 3:1)

Sumário

1
1.1
1.2
1.3
1.4
1.5
1.6
1.7

2
2.1
2.1.1
2.1.2
2.1.3
2.1.4
2.1.5
2.1.6
2.1.7
2.2
2.3
2.3.1
2.3.2
2.3.3
2.4
2.5

3
3.1
3.2
3.3
3.4
3.5
3.5.1
3.5.2
3.6
3.6.1

INTRODUÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Atividade de Produção no Campo de Mexilhão . . . . . . . . . . . .
Formação de Hidratos em Tubulações . . . . . . . . . . . . . . . . . .
Estrutura dos Hidratos . . . . . . . . . . . . . . . . . . . . . . . . . . .
Inibição da Formação de Hidratos . . . . . . . . . . . . . . . . . . . .
O Monoetilenoglicol
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
Uso do MEG como Inibidor da Formação de Hidratos
. . . . . . . .
Processos de Recuperação e de Regeneração do MEG . . . . . . . .

3
3
6
7
7
8
9
9

REVISÃO BIBLIOGRÁFICA . . . . . . . . . . . . . . . . . . . . . . 19
Equilíbrio de Fases para Sistemas com Eletrólitos . . . . . . . . . . . 19
Escalas de concentração . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Potencial químico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Estado padrão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
Coeﬁciente de atividade médio iônico e molalidade média iônica . . . . . . 22
Leis limitantes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Energia livre de Gibbs para soluções eletrolíticas reais . . . . . . . . . . . . 25
Fugacidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Dados Experimentais de Solubilidade . . . . . . . . . . . . . . . . . . 27
Modelos Termodinâmicos para Eletrólitos
. . . . . . . . . . . . . . . 29
Logaritmos ideal e de excesso da solubilidade de um sal em mistura de solventes 29
Equação de Setchenov . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
Modelo de Pitzer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
Outros Modelos Termodinâmicos
. . . . . . . . . . . . . . . . . . . . 31
Ferramentas Computacionais . . . . . . . . . . . . . . . . . . . . . . . 33

METODOLOGIA . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Estratégia para Abordagem do Trabalho . . . . . . . . . . . . . . . . 38
Seleção dos Sistemas
. . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Dados Experimentais Utilizados
. . . . . . . . . . . . . . . . . . . . . 40
Sistema Internacional de Unidades . . . . . . . . . . . . . . . . . . . . 41
Molalidade e Fração Molar . . . . . . . . . . . . . . . . . . . . . . . . 41
Cálculo da molalidade do sal na mistura de solventes . . . . . . . . . . . . 41
Cálculo da fração molar de MEG livre de sal na mistura de solventes . . . . 41
Constantes Dielétricas . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Cálculo das constantes dielétricas dos solventes puros . . . . . . . . . . . . 42

3.6.2
3.7
3.7.1
3.7.2
3.8
3.8.1
3.8.2
3.8.3
3.8.3.1
3.8.3.2
3.8.3.3
3.8.4
3.8.4.1
3.8.4.2
3.8.5
3.8.5.1
3.8.5.2
3.9
3.9.1
3.9.2

3.10
3.11
3.12
3.12.1
3.12.2
3.12.3
3.12.4
3.12.5
3.12.6
3.12.7
3.13

4
4.1
4.1.1
4.1.1.1
4.1.1.2
4.1.2
4.1.2.1

Cálculo da constante dielétrica da mistura de solventes . . . . . . . . . . . 42
Densidades Absolutas . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Cálculo das densidades absolutas dos solventes puros . . . . . . . . . . . . 42
Cálculo das densidades absolutas da mistura de solventes . . . . . . . . . . 42
Coeﬁciente de Atividade . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Cálculo do coeﬁciente de atividade do sal pelo Modelo de Pitzer
. . . . . . 43
Cálculo do coeﬁciente de atividade do sal em MEG . . . . . . . . . . . . . 43
Constante de Debye-Hückel
. . . . . . . . . . . . . . . . . . . . . . . . . 44
Cálculo da constante de Debye-Hückel para a água . . . . . . . . . . . . . . . . .
44
Cálculo da constante de Debye-Hückel para o MEG . . . . . . . . . . . . . . . . .
44
. . . . . . . . . .
Cálculo da constante de Debye-Hückel para a mistura de solventes
44
Parâmetros do Modelo de Pitzer em água . . . . . . . . . . . . . . . . . . 44
Cálculo dos parâmetros do Modelo de Pitzer para o NaCl em água . . . . . . . . . .
44
. . . . . . . . . .
Cálculo dos parâmetros do Modelo de Pitzer para o KCl em água
45
. . . 46
Parâmetros do Modelo de Pitzer em MEG e em mistura de solventes
Cálculo dos parâmetros do Modelo de Pitzer em MEG . . . . . . . . . . . . . . .
46
Cálculo dos parâmetros do Modelo de Pitzer em mistura de solventes . . . . . . . . .
46
Equações para Ajuste por Regressão de Dados Experimentais . . . . 47
Molalidade do sal em solvente simples como função da temperatura . . . . 47
Potencial químico padrão de excesso do sal em mistura de solventes como
. . . . . . . 47
função da fração molar do MEG livre de sal e da temperatura
. . . . . 47
Propriedades de Excesso Apresentadas em Lorimer (1993)
Constantes Físico-Químicas e Parâmetros Utilizados . . . . . . . . . 48
Algoritmos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Sub-rotina Pitzer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Sub-rotina beta1_MEG . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Sub-rotina prop_mix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Sub-rotina b_mix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Cálculo da molalidade do sal em solvente simples como função da temperatura 52
Cálculo do potencial padrão de excesso do sal na mistura de solventes . . . 52
Cálculo das propriedades de mistura . . . . . . . . . . . . . . . . . . . . . 52
Programa JAFOSSMS . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

RESULTADOS E DISCUSSÕES . . . . . . . . . . . . . . . . . . . . 61
Sistemas com NaCl
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
Sistemas com solvente simples . . . . . . . . . . . . . . . . . . . . . . . . 61
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Sistema H2O+NaCl
61
Sistema MEG+NaCl . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
Sistema com mistura água e MEG (H2O+MEG+NaCl) . . . . . . . . . . . 65
Potencial químico padrão de excesso do NaCl na mistura água e MEG (Regressão) . . .
65

4.1.2.2
4.1.2.3
4.1.2.4
4.1.2.5
4.1.2.6
4.1.2.7
4.1.2.8
4.1.2.9
4.1.2.10
4.2
4.2.1
4.2.1.1
4.2.1.2
4.2.2
4.2.2.1
4.2.2.2
4.2.2.3
4.2.2.4
4.2.2.5
4.2.2.6
4.2.2.7
4.2.2.8
4.2.2.9
4.2.2.10
4.3
4.3.1
4.3.2
4.4
4.4.1
4.4.2

5

. . .
68
Potencial químico padrão de excesso do NaCl na mistura água e MEG (Predição)
Molalidade do NaCl na mistura água e MEG . . . . . . . . . . . . . . . . . . . .
69
Molalidade do NaCl na mistura água e MEG (Predição) . . . . . . . . . . . . . . .
70
Logaritmo de excesso da molalidade do NaCl na mistura água e MEG . . . . . . . . .
71
Logaritmo de excesso da molalidade do NaCl na mistura água e MEG (Predição) . . . .
72
Coeﬁciente de atividade do NaCl na mistura água e MEG . . . . . . . . . . . . . .
73
Coeﬁciente de atividade do NaCl na mistura água e MEG (Predição) . . . . . . . . .
74
Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura água e MEG . . .
75
Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura água e MEG (Predição) 76
Sistemas com KCl
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
Sistemas com solvente simples . . . . . . . . . . . . . . . . . . . . . . . . 77
Sistema H2O+KCl . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Sistema MEG+KCl
79
Sistema com mistura água e MEG (H2O+MEG+KCl) . . . . . . . . . . . . 81
. . .
81
Potencial químico padrão de excesso do KCl na mistura água e MEG (Regressão)
Potencial químico padrão de excesso do KCl na mistura água e MEG (Predição) . . . .
83
Molalidade do KCl na mistura água e MEG . . . . . . . . . . . . . . . . . . . .
84
. . . . . . . . . . . . . . .
85
Molalidade do KCl na mistura água e MEG (Predição)
Logaritmo de excesso da molalidade do KCl na mistura água e MEG . . . . . . . . .
86
. . . .
87
Logaritmo de excesso da molalidade do KCl na mistura água e MEG (Predição)
Coeﬁciente de atividade do KCl na mistura água e MEG . . . . . . . . . . . . . . .
88
Coeﬁciente de atividade do KCl na mistura água e MEG (Predição) . . . . . . . . . .
89
Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura água e MEG . . .
90
Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura água e MEG (Predição) 91
Validação do Modelo de Pitzer implementado . . . . . . . . . . . . . 92
Coeﬁciente de atividade do NaCl em água . . . . . . . . . . . . . . . . . . 92
Coeﬁciente de atividade do KCl em água
. . . . . . . . . . . . . . . . . . 93
Comparação do Modelo JAFOSSMS com outros modelos . . . . . . 95
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
Modelo Ideal
Modelo UNIQUAC+DH . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

CONCLUSÕES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

Referências . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

APÊNDICE A – ARTIGO SOBRE ELV . . . . . . . . . . . . . . . . 115

APÊNDICE B – REQUISITOS PARA EXECUTAR OS PROGRA-

MAS DESENVOLVIDOS . . . . . . . . . . . . . . 121
Requisitos Gerais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121

B.1

B.2
B.2.1
B.2.2
B.2.3
B.3
B.3.1
B.3.2
B.3.3
B.4
B.4.1
B.4.2
B.4.3

C.1
C.2
C.3
C.4

D.1
D.2
D.3
D.4
D.5
D.6
D.6.1
D.6.2

Requisitos para o Ubuntu® . . . . . . . . . . . . . . . . . . . . . . . . 121
Instalação e conﬁguração . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
Compilação e execução . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
Exemplo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Requisitos para o Windows®
. . . . . . . . . . . . . . . . . . . . . . . 122
Instalação e conﬁguração dos requisitos . . . . . . . . . . . . . . . . . . . 122
Compilação e execução . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
Exemplo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
. . . . . . . . . . . . . . . . . . . . . . 124
Requisitos para o Mac OS X®
Instalação e conﬁguração . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
Compilação e execução . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
Exemplo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125

APÊNDICE C – PROGRAMA VLE REGRESSION . . . . . . . . . 127
Interface Gráﬁca do Usuário . . . . . . . . . . . . . . . . . . . . . . . 127
Código Fonte da Biblioteca de Modelos Termodinâmicos
. . . . . . 130
. . . . . . . . . . . . . . . . . . 130
Código Fonte do Programa Principal
Arquivo com Dados de Entrada . . . . . . . . . . . . . . . . . . . . . 136

APÊNDICE D – PROGRAMA JAFOSSMS . . . . . . . . . . . . . 139
Ícone do Programa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
Código Fonte do Arquivo Qt Resource . . . . . . . . . . . . . . . . . 140
Código Fonte da Interface Gráﬁca do Usuário . . . . . . . . . . . . . 140
Código Fonte do widget do matplotlib . . . . . . . . . . . . . . . . . 156
Código Fonte do Programa Principal
. . . . . . . . . . . . . . . . . . 157
Arquivo com Dados de Entrada . . . . . . . . . . . . . . . . . . . . . 175
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
Arquivo principal
Arquivo especíﬁco
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176

Lista de ilustrações

Figura 1 – Localização do Campo de Mexilhão.
. . . . . . . . . . . . . . . . . . .
3
Figura 2 – Plataforma de Mexilhão (PMXL-1). . . . . . . . . . . . . . . . . . . . .
4
Figura 3 – Desenvolvimento do Campo de Mexilhão.
. . . . . . . . . . . . . . . .
4
Figura 4 – Atividade de produção de gás e condensado para o Campo de Mexilhão.
5
Figura 5 – Remoção de bloco de hidratos de tubulação.
. . . . . . . . . . . . . . .
6
Figura 6 – Estrutura dos hidratos de metano e etano.
. . . . . . . . . . . . . . . .
7
Figura 7 – Mecanismos de inibição de hidratos.
. . . . . . . . . . . . . . . . . . .
8
Figura 8 – Esquema de formação de etilenoglicóis. . . . . . . . . . . . . . . . . . .
9
Figura 9 – Processo de recuperação do MEG (década de 1990). . . . . . . . . . . . 10
Figura 10 – Típica faixa de operação do processo de recuperação do MEG. . . . . .
11
Figura 11 – Seção de destilação do processo de regeneração do MEG.
. . . . . . . . 12
Figura 12 – Remoção de sais após o separador a vácuo e no circuito de reciclo no

processo de recuperação do MEG. . . . . . . . . . . . . . . . . . . . . . 13
Figura 13 – Trocador de calor em espiral.
. . . . . . . . . . . . . . . . . . . . . . . 13
Figura 14 – Processo PureMEG™ da Cameron. . . . . . . . . . . . . . . . . . . . . 14
Figura 15 – Unidade de MEG utilizada na plataforma PMXL-1. . . . . . . . . . . . 15
. 20
Figura 16 – Representação do equílibrio de um elétrolito em mistura de solventes.
Figura 17 – Conceito de solução ideal hipotética.
. . . . . . . . . . . . . . . . . . .
21
Figura 18 – Fluxograma de obtenção de propriedades termodinâmicas a partir da

energia livre de Gibbs.

. . . . . . . . . . . . . . . . . . . . . . . . . . . 26

Figura 19 – Fluxograma simpliﬁcado da metodologia empregada nesta tese de dou-

torado. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Figura 20 – Estratégia de abordagem do trabalho desta tese de doutorado. . . . . . 38
Figura 21 – Fluxograma da sub-rotina Pitzer.
. . . . . . . . . . . . . . . . . . . . . 49
Figura 22 – Fluxograma da subrotina beta1_MEG. . . . . . . . . . . . . . . . . . . 49
. . . . . . . . . . . . . . . . . . . 50
Figura 23 – Fluxograma da subrotina prop_mix.
Figura 24 – Fluxograma da subrotina b_mix.
51
Figura 25 – Programa JAFOSSMS : Seleção do sistema a ser estudado. . . . . . . . 53
Figura 26 – Programa JAFOSSMS : Relatório gerado.
. . . . . . . . . . . . . . . . 54
Figura 27 – programa JAFOSSMS: Opções para geração de gráﬁco binário.
. . . . 54
Figura 28 – Programa JAFOSSMS : Opções para geração de gráﬁco ternário.
. . . 55
Figura 29 – Programa JAFOSSMS : Seleção das isotermas para geração de gráﬁco

. . . . . . . . . . . . . . . . . . . . .

ternário. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Figura 30 – Programa JAFOSSMS : Gráﬁco binário.
. . . . . . . . . . . . . . . . . 56
Figura 31 – Programa JAFOSSMS : Gráﬁco ternário. . . . . . . . . . . . . . . . . . 56
Figura 32 – Molalidade do NaCl em H2O em função da Temperatura. . . . . . . . . 63

Figura 33 – Molalidade do NaCl em MEG em função da Temperatura.
Figura 34 – Potencial químico padrão de excesso do NaCl na mistura água e MEG

. . . . . . . 65

em função da fração molar de MEG livre de NaCl (Regressão)1.

. . . . 67

Figura 35 – Potencial químico padrão de excesso do NaCl na mistura água e MEG

em função da fração molar de MEG livre de NaCl (Predição).

. . . . . 68

Figura 36 – Molalidade do NaCl na mistura água e MEG em função da fração molar

de MEG livre de NaCl. . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

Figura 37 – Molalidade do NaCl na mistura água e MEG em função da fração molar

de MEG livre de NaCl (Predição).

. . . . . . . . . . . . . . . . . . . . 70

Figura 38 – Logaritmo de excesso da molalidade do NaCl na mistura água e MEG
. . . . . . . . . . .
Figura 39 – Logaritmo de excesso da molalidade do NaCl na mistura água e MEG

em função da fração molar de MEG livre de NaCl.

71

em função da fração molar de MEG livre de NaCl (Predição).

. . . . . 72

Figura 40 – Coeﬁciente de atividade do NaCl na mistura água e MEG em função

da fração molar de MEG livre de NaCl. . . . . . . . . . . . . . . . . . . 73

Figura 41 – Coeﬁciente de atividade do NaCl na mistura água e MEG em função

da fração molar de MEG livre de NaCl (Predição).

. . . . . . . . . . . 74

Figura 42 – Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura

água e MEG em função da fração molar de MEG livre de NaCl.

. . . . 75

Figura 43 – Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura

água e MEG em função da fração molar de MEG livre de NaCl (Predição). 76
. . . . . . . . 78
Figura 44 – Molalidade do KCl em H2O em função da Temperatura.
Figura 45 – Molalidade do KCl em MEG em função da Temperatura. . . . . . . . . 80
Figura 46 – Potencial químico padrão de excesso do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl (Regressão).

. . . . . 82

Figura 47 – Potencial químico padrão de excesso do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl (Predição). . . . . . . 83

Figura 48 – Molalidade do KCl na mistura água e MEG em função da fração molar

de MEG livre de KCl.

. . . . . . . . . . . . . . . . . . . . . . . . . . . 84

Figura 49 – Isoterma da molalidade do KCl na mistura água e MEG em função da

fração molar de MEG livre de KCl (Predição). . . . . . . . . . . . . . . 85

Figura 50 – Logaritmo de excesso da molalidade do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl.

. . . . . . . . . . . . 86

Figura 51 – Logaritmo de excesso da molalidade do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl (Predição). . . . . . . 87

Figura 52 – Coeﬁciente de atividade do KCl na mistura água e MEG em função da

fração molar de MEG livre de KCl.

. . . . . . . . . . . . . . . . . . . . 88

Figura 53 – Coeﬁciente de atividade do KCl na mistura água e MEG em função da

fração molar de MEG livre de KCl (Predição). . . . . . . . . . . . . . . 89

Figura 54 – Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura

água e MEG em função da fração molar de MEG livre de KCl. . . . . . 90

Figura 55 – Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura

Figura 56 – Modelo de Pitzer implementado (γ
Figura 57 – Modelo de Pitzer implementado (γ
Figura 58 – Modelo de Pitzer implementado (γ

água e MEG em função da fração molar de MEG livre de KCl (Predição). 91
. . . . . . . 92
). . . . . . . . . . . . . 93
) utilizando os parâ-

NaCl × b
{H2O}
{H2O}
NaCl a 25 ℃).
KCl × b
{H2O}
{H2O}
KCl
KCl × b
{H2O}
{H2O}
KCl
metros de Zemaitis Jr. et al. (1986, p. 103).
. . . . . . . . . . . . . . . 94
Figura 59 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (NaCl).
. . . 95
Figura 60 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (KCl).
. . . . 96
Figura 61 – Programas VLE Regression e JAFOSSMS no Ubuntu® 14.04 LTS. . . . 122
Figura 62 – Programas VLE Regression e JAFOSSMS no Windows® 7 Home Basic. 124
Figura 63 – Programas VLE Regression e JAFOSSMS no Mac OS X® 10.6 Snow

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
Figura 64 – Ícone do Programa JAFOSSMS. . . . . . . . . . . . . . . . . . . . . . . 139

Leopard.

Lista de tabelas

Tabela 1 – Banco de dados de solubilidade de sal em água a diferentes temperaturas. 27
Tabela 2 – Banco de dados de solubilidade de sal em mistura de solventes.
. . . . 28
Tabela 3 – Características da água de formação do reservatório do campo de Mexilhão. 39
Tabela 4 – Dados experimentais de solubilidade de sal em água a diferentes tempe-

raturas usados nesta tese de doutorado.

. . . . . . . . . . . . . . . . . 40

Tabela 5 – Dados experimentais de solubilidade de sal em mistura de solventes

usados nesta tese de doutorado. . . . . . . . . . . . . . . . . . . . . . . 40
Tabela 6 – Valores de constantes utilizados nesta tese de doutorado. . . . . . . . . 48
Tabela 7 – Valores de f lag na sub-rotina prop_mix. . . . . . . . . . . . . . . . . . 50
Tabela 8 – ANOVA (Sistema H2O+NaCl).
. . . . . . . . . . . . . . . . . . . . . . 62
Tabela 9 – Parâmetros obtidos (Sistema H2O+NaCl). . . . . . . . . . . . . . . . . 62
Tabela 10 – Matriz de Correlação (Sistema H2O+NaCl).
. . . . . . . . . . . . . . . 62
. . . . . . . . . . . . . . . . . . . . . 64
Tabela 11 – ANOVA (Sistema MEG+NaCl).
. . . . . . . . . . . . . . . 64
Tabela 12 – Parâmetros obtidos (Sistema MEG+NaCl).
. . . . . . . . . . . . . . 64
Tabela 13 – Matriz de Correlação (Sistema MEG+NaCl).
Tabela 14 – ANOVA (Sistema H2O+MEG+NaCl).
. . . . . . . . . . . . . . . . . . 66
Tabela 15 – Parâmetros obtidos (Sistema H2O+MEG+NaCl). . . . . . . . . . . . . 66
Tabela 16 – Matriz de Correlação (Sistema H2O+MEG+NaCl).
. . . . . . . . . . . 66
Tabela 17 – ANOVA (Sistema H2O+KCl). . . . . . . . . . . . . . . . . . . . . . . . 77
Tabela 18 – Parâmetros obtidos (Sistema H2O+KCl). . . . . . . . . . . . . . . . . . 77
Tabela 19 – Matriz de Correlação (Sistema H2O+KCl). . . . . . . . . . . . . . . . . 78
Tabela 20 – ANOVA (Sistema MEG+KCl).
. . . . . . . . . . . . . . . . . . . . . . 79
. . . . . . . . . . . . . . . . 79
Tabela 21 – Parâmetros obtidos (Sistema MEG+KCl).
Tabela 22 – Matriz de Correlação (Sistema MEG+KCl).
. . . . . . . . . . . . . . . 80
81
Tabela 23 – ANOVA (Sistema H2O+MEG+KCl). . . . . . . . . . . . . . . . . . . .
Tabela 24 – Parâmetros obtidos (Sistema H2O+MEG+KCl).
. . . . . . . . . . . .
81
Tabela 25 – Matriz de Correlação (Sistema H2O+MEG+KCl). . . . . . . . . . . . . 82
Tabela 26 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (NaCl).
. . . 95
Tabela 27 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (KCl).
. . . . 96
Tabela 28 – Dados de equilíbrio usados na comparação do Modelo JAFOSSMS com

Tabela 29 – Comparação do Modelo JAFOSSMS com o Modelo UNIQUAC+DH.

o Modelo UNIQUAC+DH. . . . . . . . . . . . . . . . . . . . . . . . . . 97
. 97

Lista de abreviaturas e siglas

Análise de Variância

Agência Nacional de Petróleo Gás Natural e Biocombustíveis

Centro de Pesquisas da Petrobras

Dietileno glicol

Debye-Hückel

Equilíbrio Líquido-Líquido

Equilíbrio Líquido-Vapor

ANOVA

ANP

CENPES

DEG

DH

ELL

ELV

FOTEQ

Laboratório de Fotoquímica e Equilíbrio de Fases

H2O

IDE

MSL

KCl

MEG

NaCl

Água

Integrated Development Environment (Ambiente de Desenvolvimento
Integrado)

International Mathematics and Statistics Library

Cloreto de potássio

Monoetileno glicol

Cloreto de sódio

NUPEG

Núcleo de Ensino e Pesquisa em Petróleo e Gás

NRTL

OE

PDH

PMXL-1

PPGEQ

PRH

SIT

SRK

Non-Random Two Liquid

Óxido de etileno

Pitzer-Debye-Hückel

Plataforma número 1 do Campo de Mexilhão na Bacia de Santos

Pós-Graduação em Engenharia Química

Programa de Recursos Humanos

Speciﬁc ion Interaction Theory

Soave-Redlich-Kwong

TEG

Trietileno glicol

UFERSA

Universidade Federal Rural do Semi-Árido

UFRN

UFSM

Universidade Federal do Rio Grande do Norte

Universidade Federal de Santa Maria

UNIFAC

UNIQUAC Functional-group Activity Coeﬃcients

UNIQUAC

UNIversal QUAsiChemical

Lista de símbolos

molalidade de i

número de moles de i

massa do solvente

massa molar de i

molaridade de i

volume da solução

fração molar de i na fase líquida

número de moles total na solução

potencial químico de i

energia livre de Gibbs

temperatura

pressão

todos os números de moles exceto o referente a i

potencial químico de i em um estado padrão apropriadamente escolhido

constante universal do gases ideais

atividade de i

coeﬁciente de atividade de i

uma escala de concentração conveniente

eletrólito eletricamente neutro (abreviado)

potencial químico de MX na fase sólida

potencial químico de MX na fase líquida H2O

potencial químico de MX na fase líquida MEG

potencial químico de MX na fase líquida H2O + MEG

bi

ni

msolv

Mi

ci

V

xi

n

µi

G

T

P

nj6=i
µ•

i

R

ai

γi

ξi

MX

s
MX
{H2O}
MX

µ

µ

{MEG}
MX
{H2O+MEG}
MX

µ

µ

0
i

µ

potencial químico racional simétrico de i

(cid:79)
i,x

µ
γ∗
γ∞

i,x

i

potencial químico racional assimétrico

coeﬁciente de atividade racional assimétrico

coeﬁciente de atividade em diluição inﬁnita

b0

molalidade unitária

(cid:79)
i,b

µ
γ∗

i,b

xsolv

Mν+Xν−

ν+

z+

ν−

z−

γ±

b±

γ+

γ−

b+

b−

ν

yi

sat
i

P

Hi
κ−1

ε0

εr

potencial químico molal assimétrico

coeﬁciente de atividade molal assimétrico

fração molar de solvente na fase líquida

eletrólito eletricamente neutro

coeﬁciente estequiométrico do cátion

carga do cátion

coeﬁciente estequiométrico do ânion

carga do ânion

coeﬁciente de atividade médio iônico

molalidade média iônica

coeﬁciente de atividade do cátion

coeﬁciente de atividade do ânion

molalidade do cátion

molalidade do ânion

coeﬁciente estequiométrico total

fração molar de i na fase vapor

pressão de vapor de i puro

constante de Henry para i

comprimento de Debye-Hückel

permissividade do vácuo

constante dielétrica (também conhecida como permissividade relativa)

kB

NA

e0

Ic

zi

γi,c

ρsolv

γi,b

Aγ

Ib

I

A

B

a

(cid:77)

E
(cid:77)

id

(cid:77)
¯(cid:77)i
¯(cid:77)
E
i
¯(cid:77)
id
i
¯Gi

S

H

nH2O

constante de Boltzmann

número de Avogadro

carga do elétron

força iônica molar

carga de i

coeﬁciente de atividade molar de i

densidade absoluta do solvente

coeﬁciente de atividade molal de i

constante de Debye-Hückel na forma para coeﬁciente de atividade

força iônica molal

força iônica

parâmetros dependentes da temperatura (Lei de Debye-Hückel Exten-
dida)

parâmetros dependentes da temperatura (Lei de Debye-Hückel Exten-
dida)

parâmetro relacionado ao tamanho dos íons (Lei de Debye-Hückel Ex-
tendida)

uma propriedade

uma propriedade de excesso

uma propriedade ideal

uma propriedade parcial molar de i

uma propriedade parcial molar de excesso de i

uma propriedade parcial molar ideal de i

energia livre de Gibbs parcial molar de i

entropia

energia livre de Helmholtz

número de moles da água

µH2O

potencial químico da água

nMX
ˆfi
f•

i

0
i

f

Hi,x

Hi,b

hln b

{H2O+MEG}
MX

x0
H2O
x0
MEG
{H2O}
MX
{MEG}
MX

hln b

{H2O+MEG}
MX

b

b

número de moles do eletrólito MX

fugacidade de i na solução

fugacidade de i em um estado padrão apropriadamente escolhido

fugacidade racional simétrica de i

constante de Henry racional

constante de Henry molal

logaritmo ideal da molalidade de MX na mistura água e MEG

fração molar de água livre de sal na mistura de solventes

fração molar de MEG livre de sal na mistura de solventes

molalidade de MX em água

molalidade de MX em MEG

logaritmo de excesso da molalidade de MX na mistura água e MEG

iid

iE

{H2O+MEG}
MX

b

molalidade de MX na mistura água e MEG

kS

φ

aH2O

MH2O

zM

zX

f φMX

(cid:98)

Aφ

bMX

νM

νX

constante de Setchenov

coeﬁciente osmótico

atividade da água

massa molar da água

carga do cátion (M)

carga do ânion (X)

função de Debye-Hückel na forma para o coeﬁciente osmótico

constante o Modelo de Pitzer

constante de Debye-Hückel na forma para coeﬁciente osmótico

molalidade de MX

coeﬁciente estequiométrico do cátion

coeﬁciente estequiométrico do ânion

BφMX

C φMX

(0)
MX

β

(1)
MX

β

α

f γMX

BγMX

C γMX

wMX

MMX

mMX

segundo coeﬁciente do virial na forma para coeﬁciente osmótico

terceiro coeﬁciente do virial na forma para coeﬁciente osmótico (parâ-
metro do Modelo de Pitzer)

parâmetro do Modelo de Pitzer

parâmetro do Modelo de Pitzer

constante do Modelo de Pitzer ou nível de signiﬁcância

função de Debye-Hückel na forma para o coeﬁciente de atividade

segundo coeﬁciente do virial na forma para coeﬁciente osmótico

terceiro coeﬁciente do virial na forma para coeﬁciente osmótico

fração mássica de MX

massa molar de MX

massa de MX

mH2O+MEG

massa de água e MEG

mMEG

MMEG

mH2O

MH2O
w0
H2O
w0
MEG

εr,H2O

εr,MEG

massa de MEG

massa molar do MEG

massa de água

massa molar da água

fração mássica de água livre de sal na mistura de solventes

fração mássica de MEG livre de sal na mistura de solventes

constante dielétrica (também conhecida como permissividade relativa)
da água

constante dielétrica (também conhecida como permissividade relativa)
do MEG

εr,H2O+MEG

constante dielétrica (também conhecida como permissividade relativa)
da mistura água e MEG

ρH2O

τ

densidade absoluta da água

parâmetro relacionado a temperatura usado na Equação 3.10

ρMEG

ρH2O+MEG

γ

γMX
{H2O}
MX
{MEG}
MX

γ

densidade absoluta do MEG

densidade absoluta da mistura água e MEG

coeﬁciente de atividade de MX

coeﬁciente de atividade de MX em água

coeﬁciente de atividade de MX em MEG

0
∆trG
H2O→MEG

energia livre de Gibbs de transferência da água para o MEG

Aφ,H2O

Aφ,MEG

Aφ,H2O+MEG

constante de Debye-Hückel da água na forma para coeﬁciente osmótico

constante de Debye-Hückel do MEG na forma para coeﬁciente osmótico

constante de Debye-Hückel da mistura água e MEG na forma para
coeﬁciente osmótico

β

(0){H2O}
NaCl
(1){H2O}
β
NaCl
C φ{H2O}
NaCl

β

(0){H2O}
KCl
(1){H2O}
β
KCl
C φ{H2O}
KCl

(0){MEG}
β
MX
C φ{MEG}
MX

(0){H2O}
β
MX
C φ{H2O}
MX

β

(1){MEG}
MX
(0){H2O+MEG}
β
MX
C φ{H2O+MEG}
MX

parâmetro do Modelo de Pitzer para o NaCl em água

parâmetro do Modelo de Pitzer para o NaCl em água

terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para
o NaCl em água (parâmetro do Modelo de Pitzer)

parâmetro do Modelo de Pitzer para o KCl em água

parâmetro do Modelo de Pitzer para o KCl em água

terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para
o KCl em água (parâmetro do Modelo de Pitzer)

parâmetro do Modelo de Pitzer para MX em MEG

terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para
o MX em MEG (parâmetro do Modelo de Pitzer)

parâmetro do Modelo de Pitzer para MX em água

terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para
MX em água (parâmetro do Modelo de Pitzer)

parâmetro do Modelo de Pitzer para MX em MEG

parâmetro do Modelo de Pitzer para MX na mistura água e MEG

terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para
MX na mistura água e MEG (parâmetro do Modelo de Pitzer)

(1){H2O+MEG}
MX
(1){H2O}
MX

β

β

parâmetro do Modelo de Pitzer para MX na mistura água e MEG

parâmetro do Modelo de Pitzer para MX em água

(cid:65)

(cid:66)

Θ−2

T0

Θi

Θi,j

h
hln γ
hln b
hln γ

parâmetro usado na Equação 3.33

parâmetro usado na Equação 3.33

parâmetro ajustável da Equação 3.36

temperatura unitária

parâmetro ajustável da Equação 3.36

potencial químico padrão de excesso de MX na mistura água e MEG

parâmetro usado na Equação 3.37

logaritmo ideal do coeﬁciente de atividade de MX na mistura água e
MEG

logaritmo de excesso da molalidade de MX na mistura água e MEG

logaritmo de excesso do coeﬁciente de atividade de MX na mistura água
e MEG

iE

iid
iE
iE

0{H2O+MEG}
MX

µ

{H2O+MEG}
MX

{H2O+MEG}
MX

{H2O+MEG}
MX

{H2O}
NaCl

b

molalidade do NaCl em água

θ0

Θ0

θ1

Θ1

θ2

s

2

R

parâmetro ajustável usado na Equação 4.1, na Equação 4.2, na Equação 4.3,
na Equação 4.4, na Equação 4.5 e na Equação 4.6

parâmetro ajustável da Equação 3.36 usado na Equação 4.1, na Equação 4.2,
na Equação 4.4 e na Equação 4.5

parâmetro ajustável usado na Equação 4.1, na Equação 4.2, na Equação 4.3,
na Equação 4.4, na Equação 4.5 e na Equação 4.6

parâmetro ajustável da Equação 3.36 usado na Equação 4.1, na Equação 4.2,
na Equação 4.4 e na Equação 4.5

parâmetro ajustável usado na Equação 4.1, na Equação 4.3, na Equação 4.4
e na Equação 4.6

desvio padrão assintótico

coeﬁciente de determinação

2
ajustado

R

coeﬁciente de determinação ajustado

{MEG}
NaCl
{H2O+MEG}
NaCl

b

b

molalidade do NaCl em MEG

molalidade do NaCl na mistura água e MEG

Θ0,0

Θ0,1

Θ1,0

Θ1,1

Θ2,0

Θ2,1

θ3

θ4

b

θ5
{H2O}
KCl
{MEG}
KCl
{H2O+MEG}
KCl

b

b

ionizada
KCl

x

xKCl

parâmetro ajustável da Equação 3.37 usado na Equação 4.3 e na
Equação 4.6

parâmetro ajustável da Equação 3.37 usado na Equação 4.3 e na
Equação 4.6

parâmetro ajustável da Equação 3.37 usado na Equação 4.3 e na
Equação 4.6

parâmetro ajustável da Equação 3.37 usado na Equação 4.3 e na
Equação 4.6

parâmetro ajustável da Equação 3.37 usado na Equação 4.3 e na
Equação 4.6

parâmetro ajustável da Equação 3.37 usado na Equação 4.3 e na
Equação 4.6

parâmetro ajustável usado na Equação 4.3 e na Equação 4.6

parâmetro ajustável usado na Equação 4.3 e na Equação 4.6

parâmetro ajustável usado na Equação 4.3 e na Equação 4.6

molalidade do KCl em água

molalidade do KCl em MEG

molalidade do KCl na mistura água e MEG

fração molar de KCl em base iônica

fração molar de KCl

CAPÍTULO 1
INTRODUÇÃO

1 INTRODUÇÃO

3

Na indústria de produção do gás natural, de uma maneira geral, evita-se a for-
mação de hidratos nas tubulações por meio da injeção de um glicol na cabeça do poço,
principalmente, de monoetilenoglicol (MEG). Embora considere-se que a injeção do MEG
resolva os problemas com hidratos na produção, na etapa de recuperação do MEG injetado,
pode ocorrer a formação de precipitados. Assim sendo, faz-se necessário o conhecimento
da solubilidade dos sais presentes na água de produção, nas condições de operação, em
função da concentração do MEG, para poder-se evitar a formação destes indesejáveis
precipitados.1

1.1 Atividade de Produção no Campo de Mexilhão

Na atividade de produção de gás natural no Brasil tem grande destaque a plataforma
PMXL-1 do Campo de Mexilhão situado na Bacia de Santos (Figura 1). Esta plataforma,
cuja jaqueta foi construída no Estaleiro Mauá (Niterói, RJ), é considerada a maior estrutura

Figura 1 – Localização do Campo de Mexilhão.

Fonte: Petrobras (2007, p. 5).

1 As informações presentes nesta seção foram obtidas de Petrobras (2007).

4

Capítulo 1.

INTRODUÇÃO

metálica oﬀ-shore já construída no Brasil (Figura 2). A operação da plataforma de PMXL-1
iniciou-se em 2011.

Figura 2 – Plataforma de Mexilhão (PMXL-1).

(a) Transporte da jaqueta.

(b) Fixada no Campo de Mexilhão.

Fonte: Galante (2009) e Belchior (2013, p. 37) respectivamente.

No Campo de Mexilhão, a atividade de produção e escoamento de gás e condensado
contempla o emprego de poços produtores, um sistema de coleta constituído por linhas e
estruturas submarinas, uma plataforma marítima e um sistema de escoamento da produção
para a Unidade de Tratamento de Gás de Caraguatatuba (UTGCA), na costa, por meio
de gasoduto submarino (Figura 3).

Figura 3 – Desenvolvimento do Campo de Mexilhão.

Fonte: Naumann (2009, p. 11).

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 1.

INTRODUÇÃO

5

A plataforma de produção encontra-se ﬁxada, por meio de jaqueta, ao leito sub-
marino a uma profundidade de 172 metros. Ela está interligada aos poços produtores
possuindo uma capacidade de processamento estimada em 15 milhões de m3/dia de gás e
de 3,2 mil m3/dia para o condensado.

A atividade de produção de gás e condensado do Campo de Mexilhão está repre-

sentada pela Figura 4.

Figura 4 – Atividade de produção de gás e condensado para o Campo de Mexilhão.

Fonte: Petrobras (2007, p. 25).

Durante a atividade de produção, o ﬂuido proveniente do reservatório é coletado
através do sistema submarino diretamente para a plataforma. Este é rico em gás, além de
condensado e pequena quantidade de água. Na plataforma realiza-se o processamento da
produção.

As principais etapas envolvendo o ﬂuido produzido são:
a) Coleta do ﬂuido produzido (gás, condensado e água) no poço;
b) Separação do gás, condensado e água na plataforma;

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

6

Capítulo 1.

INTRODUÇÃO

c) Tratamento do gás e do condensado na plataforma;

d) Processamento de parte do gás para suporte ao processo de produção (geração

de energia);

e) Circulação do MEG pelo sistema submarino de coleta, evitando-se assim en-
tupimentos por formação de hidratos no interior das tubulações, e posterior
regeneração do MEG na plataforma.

Após tratamento, gás e condensado são bombeados para o litoral (UTGCA) através

de gasoduto.

1.2 Formação de Hidratos em Tubulações

Em condições termodinâmicas favoráveis, de temperatura e pressão, poderá haver
a formação de hidratos em tubulações. Estes poderão provocar o bloqueio do ﬂuido em
linhas, dutos e equipamentos e, consequentemente, interrupção na produção, entre outros
problemas.

A obstrução de tubulações de produção pode ser um problema grave com enormes

prejuízos e, portanto, deve ser evitado a todo custo.

A interrupção para remoção manual dos blocos de hidratos normalmente demanda
diminuição ou até interrupção na produção, além de exigir procedimentos com operações
de risco para a plataforma. O processo de remoção manual e a dimensão do problema pode
ser compreendida melhor por meio da vizualização das dimensões dos blocos de hidratos
removidos do interior de uma tubulação mostrados na Figura 5(a) e na Figura 5(b).

Figura 5 – Remoção de bloco de hidratos de tubulação.

(a) Sendo removido.

(b) Após a remoção.

Fonte: Moura (2007, p. 11).

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

INTRODUÇÃO

Capítulo 1.
1.3 Estrutura dos Hidratos

7

Conforme Baptista (2007), a atração entre os pólos de cargas opostas de duas
moléculas de água distintas origina ligações conhecidas como pontes de hidrogênio. Estas
ligações são as mais fortes dentre as ligações intermoleculares. Necessita-se de aproximada-
mente 5 kcal/mol de energia para romper uma ponte de hidrogênio enquanto que para
uma ligação de van der Waals essa energia é de 0,3 kcal/mol. As pontes de hidrogênio
contribuem ativamente na energia de dissociação da estrutura dos hidratos.

Na Figura 6 está representado uma molécula de hidrocarboneto que encontra-se
aprisionada por meio de rede de pontes de hidrogênio formadas com outras moléculas de
água.

Figura 6 – Estrutura dos hidratos de metano e etano.

Fonte: Statoil (2011, p. 4).

1.4 Inibição da Formação de Hidratos

Substâncias que provocam o atraso na cinética de formação de hidratos, ou mesmo,
impedem a sua formação, são conhecidas como Inibidores da formação de hidratos. Con-
forme Andrade (2009) estes podem ser classiﬁcados em três tipos:

a) Inibidores termodinâmicos: são geralmente sais inorgânicos (NaCl, CaCl2,
KCl), alcoóis (metanol) e glicóis (MEG) que objetivam reduzir a atividade
da água, quantidade de água livre na mistura, e com isso deslocar a curva de
equilíbrio de fases, desfavorecendo a formação de hidratos;

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

8

Capítulo 1.

INTRODUÇÃO

b) Inibidores cinéticos: são polímeros solúveis em água e que reagem sinergica-
mente com glicóis e alcoóis de alto peso molecular. Esses aditivos são capazes
de retardar o início da nucleação e diminuem a taxa de crescimento de cristais
de hidratos;

c) Antiaglomerantes: são basicamente polímeros e tensoativos, os quais, de modo
similar aos inibidores cinéticos, quando utilizados em pequenas quantidades
já surtem os efeitos desejados. Sua principal função é retardar a aglomeração
de cristais e facilitar o transporte dos núcleos já formados. Não impedem a
formação de cristais de hidratos, no entanto, ajudam bastante no transporte
dos cristais formados.

Estes inibidores e seus mecanismos estão ilustrados na Figura 7.

Figura 7 – Mecanismos de inibição de hidratos.

Fonte: Andrade (2009, p. 40), adaptada.

Alguns exemplos de inibidores de formação de hidratos e suas características são:
a) Sais inorgânicos: podem causar corrosão e incrustação;
b) Metanol: possui alta toxicidade, de difícil recuperação e não é adequado para

injeção contínua;

c) Glicóis: são pouco voláteis, de fácil recuperação e se concentram na fase aquosa.

1.5 O Monoetilenoglicol

O monoetilenoglicol (MEG), chamado simplesmente etilenoglicol, com nome IUPAC:
etano-1,2-diol, ou 1,2-etanodiol, é um álcool com 2 grupos OH (um diol), largamente usado
como anticongelante automotivo. Puro é um composto inodoro, incolor, líquido xaroposo

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 1.

INTRODUÇÃO

9

com sabor doce. O MEG é tóxico, e sua ingestão é considerada uma emergência médica.
Sua densidade absoluta a 20 °C é 1,1135 g/cm3, com massa molar 62,068 g/mol, ponto de
fusão -12,69 °C e ponto de ebulição 197,3 °C (LIDE, 2009).

O MEG é o mais simples dos etilenoglicóis. Normalmente é obtido pela reação
de água com óxido de etileno (OE). Reagindo-se MEG com óxido de eteno, produz-se
o dietilenoglicol (DEG) e a partir deste, adicionando-se mais óxido de etileno, chega-
se ao trietilenoglicol (TEG). A representação da sequência de reações de formação dos
etilenoglicóis é ilustrada na Figura 8.

Figura 8 – Esquema de formação de etilenoglicóis.

O

CH2

CH2

OE

O

CH2

CH2

OE

O

CH2

CH2

OE

+ H2O
Água

HOCH2CH2OH

MEG

+ HOCH2CH2OH

MEG

+ O

CH2CH2OH
CH2CH2OH
DEG

O

CH2CH2OH
CH2CH2OH
DEG

H2C OCH2CH2OH
OCH2CH2OH
CH2
TEG

Fonte: Andrade (2009, p. 41), adaptada.

1.6 Uso do MEG como Inibidor da Formação de Hidratos

O uso do MEG como inibidor da formação de hidratos, por injeção na cabeça do

poço, apresenta vantagens, como por exemplo:

a) Menor viscosidade ⇒ maior facilidade de escoamento;
b) Fácil recuperação ⇒ menos solúvel em hidrocarbonetos líquidos;
c) Atua na redução da temperatura de formação de hidratos.

1.7 Processos de Recuperação e de Regeneração do MEG

Em plataformas de gás natural, o MEG tem sido largamente utilizado como inibidor
da formação de hidratos sem grandes problemas. Por outro lado, no processo de recuperação
do MEG para reuso podem ocorrer problemas causados por incrustações formadas pela
precipitação de sais, tornando necessário o conhecimento das condições de formação,
quantidade e natureza dos respectivos precipitados para, então, ser possível evitá-los.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

10

Capítulo 1.

INTRODUÇÃO

O elevado ponto de ebulição do MEG em relação ao da água e a tendência a
decompor-se termicamente em ácidos orgânicos podem causar problemas em unidades de
regeneração convencionais quando a água de formação for rica em sais. Estas unidades
simplesmente fervem a água de soluções diluídas de MEG rico produzindo soluções
reconcentradas de MEG pobre. Este processo funcionaria bem se não fosse o fato da água
de formação normalmente conter concentrações altas de sais dissolvidos (principalmente
NaCl) que tendem a acumularem-se no MEG pobre até a saturação e, vez ou outra, acima
dela. O emprego deste processo pode causar perda de MEG por degradação térmica além
de problemas operacionais (entupimentos e corrosão) pela precipitação de sais.

Na década de 1990 foi sugerido um processo que evitaria os problemas do processo
convencional (Figura 9). Neste processo o MEG rico contaminado por sais ﬂui para o
interior de uma unidade de separação a vácuo onde ele é instantaneamente vaporizado
quando misturado ao licor mãe aquecido. Este conceito de licor mãe aquecido tem sido
utilizado por décadas. A corrente de alimentação, excluindo-se os sólidos dissolvidos e
em suspensão, é vaporizada e ﬂui para uma coluna de destilação convencional para ser
separada em água e MEG pobre reconcentrado limpos.

Figura 9 – Processo de recuperação do MEG (década de 1990).

Fonte: Nazzer e Keogh (2006, p. 2), adaptada.

O líquido de reciclo é tirado a partir da acumulação de líquido no separador a
vácuo e, como dito anteriormente, devido ao MEG ter um ponto de ebulição muito mais
elevado do que a água, o líquido resultante terá um teor de água muito menor do que a

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 1.

INTRODUÇÃO

11

alimentação de MEG rico. Calor sensível suﬁciente é adicionado ao ﬂuido de reciclo para
vaporizar completamente a alimentação de MEG rico. Isto é conseguido mantendo uma
alta taxa de ﬂuxo de reciclo aquecido por uma variação de apenas 10 a 20 graus Celsius,
de modo a evitar a degradação térmica do MEG no circuito de reciclo. Nenhuma ebulição
ocorre no aquecedor de reciclo devido ao líquido de reciclo estar sob pressão. Neste ponto
no processo, o teor de água é reduzido, e o aumento de temperatura é pequeno.

A quantidade de calor adicionada ao aquecedor de reciclo varia com a taxa de
alimentação de MEG rico: se a taxa de alimentação é aumentada (ou diminuída), em
seguida, mais calor (ou menos) deve ser adicionado para manter um nível constante de
líquido no separador a vácuo.

Geralmente ﬁxa-se a pressão de operação de modo a manter-se temperaturas de
processamento baixas o suﬁciente para evitar-se a degradação do MEG. O controle direto
sobre a temperatura não é necessário, mas o nível do líquido no separador a vácuo deve
ser medido e controlado de forma conﬁável. Isto é feito controlando-se a adição de calor
ao aquecedor de reciclo conforme seja necessário. A temperatura de funcionamento do
processo ﬂutua livremente dentro de uma faixa prevista, sendo esta, deﬁnida pela pressão
de operação e pela concentração do MEG na alimentação (Figura 10). Devido a estabilidade
inerente do processo, não há necessidade de ação por parte do operador ou do sistema de
controle quando o MEG contido na alimentação varia dentro do intervalo permitido.

Figura 10 – Típica faixa de operação do processo de recuperação do MEG.

Fonte: Nazzer e Keogh (2006, p. 3), adaptada.

Para poder ser utilizado no processo de inibição de hidrato, o MEG pobre é
normalmente produzido com uma concentração que varia na faixa de 80% a 95% em peso
de MEG. Esta concentração pode ser facilmente conseguida através do fracionamento do

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

12

Capítulo 1.

INTRODUÇÃO

MEG/vapor de água numa coluna de destilação convencional equipada com enchimento
estruturado (Figura 11). Um refervedor geralmente não é necessário. Em situações normais,
nenhuma energia térmica adicional é necessária para produzir 90-95% em peso de MEG
em comparação com 80% em peso de MEG devido ao fato da alimentação na coluna de
destilação ser tudo vapor.

Figura 11 – Seção de destilação do processo de regeneração do MEG.

Fonte: Nazzer e Keogh (2006, p. 3), adaptada.

Em processos atuais, os sólidos decantados passam pela camada estática de líquido
no fundo do separador a vácuo, evitando o circuito de reciclo e descendo para a seção de
remoção de sólidos da planta. Em métodos convencionais, a remoção de sólidos em ﬂuxos de
processo, faz-se por meio de pequena purga em corrente lateral. Aplicado a recuperação de
MEG, implica em ﬂuir uma fração do líquido de reciclo através do decantador e centrífuga.
Um decantador a montante da centrífuga ocasiona a transição do regime contínuo para o
em batelada, propiciando um meio de aumentar o teor de sólidos na lama a ser alimentada
à centrífuga. Balanços de massa mostram que plantas onde os sólidos são removidos
do circuito de reciclo tem uma carga de partículas muito alta. Isto aumenta o risco de
interrupções para remover incrustações no aquecedor de reciclo e para reparar a erosão no
equipamento e dutos. Logo, ocorrem benefícios substanciais com a segregação e remoção
de partículas sólidas do separador a vácuo a montante da entrada do circuito de reciclo.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 1.

INTRODUÇÃO

13

Tipicamente a taxa de ﬂuxo de reciclo é de 30 a 60 vezes maior que a alimentação de MEG
rico, logo, uma pequena segregação de sólidos gera um aumento acentuado no desempenho.
A Figura 12 mostra a remoção de sais pelo método convencional e pelo circuito de reciclo.

Figura 12 – Remoção de sais após o separador a vácuo e no circuito de reciclo no

processo de recuperação do MEG.

Fonte: Nazzer e Keogh (2006, p. 3), adaptada.

O aquecedor de reciclo é um item fundamental que deve aquecer de forma conﬁável
uma alta taxa de ﬂuxo do líquido com sais reciclado sem expor este a altas temperaturas
que podem promover degradação térmica do MEG, e sem permitir deposição de mate-
rial particulado em suspensão. Normalmente são utilizado trocadores de calor de alta
performance como o trocador em espiral ilustrado na Figura 13.

Figura 13 – Trocador de calor em espiral.

(a) Operação.

(b) Construção.

Fonte: Nazzer e Keogh (2006, p. 5).

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

14

Capítulo 1.

INTRODUÇÃO

A Figura 14 ilustra o Processo PureMEG™ da Cameron que é utilizado na plata-
forma PMXL-1. Nele podem ser vistos vários dos conceitos e equipamentos comentados
aqui. Este processo consiste de três etapas principais:

a) pré-tratamento do MEG ⇒ remoção de hidrocarbonetos;
b) recuperação do MEG ⇒ remoção de sais;
c) regeneração do MEG ⇒ remoção de água.

Este processo recupera até 99,5% de MEG.

Figura 14 – Processo PureMEG™ da Cameron.

Fonte: Cameron (2012, p. 5), adaptada.

Como ﬁca notório, o conhecimento da solubilidade dos sais nas misturas aquosas com
MEG, nos equipamentos da unidade de MEG, é informação crucial para o monitoramento
das formações de incrustação de sais durante o processo.

Dados de solubilidade, densidade, pH e condutividade tem sido obtidos da literatura
e em especial no laboratório de Fotoquímica e Equilíbrio de Fases (FOTEQ) da Universidade
Federal do Rio Grande do Norte (UFRN). Os dados gerados pelo FOTEQ tem por meta
possibilitar um melhor monitoramento do processo de recuperação do MEG, visando
suprir a escassez dessas informações para sistemas aquosos com MEG e sais. Este fato
também resulta na demanda de modelos para estes sistemas aquosos com eletrólitos e
solvente orgânico, tema cientíﬁco desta tese de doutorado. Neste sentido, também deve
ser ressaltada a importância do projeto no que diz respeito à demanda da indústria do
petróleo, em particular o campo de Mexilhão na Bacia de Santos que se destaca por sua
signiﬁcativa reserva.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 1.

INTRODUÇÃO

15

Dentro do exposto até aqui, tem-se que esta tese de doutorado visa abordar,
através de modelagem termodinâmica, o comportamento de sistemas aquosos selecionados,
contendo sais e MEG, presentes no processo de recuperação do MEG.

Com a ﬁnalidade meramente ilustrativa, a Figura 15 mostra o módulo de recupera-
ção do MEG pelo processo PureMEG™ da Cameron utilizado na plataforma PMXL-1.

Figura 15 – Unidade de MEG utilizada na plataforma PMXL-1.

Fonte: Cameron (2012, p. 6).

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

CAPÍTULO 2

REVISÃO BIBLIOGRÁFICA

2 REVISÃO BIBLIOGRÁFICA

19

Neste capítulo, inicialmente, deﬁnições fundamentais e teorias para soluções ele-
trolíticas e mistura de solventes são apresentadas. Em seguida, é realizada uma revisão
dos dados experimentais encontrados na literatura para soluções aquosas eletrolíticas com
apenas um sal e um solvente orgânico. Por último, são apresentados modelos termodinâ-
micos para soluções eletrolíticas e mistura de solventes e, também, algumas ferramentas
computacionais disponíveis para a implementação (ou apenas utilização) destes modelos.

2.1 Equilíbrio de Fases para Sistemas com Eletrólitos
2.1.1 Escalas de concentração

Geralmente a concentração de uma solução eletrolítica é expressa em molalidade,

molaridade ou fração molar.

A molalidade é deﬁnida como o número de moles do soluto por quilo de solvente:

bi

1 ≡ ni
msolv

=

ni

nsolvMsolv

(2.1)

onde bi é a molalidade de i, ni é o número de moles de i, msolv é a massa do solvente e Mi
é a massa molar de i.

A molaridade é deﬁnida como o número de moles do soluto por litro de solução:

ci ≡ ni
V

(2.2)

onde ci é a molaridade de i e V é o volume da solução.

A fração molar é deﬁnida como a razão entre o número de moles do soluto pelo

número de moles total na solução:

xi ≡ ni
n

(2.3)

onde xi é a fração molar de i na fase líquida e n é o número de moles total na solução.

Como a molaridade é dependente da temperatura, está não é preferida como unidade
de concentração em soluções eletrolíticas. Daqui para a frente será utilizada, quando
for necessário maior clareza, os subscritos b, c ou x respectivamente para molalidade,
molaridade ou fração molar, como indicação da escala de concentração utilizada.
1 Neste trabalho de tese de doutorado, optou-se pelo uso de bi para representar a molalidade de i, ao
invés de mi, para evitar-se confusão de notação com massa de i (mi), conforme Cohen et al. (2007),
p. 48 e Thompson e Taylor (2008), p. 28.

20

2.1.2 Potencial químico

Capítulo 2. REVISÃO BIBLIOGRÁFICA

O potencial químico é deﬁnido como:

" ∂G

#

µi ≡

∂ni

T,P,nj6=i

(2.4)

onde µi é o potencial químico de i, G é a energia livre de Gibbs, T é a temperatura, P é a
pressão e nj6=i designa todos os números de moles exceto o referente a i.

O potencial químico relaciona-se a atividade ou concentração e ao coeﬁciente de

atividade da seguinte forma:

µi = µ•

i + RT ln ai = µ•

i + RT ln (γiξi)

(2.5)

i é o potencial químico de i em um estado padrão apropriadamente escolhido, R

onde µ•
2 é
a constante universal do gases ideais, ai é a atividade de i, γi é o coeﬁciente de atividade
de i e ξi é uma escala de concentração conveniente.

O potencial químico constitui uma grandeza de suma importância na abordagem
em equilíbrio de fases. Como exemplo desta abordagem, tem-se a Figura 16, que representa
o equilíbrio sólido-líquido de um eletrólito MX e uma mistura de solventes: água e MEG.
Este sistema apresenta quatro fases: três fases líquidas (cor azul) e uma sólida (cor marrom).
A condição de equilíbrio para este sistema é a igualdade dos potenciais entre as fases. Logo,
o equilíbrio deste sistema pode ser descrito em termos da seguinte equação:

s
MX = µ

µ

{H2O}
MX = µ

{MEG}
MX

= µ

{H2O+MEG}
MX

(2.6)

s
MX é o potencial químico de MX na fase sólida e µ

são os
onde µ
potenciais químicos de MX respectivamente nas fases líquidas H2O, MEG e H2O + MEG.

e µ

{H2O}
MX , µ

{MEG}
MX

{H2O+MEG}
MX

Figura 16 – Representação do equílibrio de um elétro-

lito em mistura de solventes.

Fonte: O autor.

2 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA

2.1.3 Estado padrão

21

Um equívoco comum é dizer que o estado padrão do potencial químico para o
soluto é o soluto à temperatura e pressão do sistema e à diluição inﬁnita. Isso não é
correto, pois, à diluição inﬁnita, o potencial químico do soluto é negativamente inﬁnito
(PRAUSNITZ; LICHTENTHALER; AZEVEDO, 1999). O estado padrão do potencial
químico para um soluto precisa estar à uma concentração ﬁxa (diferente de zero), conhecida
como concentração unitária. Esta é usada por ser o seu logaritmo igual a zero.

O estado padrão do potencial químico não precisa necessariamente ser realizável,

mas precisa ser bem deﬁnido.

Para soluções concentradas, ou líquidos puros, a fração molar é uma escala de
concentração mais conveniente, pois para soluções concentradas os valores tanto para
molaridade quanto para a molalidade tendem a serem enormes, e no caso de líquidos puros
atingem o inﬁnito. Uma convenção de estado padrão comumente usada é a convenção por
coeﬁciente de atividade racional simétrico, onde normaliza-se de forma que os coeﬁcientes
de atividade são unitários para componentes puros, assim sendo:

(2.7)

onde µ

µi = µ

0
i + RT ln (γixi)
0
i é o potencial químico racional simétrico de i.
A Figura 17 ilustra o conceito de solução ideal hipotética. Nela a linha tracejada
representa uma solução ideal hipotética e a linha contínua uma solução real. A atividade
no estado padrão é dada pela ordenada do ponto A e corresponde a concentração unitária.

Figura 17 – Conceito de solução ideal hipotética.

Fonte: Prausnitz, Lichtenthaler e Azevedo (1999, p. 511),

adaptada.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

22

Capítulo 2. REVISÃO BIBLIOGRÁFICA

A atividade real do soluto para uma concentração de 1,5 é dada pela ordenada do ponto
C, enquanto que na solução ideal hipotética é dada pela ordenada do ponto B. Na solução
ideal, a atividade é igual a concentração porque, na solução ideal, o coeﬁciente de atividade
é unitário para todas as concentrações de soluto. Assim, o coeﬁciente de atividade em
soluções reais:

γi = ai/ξi
é dado pela razão entre os segmentos CD e BD.

(2.8)

Como as propriedades dos íons não podem ser medidas (reportadas) independente-
mente dos outros íons em solução, usa-se normalmente a convenção assimétrica baseada
na fração molar ou na molalidade (KONTOGEORGIS; FOLAS, 2010). Na convenção por
coeﬁciente de atividade racional assimétrico normaliza-se de forma que os coeﬁcientes de
atividade são unitários a diluição inﬁnita, ou seja, em solvente puro:
γ∗
i,x = γi/γ∞
(2.9)
i,x é o potencial químico racional assimétrico, γ∗
(cid:79)
i,x é o coeﬁciente de atividade
onde µ
racional assimétrico e γ∞
é o coeﬁciente de atividade em diluição inﬁnita. Na convenção
por coeﬁciente de atividade molal assimétrico, normaliza-se como antes, usando, agora, a
molalidade adimensionalizada pela razão com a molalidade unitária (b0

i,x + RT ln(cid:16)

3), ou seja:

µi = µ

γ∗
i,xxi

com

(cid:17)

(cid:79)

i

i

 γ∗

!

µi = µ

(cid:17)
i,b é o potencial químico molal assimétrico, γ∗
(cid:79)

i,b + RT ln(cid:16)

(cid:79)
i,b + RT ln

γ∗
i,bbi

i,bbi
b0

= µ

(cid:79)

onde µ
assimétrico e xsolv é a fração molar de solvente na fase líquida.

com

γ∗
i,b = γ∗

i,xxsolv

(2.10)

i,b é o coeﬁciente de atividade molal

2.1.4 Coeﬁciente de atividade médio iônico e molalidade média iônica

Representa-se a dissociação de um eletrólito eletricamente neutro Mν+Xν− em ν+
cátions (cada qual com carga z+) e ν− ânions (cada qual com carga z−) da seguinte forma:

(2.11)
onde a eletroneutralidade requer que ν+z++ν−z− = 0. Por comodidade, abrevia-se Mν+Xν−
para MX.

Mν+Xν− (cid:10) ν+Mz+ + ν−Xz−

De Prausnitz, Lichtenthaler e Azevedo (1999), tem-se as deﬁnições de coeﬁciente

de atividade médio iônico (γ±) e molalidade média iônica (b±):

γ± ≡ (γ+ν+ γ−ν−) 1
b± ≡ (b+ν+ b−ν−) 1

(2.12)
(2.13)
onde γ+ e γ− são os coeﬁcientes de atividade respectivamente do cátion e do ânion, b+ e
b− são as molalidades respectivamente do cátion e do ânion, e ν = ν+ + ν−.
3 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

ν

ν

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA

2.1.5 Leis limitantes

23

Por lei limitante compreende-se aquela cuja validade (aplicação) encontra-se na

região de diluição inﬁnita.

Numa solução ideal, o cálculo das propriedades de mistura requer a composição
da mistura e as propriedades dos componentes puros. A solução ideal de um sistema não
eletrolítico de acordo com a Lei de Raoult para o equilíbrio líquido-vapor (ELV) é:

yiP = xiP

sat
i

(2.14)

onde yi é a fração molar de i na fase vapor e P

sat
i

é a pressão de vapor de i puro.

Em soluções reais diluídas, com respeito ao soluto, o solvente tende a seguir a Lei
de Raoult. Uma solução diluída ideal é a solução onde o solvente segue a Lei de Raoult e o
soluto segue a Lei de Henry:

yiP = xiHi

(2.15)

onde Hi é a constante de Henry para i.

Em soluções eletrolíticas reais, as interações entre os íons através de suas cargas,
que são chamadas interações coulombianas, provocam desvios da idealidade, podendo estes
desvios, mesmo a baixas concentrações, serem bastante relevantes. Estas forças de caracte-
rística eletrostática possuem alcance bem maior que as forças intermoleculares presentes
em soluções apolares, cuja signiﬁcância ocorre apenas a curta distância. Considerando,
também, que os íons não são voláteis a pressão atmosférica e a temperatura ambiente,
tudo isso conduz a necessidade de uma teoria especíﬁca para descrever o comportamento
de soluções eletrolíticas. Como os desvios do comportamento ideal estão relacionados
as forças eletrostáticas dos íons em solução, tem-se que, uma teoria ou modelo eﬁciente
para soluções eletrolíticas reais, necessita ser capaz de descrever e quantiﬁcar a força das
interações coulombianas, tanto as atrativas quanto as repulsivas. Na 3ª década do século
XX, a partir da hipótese de que cada íon, individualmente, esteja cercado por uma nuvem
de íons de carga oposta, a qual promove um efeito de blindagem, Debye e Hückel (1923)
formularam uma teoria para soluções eletrolíticas. Nesta teoria, a medida do comprimento
desta blindagem recebe o nome de comprimento de Debye-Hückel (κ−1), deﬁnido como:

!1/2

  ε0εrkBT

2NAe02Ic

κ−1 ≡

(2.16)

4 é a permissividade do vácuo, εr é a contante dielétrica (também conhecida como
4 é o número de Avogadro,

4 é a constante de Boltzmann, NA

onde ε0
permissividade relativa), kB
e0

4 é a carga do elétron e Ic é a força iônica molar, deﬁnida como:

X

i

Ic ≡ 1
2

2

cizi

(2.17)

4 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

24

sendo zi a carga de i.

Capítulo 2. REVISÃO BIBLIOGRÁFICA

Debye e Hückel (1923) derivaram uma expressão simples para o coeﬁciente de

atividade:

ln γi,c = −

onde γi,c é coeﬁciente de atividade molar de i.

2

e0

zi

2

8πε0εrkBT κ−1

(2.18)

Para soluções aquosas diluídas próximo a temperatura ambiente, não existe diferença
numérica signiﬁcativa entre molalidade e molaridade (PRAUSNITZ; LICHTENTHALER;
AZEVEDO, 1999). Assim sendo, lembrando que:
ci = ρsolvbi

(2.19)

onde ρsolv densidade absoluta do solvente, pode-se trocar as unidades do coeﬁciente de
atividade e da força iônica na Equação 2.18, resultando em:

ln γi,b = −Aγzi

2

Ib

1/2

(2.20)
onde γi,b é coeﬁciente de atividade molal de i, Aγ é a constante de Debye-Hückel na forma
para coeﬁciente de atividade, deﬁnida como:
Aγ ≡ (2NAρsolv)1/2
X

8π
e Ib é a força iônica molal, deﬁnida como:
Ib ≡ 1
2

  e0

!3/2

(2.21)

(2.22)

ε0εrkBT

bizi

2

2

i

Para o eletrólito Mν+Xν−, usando a Equação 2.13, e desprezando o subscrito b na

Equação 2.20, obtém-se a Lei de Debye-Hückel:

ln γ± = −Aγ|z+z−|I 1/2

(2.23)

onde I = Ib é a força iônica.

O comportamento descrito pela Lei de Raoult (Equação 2.14) e pela Lei de Henry
(Equação 2.15) tende a ser o comportamento de soluções reais conforme estas tendam
a ser diluídas. Da mesma forma, a Lei de Debye-Hückel providencia uma representação
satisfatória do comportamento dos coeﬁcientes de atividade em soluções diluídas, sendo
limitada para soluções aquosas com força iônica até 0,01 mol/kg. A Lei de Debye-Hückel
Extendida (GUGGENHEIM, 1935) aumentou o limite de aplicação no cálculo do coeﬁciente
de atividade para soluções aquosas com força iônica até 0,1 mol/kg:

ln γ± = −A|z+z−|I 1/2
1 + aBI 1/2

(2.24)

onde A e B são parâmetros dependentes da temperatura, e a é um parâmetro relacionado
ao tamanho dos íons. Outras extensões podem ser obtidas pela adição de mais termos a
Equação 2.24 conforme apresentado em Guggenheim (1935).

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA

25

2.1.6 Energia livre de Gibbs para soluções eletrolíticas reais

Soluções reais podem ser descritas a partir de seus desvios em relação à idealidade

por propriedades de excesso. Para uma propriedade (cid:77), temos:

E ≡ (cid:77)− (cid:77)
id

(cid:77)

(2.25)
id representa uma propriedade ideal.

onde (cid:77)

E representa uma propriedade de excesso e (cid:77)
Deﬁne-se propriedade parcial molar como:

" ∂(cid:77)

#

¯(cid:77)i ≡

∂ni

T,P,nj6=i

onde ¯Mi representa uma propriedade parcial molar de i.

De forma análoga a Equação 2.25, deﬁne-se propriedade parcial molar de excesso
de i ( ¯(cid:77)
E
i ):

onde ¯(cid:77)
id
i representa uma propriedade parcial molar ideal de i.
Para a propriedade parcial molar da energia livre de Gibbs, que é função das
variáveis operacionais T e P, vale o Teorema de Euler ou característica de aditividade
(PRAUSNITZ; LICHTENTHALER; AZEVEDO, 1999), ou seja:

i ≡ ¯(cid:77)i − ¯(cid:77)
¯(cid:77)
E

id
i

G =X

¯Gi

ni

(2.26)

(2.27)

(2.28)

(2.29)

(2.30)

onde ¯Gi é a energia livre de Gibbs parcial molar de i.

i

Para um sistema aberto, multicomponente e com uma única fase, tem-se:

dG = V dP − SdT +X

¯Gidni

onde S é a entropia.

i

Dividindo G por RT e diferenciando em relação à T, tem-se:

(cid:18) G

(cid:19)

RT

d

= 1

RT

dG − G

(cid:18) S

RT

+ G
RT 2

RT 2 dT
(cid:19)

dT +X

i

(cid:18) G

(cid:19)

dP −
onde H é a energia livre de Helmholtz.

= V
RT

RT

d

Dividindo a Equação 2.29 por RT e somando com a equação Equação 2.30, tem-se:

¯Gi
RT

dni

(2.31)

Como G = H−T S, tem-se, substituindo na Equação 2.30, uma relação fundamental

para G bastante útil em termodinâmica de soluções, ou seja:
¯Gi
RT

RT 2 dT +X

dP − H

= V
RT

(cid:18) G

(cid:19)

RT

d

i

dni

(2.32)

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

26

Capítulo 2. REVISÃO BIBLIOGRÁFICA

A partir da energia livre de Gibbs pode-se gerar outras propriedades termodinâmicas,
conforme pode ser visto em Prausnitz, Lichtenthaler e Azevedo (1999). Isto tudo está
resumido e ilustrado na Figura 18.

Figura 18 – Fluxograma de obtenção de propriedades termodi-

nâmicas a partir da energia livre de Gibbs.

Capacidade
Caloríﬁca

d
dT

Entalpia

d
dT

Volume e
Densidade

d
dP

Energia livre

de Gibbs

d
dni

Coeﬁciente de
Atividade e Coe-
ﬁciente Osmótico

minimização

Equilíbrio

Fonte: O autor.

Para soluções aquosas com eletrólitos, como, por exemplo, um sal MX completa-
mente dissociado em água, à pressão e temperatura constantes, a partir da Equação 2.28,
da Equação 2.26 e da Equação 2.4, pode-se expressar a energia livre de Gibbs como:

G =X

X

niµi = nH2OµH2O + nMX

νiµi

(2.33)

i

i

onde nH2O e nMX são os números de moles respectivamente da água e do eletrólito MX, e
µH2O é o potencial químico da água.

2.1.7 Fugacidade

Da termodinâmica clássica, a temperatura constante, temos:
ˆfi
f•

(cid:17) ⇒ µi = µ•

(cid:16)ln ˆfi

dµi≡RT d

i + RT d ln

i

(2.34)

onde ˆfi é a fugacidade de i na solução e f•
apropriadamente escolhido.

i é a fugacidade de i em um estado padrão

A fugacidade de um componente i pode ser expressa, usando convenção simétrica

e escala de fração molar, como:

ˆfi = xiγif

0
i

(2.35)

onde f

0
i é a fugacidade racional simétrica de i.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA

27

A fugacidade de um componente i pode ser expressa, usando convenção assimétrica

e escala de fração molar, como:

ˆfi = xiγ∗

i Hi,x

(2.36)

onde Hi,x é a constante de Henry racional.

A fugacidade de um componente i pode também ser expressa, usando convenção

assimétrica e escala de molalidade (b), como:
ˆfi = biγ∗

i,bHi,b

onde Hi,b é a constante de Henry molal.

2.2 Dados Experimentais de Solubilidade

(2.37)

A qualidade dos dados experimentais é de suma importância em qualquer trabalho
cientíﬁco. No entanto, nem sempre os dados que necessitamos estão disponíveis na literatura.
Embora tenha aumentado nos últimos anos, a quantidade de dados experimentais de
solubilidade de sais em mistura de solventes ainda são considerados muito escassos. Mesmo
dados experimentais de solubilidade de apenas um sal em um único solvente (como, por
exemplo, o MEG), por vezes, são muito difíceis de serem encontrados. Este fato, aliado
a uma possível não conﬁabilidade nos dados oriundos da literatura, justiﬁca, em muitos
casos, a necessidade da realização de experimentos objetivando a simples reprodução ou
mesmo a coleta integral de novos dados experimentais.

Uma grande compilação de dados experimentais de solubilidade de sais é o banco
de dados presente em Linke e Seidell (1958) e Linke e Seidell (1965). Nesta compilação
observa-se a carência de dados experimentais para o MEG. Desta compilação, juntamente
com Lide (2009), foram coletados dados de solubilidade dos sais KCl e NaCl em água.
Estes dados estão resumidos na Tabela 1.

Tabela 1 – Banco de dados de solubilidade de sal em água a dife-

rentes temperaturas.

Sistema

Faixa de
Temperatura

Número de Pontos Referência
Experimentais

Água+KCl

Água+NaCl

de 0 a 100 ℃ 12
de -6 a 454 ℃ 33
de 0 a 100 ℃ 12
de 0 a 450 ℃ 25

Fonte: O autor.

Lide (2009)
Linke e Seidell (1965)
Lide (2009)
Linke e Seidell (1965)

Embora, conforme mencionado anteriormente, dados de solubilidade de sais em
misturas de solventes sejam escassos, após um extensa pesquisa, conseguiu-se encontrar na

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

28

Capítulo 2. REVISÃO BIBLIOGRÁFICA

literatura dados de solubilidade para um sal em meio aquoso com um álcool ou glicol. A
Tabela 2 apresenta um resumo contendo vários destes dados. Estes estão agrupados numa
série sistemática de misturas, seguidas por suas isotermas, número de pontos experimentais
e a referência consultada.

Tabela 2 – Banco de dados de solubilidade de sal em mistura de solventes.
Sistema

Temperatura (K)

Número de Pontos Referência
Experimentais

Água+Etanol+KCl

Água+Etanol+NaBr
Água+Etanol+ NaCl
Água+Glicerol+Ba(NO3)2
Água+Glicerol+NaCl
Água+Gligerol+KCl
Água+MEG+Ba(NO3)2
Água+MEG+K2SO4
Água+MEG+KBr
Água+MEG+KCl

Água+MEG+KI
Água+MEG+NaCl

Água+Metanol+KCl
Água+Metanol+NaBr
Água+Metanol+NaCl

Fonte: O autor.

298,15 | 323,15 | 348,15
298,15 | 323,15 | 348,15
298,15 | 323,15 | 348,15
298,15 | 323,15 | 348,15
298,15
298,15
298,15
298,15
303,15
303,15
298,15 | 323,15 | 348,15
298,15
298,15
303,15
298,15
303,15
323,15
293,15 | 318,15 | 348,15
363,15 | 383,15 | 403,15
298,15
298,15
303,15
298,15
298,15 | 323,15
298,15 | 323,15
298,15 | 323,15

6 | 6 | 6
9 | 9 | 9
9 | 9 | 9
9 | 9 | 7
6
6
6
7
9
6
7 | 7 | 7
1
7
6
11
6
6
14 | 12 | 12
12 | 13 | 13
1
7
6
11
9 | 9
9 | 9
9 | 9

Chiavone-Filho e Rasmussen (1993)
Pinho e Macedo (2005)
Pinho e Macedo (2005)
Pinho e Macedo (1996)
Kraus, Raridon e Baldwin (1964)
Kraus, Raridon e Baldwin (1964)
Kraus, Raridon e Baldwin (1964)
Kraus, Raridon e Baldwin (1964)
Trimble (1931)
Trimble (1931)
Chiavone-Filho e Rasmussen (1993)
Isbin e Kobe (1945)
Kraus, Raridon e Baldwin (1964)
Trimble (1931)
Zhou et al. (2010)
Trimble (1931)
Baldwin, Raridon e Kraus (1969)
Figueiredo et al. (2014 (em Publicação))

Isbin e Kobe (1945)
Kraus, Raridon e Baldwin (1964)
Trimble (1931)
Zhou et al. (2010)
Pinho e Macedo (1996)
Pinho e Macedo (2005)
Pinho e Macedo (1996)

Foi observado, na literatura, uma escassez de trabalhos com dados de solubilidade de
sal em meio aquoso com MEG. Este fato destaca a importância do trabalho de Figueiredo
et al. (2014 (em Publicação)) desenvolvido pelo grupo de pesquisa do FOTEQ.

Outros trabalhos experimentais de sal em meio aquoso com MEG, que reportam
outras propriedades que não a solubilidade, foram encontrados na literatura: Tsierkezos e
Molinou (1998) estudaram propriedades termodinâmicas como volume de excesso, visco-
sidade e refração da água com etilenoglicol à diferentes temperaturas; Braun, Persson e
Karlsson (2001) estudaram soluções ternárias de MEG+2-amino-2-metil-1-propanol+água
em diferentes concentrações obtendo dados de viscosidade e densidade, e Sandengen e
Kaasa (2006) estudaram as soluções aquosas de MEG na presença de sais com respeito à
condutividade e densidade, no sentido de gerarem curvas de referência para determinar as
concentrações a partir dessas duas propriedades para sistemas ortogonais.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA
2.3 Modelos Termodinâmicos para Eletrólitos

29

Nesta seção são descritos modelos termodinâmicos que podem ser aplicados a dados
de solubilidade de sais em misturas de solventes, seguindo uma ordem de complexidade, ou
seja, partindo do modelo ideal, passando pela correlação empírica de Setchenov (chamada
também de Setschenow ou Sechenov) e, por último, aplicando a correção das não idealidades
através do Modelo de Pitzer adaptado para mistura de solventes.

2.3.1 Logaritmos ideal e de excesso da solubilidade de um sal em mistura de

solventes

Primeiramente, deve-se deﬁnir o logaritmo ideal da solubilidade de um sal em
mistura de solventes que, para uma mistura binária de solventes, foi deﬁnido por meio de
regra linear com a composição de cada solvente livre de sal:

iid ≡ x0

{H2O+MEG}
MX

H2O ln b

{H2O}
MX + x0

MEG ln b

{MEG}
MX

(2.38)

são as molalidades do sal MX respectivamente em água e em MEG.

{H2O+MEG}
é o logaritmo ideal da molalidade de MX na mistura água e MEG,
MX
MEG são as frações molares respectivamente da água e do MEG livres de sal e,
{MEG}
MX

H2O e x0
x0
{H2O}
e b
b
MX
A deﬁnição do logaritmo de excesso da solubilidade de um sal em mistura de
solventes (LORIMER, 1993) permite uma avaliação simpliﬁcada do comportamento das
soluções aquosas de MEG e com um sal. Isto ocorre, pois, quando considera-se solução
ideal não é necessário usar-se modelo de energia livre de excesso. Conforme visto na
Equação 2.25, deﬁne-se o logaritmo de excesso da solubilidade da seguinte forma:

iE ≡ ln b

−hln b

iid

{H2O+MEG}
MX

{H2O+MEG}
MX

{H2O+MEG}
MX

(2.39)

{H2O+MEG}
MX

é o logaritmo de excesso da molalidade de MX na mistura água e

hln b
iid

hln b
iE

onde hln b

onde hln b

MEG.

Essa abordagem ideal pode representar surpreendentemente bem, e de maneira
bastante simpliﬁcada, a inﬂuência do solvente na solubilidade do sal. Ela requer apenas o
conhecimento das solubilidades do sal nos solventes puros e descreve nestes extremos os
valores de maneira plena. Vale ressaltar que as soluções de água e MEG formam soluções
ideais (CHIAVONE-FILHO; PROUST; RASMUSSEN, 1993) para o ELV.

2.3.2 Equação de Setchenov

O efeito linear do solvente sobre a solubilidade do sal numa escala logarítmica pode
ser mensurado pela Equação de Setchenov (Equação 2.40), que expressa o efeito salting-out

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

30

Capítulo 2. REVISÃO BIBLIOGRÁFICA

(LEE, 1997), que é justamente o oposto do que ocorre no processo de regeneração do MEG,
mas que acompanha o mesmo fenômeno físico.

ln b

{H2O+MEG}
MX

= ln b

{H2O}
MX + kSx0

MEG

(2.40)

{H2O+MEG}
MX

onde b
é a molalidade de MX na mistura água e MEG, e kS é a constante de
Setchenov. Aplicando uma correlação equivalente entre o produto de solubilidade de um
componente em água e o mesmo em uma mistura de solventes (água+MEG) usando essa
equação de Setchenov, pode-se estimar o produto de solubilidade nesse novo meio solvente
(OLIVEIRA et al., 2010).

2.3.3 Modelo de Pitzer

Na termodinâmica de soluções eletrolíticas é comum expressar os modelos de
correção das não idealidades pelo coeﬁciente osmótico (solvente) ou pelo coeﬁciente de
atividade (soluto). A deﬁnição do coeﬁciente osmótico é dada pela Equação 2.41.

MH2OP
φ ≡ − ln aH2O

i bi

(2.41)

onde φ é o coeﬁciente osmótico, aH2O é a atividade da água e MH2O
água.

5 é a massa molar da

O Modelo de Pitzer foi desenvolvido a partir da teoria de Debye-Hückel, para
eletrólitos em meio aquoso, pela extensão por coeﬁcientes do virial. Este é apresentado
tanto para o coeﬁciente osmótico como para o coeﬁciente de atividade. O Modelo de Pitzer
expresso para o coeﬁciente osmótico é:
φ − 1 = |zM zX| f φMX + bMX

2 2 (νM νX)3/2

BφMX + bMX

(2.42)

2νM νX

ν

C φMX

ν

onde zM e zX são respectivamente as cargas do cátion e do ânion, f φMX é a função de
Debye-Hückel na forma para o coeﬁciente osmótico, isto é:

f φMX = −Aφ

I 1/2

1 + (cid:98)I 1/2

(2.43)

sendo que (cid:98)
forma para coeﬁciente osmótico, juntamente com I são expressos por:

5 é uma constante do modelo e Aφ, que é a constante de Debye-Hückel na

Aφ = Aγ
3
I = |zM zX|
bMX
b0

2

ν

(2.44)

(2.45)

e, prosseguindo, bMX é a molalidade de MX, νM e νX são os coeﬁcientes estequiométricos
respectivamente do cátion e do ânion, ν é coeﬁciente estequiométrico total, dado por:

5 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

ν = νM + νX

(2.46)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA

31

e, continuando, BφMX e C φMX são respectivamente o segundo e o terceiro coeﬁcientes do
virial nas formas para coeﬁciente osmótico, sendo C φMX um parâmetro do modelo, com
BφMX expresso como:

BφMX = β

(0)
MX + β

MX exp(cid:16)−αI 1/2(cid:17)

(1)

(2.47)

sendo que β
do modelo.

(0)
MX e β

(1)
MX são parâmetros do modelo, e, ﬁnalmente, α

6 que é uma constante

O Modelo de Pitzer expresso para o coeﬁciente de atividade é:

onde f γMX é a função de Debye-Hückel na forma para o coeﬁciente de atividade, isto é:

2νM νX

ν

BγMX + bMX

2 2 (νM νX)3/2

ν

C γMX

(2.48)

ln γ± = |zM zX| f γMX + bMX
" 2

f γMX = −Aφ

ln(cid:16)1 + (cid:98)I 1/2(cid:17) + I 1/2

1 + (cid:98)I 1/2

#

(2.49)

(2.50)

(2.51)

(cid:98)

"

e, continuando, BγMX e C γMX são respectivamente o segundo e o terceiro coeﬁcientes do
virial na forma para coeﬁciente de atividade, expressos como:

BγMX = 2β

(0)

(1)
MX + 2β
MX
α2I

 
2
1 + αI 1/2 − α
2

I

!

exp(cid:16)−αI 1/2(cid:17)#

1 −
MX = 3
C γ

2 C φ

MX

Seguindo a abordagem de Lorimer (1993), que usa a teoria de McMillan-Mayer,
é possível corrigir as não idealidades da fase líquida com uma equação de coeﬁciente de
atividade, como o Modelo de Pitzer. Este modelo foi desenvolvido para o solvente água e,
assim sendo, a aplicação dele em mistura de solventes requer uma estratégia para estimar
os parâmetros de interação entre solvente orgânico e sal.

No Modelo de Pitzer, para expressar-se o efeito térmico, os parâmetros devem ser

considerados dependentes da temperatura (ZEMAITIS JR. et al., 1986).

Lorimer (1993) aplicou o Modelo de Pitzer para misturas de solventes determinando
(1)
o parâmetro β
MX como função da constante dielétrica e da composição da mistura de
solventes livre de sal. Essa mesma abordagem foi aplicada nesta tese de doutorado e será
descrita no Capítulo 3.

2.4 Outros Modelos Termodinâmicos

Várias teses de doutorado no tema de modelagem termodinâmica de solubilidade
para sistemas aquosos com eletrólitos podem ser encontradas na Universidade Técnica da
6 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

32

Capítulo 2. REVISÃO BIBLIOGRÁFICA

Dinamarca (CARDOSO, 1988; CHIAVONE-FILHO, 1993; NICOLAISEN, 1994; THOM-
SEN, 1997). Nestes trabalhos pode-se observar o potencial de aplicação dos modelos de
coeﬁciente de atividade para sistemas aquosos com sais e MEG. Esta abordagem, entre-
tanto, requer informações experimentais para a estimação dos parâmetros dos respectivos
modelos e, por conta da escassez de dados experimentais, há necessidade de desenvolvi-
mento de modelos para as misturas especíﬁcas, como é o caso de sistemas aquosos com
MEG e sais.

Renon (1996) e Anderko, Wang e Rafal (2002) apresentam resumos de diferentes
modelos utilizados para soluções eletrolíticas com mistura de solventes, com proposta de
classiﬁcação, tipo de equilíbrio, estados de referência e algumas hipóteses simpliﬁcadoras
adotadas na modelagem. Observa-se que novos modelos são obtidos através de combinações
de modelos anteriores para representar contribuições de interações entre espécies, de longe,
médio (interações especíﬁcas) e curto alcance.

Liu e Watanasiri (1996) e Chen e Song (2004) utilizaram o modelo NRTL (Non-
Random Two Liquid) para representar as interações de curto alcance e o modelo de
Pitzer-Debye-Hückel (PDH) para as interações de longo alcance.

Pinho e Macedo (1996), Iliuta, Thomsen e Rasmussen (2000), Wang, Anderko
e Young (2002), Thomsen, Iliuta e Rasmussen (2004), Wang et al. (2006), Kosinski et
al. (2007), (FØSBOL; THOMSEN; STENBY, 2009) utilizaram o modelo UNIQUAC
(UNIversal QUAsiChemical) para representar as interações de curto alcance e o modelo
PDH para as interações de longo alcance. Observa-se em alguns dos trabalhos citados, o
uso da equação de estado cúbica de Soave-Redlich-Kwong (SRK) para o ELV e a descrição
de interações especíﬁcas entre íons realizadas por uma expansão de virial.

Grenthe e Plyasunov (1997) ﬁzeram uma comparação entre a modelo SIT (Speciﬁc

ion Interaction Theory) de Brønsted-Guggenheim-Scatchard e o modelo PDH.

Dahl e Macedo (1992) utilizaram o modelo de contribuição de grupos UNIFAC
(UNIQUAC Functional-group Activity Coeﬃcients) juntamente com a equação de estado
cúbica SRK para ELV e equilíbrio líquido-líquido (ELL) de misturas com eletrólitos fortes.
Thomsen (1997) desenvolveu um modelo UNIQUAC estendido para soluções aquosas
com eletrólitos baseado nas seguintes propriedades de equilíbrio e calorimétricas: atividade,
coeﬁciente osmótico, grau de dissociação, densidade, calor de diluição e de solução e
capacidade caloríﬁca. A partir destes novos parâmetros, foram elaborados diagramas de
fases e simulações de processos, seguidas de otimização. O trabalho de Thomsen (1997) é
uma importante referência, mas não se aplica diretamente a mistura de solventes, foco
desta tese de doutorado.

Em Lorimer (1993) é apresenta uma modelagem não convencional para sistemas
eletrolíticos com mistura de solventes, partindo-se do desenvolvimento baseado em soluções

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 2. REVISÃO BIBLIOGRÁFICA

33

aquosas. Os modelos derivados do Modelo de Pitzer são de utilização convencional na
abordagem de soluções aquosas eletrolíticas (ZEMAITIS JR. et al., 1986). Estes mo-
delos são encontrados nas versões mais atualizadas de simuladores de processos como
o AspenHYSYS® (aspentech.com). Entretanto, como parâmetros de íons e moléculas
orgânicas ou grupos funcionais são raros e necessários nestes modelos, temos que este fato
compromete as simulações de sistemas aquosos eletrolíticos com misturas de solventes.

Métodos de cálculo de equilíbrio de fases e fundamentação são encontrados em
livros textos da área (SMITH; VAN NESS; ABBOTT, 2005; WALAS, 1985; PITZER,
1995; PRAUSNITZ; LICHTENTHALER; AZEVEDO, 1999; SANDLER, 1993).

Os modelos de coeﬁciente de atividade desenvolvidos para soluções não eletrolíticas,
como UNIQUAC (ABRAMS; PRAUSNITZ, 1975), têm sido extensivamente aplicados.
Estes modelos se caracterizam por uma forte ﬂexibilidade matemática permitindo correlação
de dados de equilíbrio para misturas complexas e também possuem fundamentação teórica.
O modelo UNIQUAC+Debye-Hückel foi aplicado para a modelagem de solubilidade
de sais em mistura de solventes por Chiavone-Filho e Rasmussen (2000). Contudo, com base
na literatura, é mais adequado o uso de modelos normalizados com a convenção assimétrica
para sistemas com eletrólitos. Portanto, o modelo de Pitzer (1973) com a modelagem
de solubilidade de excesso apresentada por Lorimer (1993) (que aplica a abordagem de
McMillan-Mayer) apresenta-se mais coerente do ponto de vista de termodinâmica molecular
e projeto de processos.

2.5 Ferramentas Computacionais

O uso de ferramentas computacionais para a resolução de problemas em equilíbrio
de fases de sistemas com eletrólitos se faz necessário devido à quantidade enorme de cálculos
e a complexidade destes. A utilização destas ferramentas acompanhou o desenvolvimento
das linguagens de computação, bem como dos programas computacionais com aplicações
especíﬁcas, onde, hoje, cada qual apresenta suas vantagens:

a) A linguagem de programação Fortran (gcc.gnu.org/Fortran) apresenta uma
grande quantidade de bibliotecas matemáticas já consolidadas, como por exem-
plo, as bibliotecas numéricas e estatísticas IMSL (International Mathematics
and Statistics Library) (roguewave.com);

b) A linguagem de programação C++ (gcc.gnu.org/C++) continua sendo a mais
utilizada no desenvolvimento ﬁnal de programas ou aplicações. Nela, a progra-
mação de alto nível, simpliﬁcada e rápida, permite excelentes resultados no
nível de interação com o usuário;

c) Destacam-se, também, os programas desenvolvidos para atividades especíﬁcas

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

34

Capítulo 2. REVISÃO BIBLIOGRÁFICA

de simulação de processos como, por exemplo, o conhecido AspenHYSYS®
(aspentech.com), que apresenta um conjunto de ferramentas, inclusive gráﬁcas
que permitem reproduzir por simulação muitos dos processos encontrados na
indústria de petróleo e gás natural;

d) Outro destaque, são os programas com uma grande variedade de pacotes para
aplicações especíﬁcas em diferentes áreas, indo desde pacotes matemáticos a paco-
tes de engenharia, como por exemplo: o MATLAB® (mathworks.com/MATLAB)
e Simulink® (mathworks.com/Simulink), ou o seu clone livre: o Scilab (scilab.org);
e) Existem linguagens de programação, ditas interpretadas, cujo código não é
executado diretamente pelo sistema operacional e sim indiretamente por um
programa chamado interpretador. Este fato implica em perda de desempenho em
relação a outras linguagens que, após o seu código ser compilado, são executadas
diretamente pelo sistema operacional. Porém, hoje, com os computadores cada
vez mais rápidos, este fato torna-se cada vez menos relevante, implicando numa
demanda menor de otimização do código para a máquina objetivando ganho
de velocidade. Em contrapartida, cada vez é dado mais espaço em relação à
otimização do código para o programador, cujo objetivo é uma melhor inte-
ração com o usuário. Neste aspecto, destaca-se a linguagem de programação
Python (python.org), cuja otimização em relação ao programador permite até
a mudança dinâmica da programação, ou seja, em tempo de execução. O des-
taque do Python em relação a outras linguagens também é evidente pela sua
característica de ser multiplataforma, permitindo, sem grandes mudanças, a
execução do mesmo código em diferentes sistemas operacionais como, por exem-
plo: Windows® (windows.microsoft.com), Mac OS X® (apple.com) e Ubuntu®
(ubuntu.com). Também possui licença livre, o que é uma tendência mundial,
apresenta bibliotecas numéricas avançadas, como o NumPy (numpy.org), cientí-
ﬁcas, como o SciPy (scipy.org), gráﬁcas, como o matplotlib (matplotlib.org), de
excepcional qualidade, além do desenvolvimento em programação visual, por
meio do PySide (qt-project.org), ser simples e totalmente multiplataforma.

f) No desenvolvimento de aplicativos, destaca-se o Ambiente de Desenvolvimento
Integrado (IDE) Eclipse (eclipse.org), que através de plugins, ou seja, módulos
que ampliam as funções do aplicativo, consegue suportar as mais diversas
linguagens de programação, além de permitir depuração e otimização, suporte
a idiomas, gerência de versões, entre outras funcionalidades.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

CAPÍTULO 3
METODOLOGIA

3 METODOLOGIA

37

Neste capítulo, inicialmente explica-se sobre a estratégia utilizada na abordagem
desta tese de doutorado. Em seguida, mostra-se como foram selecionados os sistemas
estudados e apresenta-se os dados de equilíbrio que foram coletados e utilizados. Continua-
se mostrando a forma de cálculo de diversas grandezas. A seguir, explica-se os algoritmos
de cálculos usados pelo programa gerado (JAFOSSMS - Solubilidade de Sais em Mistura de
Solventes). E por último descreve-se a implementação e forma de operação deste programa.
A Figura 19 ilustra de forma resumida a metodologia empregada neste trabalho de tese de
doutorado.

Figura 19 – Fluxograma simpliﬁcado da metodologia

empregada nesta tese de doutorado.

Deﬁnição dos sistemas a serem estudados

Coleta de dados experimentais de solubilidade
de sais em misturas de solventes da literatura

Modelagem dos dados experimentais de so-
lubilidade de sais em mistura de solventes

Simulação e testes com modelo implementado

Fonte: O autor.

Como pode ser observado na Figura 19, a primeira etapa consistiu em deﬁnir quais
os sistemas a serem estudados. Para tanto, considerou-se, entre outros critérios, a disponi-
bilidade de dados experimentais na literatura. Estes dados de solubilidade foram coletados
juntamente com outros necessários a implementação, na etapa seguinte, dos métodos de
cálculos para os modelos escolhidos e propostos. Após a transcrição do modelo em código
computacional foram feitas simulações e testes para veriﬁcação da reprodutividade do
modelo implementado em relação a conjuntos novos de dados experimentais. Tudo será
detalhado nas próximas seções.

38
3.1 Estratégia para Abordagem do Trabalho

Capítulo 3. METODOLOGIA

Em modelagem e simulação a partir de dados experimentais, destaca-se a estratégia
adotada pela Universidade Técnica da Dinamarca, aqui ilustrada na Figura 20. Neste
trabalho de tese de doutorado procurou-se utilizar esta mesma ideia. Esta, parte da
classiﬁcação de três tipos de atividades necessárias ao êxito do trabalho, a saber:

a) DADOS: dados experimentais;

b) MODELOS: modelos e teorias;

c) MÉTODOS: métodos e ferramentas de cálculo.

Figura 20 – Estratégia de abordagem do trabalho

desta tese de doutorado.

DADOS

MODELOS

MÉTODOS

Fonte: O autor.

Os dados experimentais, que na Figura 20 estão, de propósito, em nível de destaque
(mais elevados), reforçam a importância da qualidade destes e a prioridade que deve
ser-lhes dada, considerando-os como fatores representativos da realidade do problema
a ser abordado. Em seguida tem-se os modelos e teorias, que tanto podem ser inéditos
como desenvolvidos (ou aperfeiçoados) a partir de conceitos já existentes, cujo objetivo é
representar o melhor possível os dados experimentais (a realidade). Em igual nível tem-se
os métodos e ferramentas de cálculo cujo objetivo é quantiﬁcar numericamente resultados
advindos dos modelos e teorias de modo a compará-los com os dados experimentais. Isto é
obtido por métodos numéricos e ferramentas computacionais que resolvem o modelo ou
teoria propostos.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA
3.2 Seleção dos Sistemas

39

No processo de regeneração do MEG, conforme foi apresentado no Capítulo 1,
podem ocorrer problemas operacionais por formação de precipitados em locais indesejáveis
nos equipamentos. O conhecimento sobre as condições de formação destes precipitados
é essencial para poder evitá-los. Portanto, o estudo do equilíbrio de fases em sistemas
com espécies iônicas presentes na água de produção faz-se extremamente necessário. Para
isto poder ser feito é preciso, primeiramente, o conhecimento da composição da água de
produção. A Tabela 3 apresenta as características da água de formação representativa do
campo de Mexilhão, coletada do poço 3-MXL-3-SPS.

Tabela 3 – Características da água de
formação do reservatório do
campo de Mexilhão.
Valor
52.000 mg/L
3.400 mg/L
67 mg/L
31.000 mg/L
670 mg/L
4.300 mg/L
1,9 mg/L
139.500 mg/L
230.175 mg/L
<10 mg/L
1.540 mg/L
-
8,1

Parâmetro
Na+
K+
Mg2+
Ca2+
Ba2+
Sr2+
Ferro total
Cl−
Salinidade (NaCl)
SO4−
Br−
Alcalinidade Total (HCO−
3 )
pH

Fonte: Petrobras (2007, p. 110).

Dentre as espécies iônicas presentes na água de formação, considerando que a água
de produção possui composição semelhante a de formação e, também, em razão da maior
disponibilidade de dados experimentais na literatura e a relevância destes íons, optou-se
por selecionar, os seguintes sistemas para estudo através de modelagem e simulação com
respeito ao comportamento da solubilidade dos sais e outras propriedades:

a) Água+MEG+NaCl;

b) Água+MEG+KCl.
Dados de ELV de sistemas aquosos com alcoóis (metanol e etanol) na presença de
um eletrólito forte, a saber: o cloreto de sódio (NaCl), também foram estudados neste
trabalho de tese de doutorado, em termos de modelagem e simulação, gerando um artigo
(OLIVEIRA et al., 2014). Este artigo foi incluído no Apêndice A e o programa desenvolvido
para ele, VLE Regression, é apresentado no Apêndice C.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

40
3.3 Dados Experimentais Utilizados

Capítulo 3. METODOLOGIA

Para realização da modelagem e simulação, após a seleção dos sistemas a serem
estudados, ou seja: Água+MEG+NaCl e Água+MEG+KCl, escolheu-se os dados experi-
mentais utilizados nesta tese de doutorado a partir da Tabela 1 e da Tabela 2, apresentadas
na seção 2.2. Os critérios utilizados nesta seleção foram:

a) a limitação da faixa de temperatura para a faixa de 10 ℃ a 150 ℃;

b) a seleção de dados apenas dos sistemas escolhidos.
Os dados de solubilidade de sais em água, usados neste trabalho de tese de doutorado,
obtidos a partir da Tabela 1 pela limitação da faixa de temperatura, são apresentados na
Tabela 4.

Tabela 4 – Dados experimentais de solubilidade de sal em água a
diferentes temperaturas usados nesta tese de doutorado.

Sistema

Faixa de
Temperatura

Número de Pontos Referência
Experimentais

Água+KCl

Água+NaCl

de 10 a 100 ℃ 11
de 10 a 150 ℃ 16
de 10 a 100 ℃ 11
de 10 a 150 ℃ 15

Fonte: O autor.

Lide (2009)
Linke e Seidell (1965)
Lide (2009)
Linke e Seidell (1965)

Da mesma forma, os dados de solubilidade de sais em mistura de solventes (água e
MEG), usados nesta tese de doutorado, obtidos a partir da Tabela 2 pela limitação aos
sistemas escolhidos, são apresentados na Tabela 5.

Tabela 5 – Dados experimentais de solubilidade de sal em mistura de solventes

usados nesta tese de doutorado.

Sistema

Temperatura (K)

Número de Pontos Referência
Experimentais

Água+MEG+KCl

Água+MEG+NaCl

298,15 | 323,15 | 348,15
298,15
298,15
303,15
298,15
323,15
293,15 | 318,15 | 348,15
363,15 | 383,15 | 403,15
298,15
298,15
303,15
298,15

7 | 7 | 7
1
7
6
11
6
14 | 12 | 12
12 | 13 | 13
1
7
6
11

Chiavone-Filho e Rasmussen (1993)
Isbin e Kobe (1945)
Kraus, Raridon e Baldwin (1964)
Trimble (1931)
Zhou et al. (2010)
Baldwin, Raridon e Kraus (1969)
Figueiredo et al. (2014 (em Publicação))

Isbin e Kobe (1945)
Kraus, Raridon e Baldwin (1964)
Trimble (1931)
Zhou et al. (2010)

Fonte: O autor.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA
3.4 Sistema Internacional de Unidades

41

Neste trabalho de tese de doutorado, optou-se pela uniformização de todas as
equações e seus parâmetros para o Sistema Internacional de Unidades (SI) (BIPM, 2006).
Portanto, todas as grandezas presentes neste trabalho, cujas unidades não sejam declaradas
explicitamente, estão no SI.

3.5 Molalidade e Fração Molar
3.5.1 Cálculo da molalidade do sal na mistura de solventes

A molalidade do sal na mistura de solventes (b

) foi calculada em função
das propriedades dos dados experimentais consultados. Assim sendo, em função da fração
mássica de MX (wMX), tem-se:

{H2O+MEG}
MEG

{H2O+MEG}
MEG

b

= wMX/MMX
1 − wMX

(3.1)

onde MMX é a massa molar de MX. E, em função das massas respectivamente de MX
(mMX) e de água e MEG (mH2O+MEG), tem-se:

{H2O+MEG}
MEG

b

= mMX/MMX
mH2O+MEG

(3.2)

3.5.2 Cálculo da fração molar de MEG livre de sal na mistura de solventes

A fração molar de MEG livre de sal na mistura de solventes (x0

MEG) foi calculada
em função das propriedades dos dados experimentais consultados. Assim sendo, em função
das massas respectivamente do MEG (mMEG) e da água (mH2O), tem-se:

x0
MEG =

mMEG/MMEG

mH2O/MH2O + mMEG/MMEG

(3.3)

onde MMEG
função da fração mássica de água livre de sal na mistura de solventes (w0

1 e MH2O são as massas molares respectivamente do MEG e da água. E, em

H2O), tem-se:

(cid:16)1−w0

(cid:17)
(cid:16)1−w0

/MMEG

(cid:17)

x0
MEG =

H2O
w0
H2O/MH2O +

H2O

/MMEG

(3.4)

(3.5)

e, continuando, em função da fração mássica de MEG livre de sal na mistura de solventes
(w0

MEG), tem-se:

x0
MEG =

w0
MEG/MMEG
MEG)/MH2O + w0

(1−w0

MEG/MMEG

e, por último, em função das frações mássicas respectivamente de água (wH2O) e de MEG
(wMEG) tem-se:

x0
MEG =

wMEG/MMEG

(1−wMEG−wMX)/MH2O + wMEG/MMEG

(3.6)

1 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

42
3.6 Constantes Dielétricas
3.6.1 Cálculo das constantes dielétricas dos solventes puros

Capítulo 3. METODOLOGIA

As constantes dielétricas dos solventes puros (εr,H2O e εr,MEG) foram calculadas em

função da temperatura (T) pelas seguintes equações (ÅKERLÖF, 1932):

εr,H2O = 101,9051−0,00205(T−293,15)
εr,MEG = 101,5872−0,00224(T−293,15)

(3.7)
(3.8)

onde εr,H2O e εr,MEG são as constantes dielétricas respectivamente da água e do MEG.

3.6.2 Cálculo da constante dielétrica da mistura de solventes

A constante dielétrica da mistura água e MEG (εr,H2O+MEG) foi calculada em função
da temperatura (T), da fração molar de MEG livre de sal na mistura de solventes (x0
MEG)
e das constantes dielétricas dos solventes puros na mesma temperatura (εr,H2O e εr,MEG)
pela equação (JOUYBAN; SOLTANPOUR; CHAN, 2004):

(

εr,H2O+MEG = exp

MEG ln εr,MEG +

x0
H2O ln εr,H2O + x0
+ x0

h153, 6 + 57, 3(cid:16)

H2Ox0
T

MEG

H2O − x0
x0

MEG

(cid:17)i)

(3.9)

onde εr,H2O+MEG é a constante dielétrica da mistura água e MEG, e x0

H2O = 1 − x0

MEG.

3.7 Densidades Absolutas
3.7.1 Cálculo das densidades absolutas dos solventes puros

As densidades absolutas dos solventes puros (ρH2O e ρMEG) foram calculadas em

função da temperatura (T) pelas equações (GREEN; PERRY, 2007):

ρH2O =(cid:16)17863 + 58606τ

0,35 − 95396τ 2/3 + 213890τ − 141260τ 4/3(cid:17)

ρMEG =

sendo τ = 1 − T/647,096.

1315

0, 251251+(1−T/720)0,21868 MMEG

MH2O

(3.10)

(3.11)

3.7.2 Cálculo das densidades absolutas da mistura de solventes

A densidade absoluta da mistura água e MEG (ρH2O+MEG) foi calculada em função
das densidades dos solventes puros (ρH2O e ρMEG) e da fração molar de MEG livre de

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

43

sal na mistura de solventes (x0
(volume especíﬁco), pela equação:

MEG), assumindo regra de mistura ideal com o seu inverso

sendo x0

H2O = 1 − x0

MEG, w0

MEG =

e w0

H2O = 1 − w0

MEG.

ρH2O+MEG =

1

w0
H2O/ρH2O + w0
x0
MEGMMEG

MEG/ρMEG

x0H2OMH2O + x0MEGMMEG

(3.12)

3.8 Coeﬁciente de Atividade
3.8.1 Cálculo do coeﬁciente de atividade do sal pelo Modelo de Pitzer

O Modelo de Pitzer (PITZER, 1973) conforme apresentado na subseção 2.3.3 foi
empregado para o cálculo do coeﬁciente de atividade do sal (γMX). Sendo assim, este foi
calculado em função da molalidade do sal (bMX), da constante de Debye-Hückel na forma
(1)
para coeﬁciente osmótico (Aφ) e dos parâmetros do modelo (β
MX e C φMX), ou seja:

(0)
MX, β

2νM νX

2 2 (νM νX)3/2

ln γMX = |zM zX| f γMX + bMX
" 2
"

f γMX = −Aφ
(1)
MX + 2β
MX
α2I

BγMX = 2β

BγMX + bMX

ln(cid:16)1 + (cid:98)I 1/2(cid:17) + I 1/2
 
!
1 + (cid:98)I 1/2
2
1 + αI 1/2 − α
2

#
exp(cid:16)−αI 1/2(cid:17)#

(0)

ν

ν

I

C γMX

(cid:98)
1 −
MX = 3
2 C φ
C γ
I = |zM zX|
bMX
b0
ν = νM + νX

MX

2

ν

(3.13)

(3.14)

(3.15)

(3.16)

(3.17)
(3.18)

Neste trabalho de tese de doutorado, o Modelo de Pitzer foi estendido para misturas
água e MEG. Bastou para isso, que a molalidade do sal (bMX), a constante de Debye-Hückel
MX) fossem referentes a mistura água e
(Aφ) e os parâmetros do modelo (β
MEG, e não referentes somente a água (como no modelo original).

(1)
MX e C φ

(0)
MX, β

3.8.2 Cálculo do coeﬁciente de atividade do sal em MEG

O coeﬁciente de atividade do sal em MEG (γ

{H2O}
MX ) e em MEG (b

temperatura (T), do coeﬁciente de atividade do sal em água (γ
{MEG}
do sal em água (b
MX
0
transferência da água para o MEG (∆trG
H2O→MEG
{H2O}
MX
{MEG}
MX

 − ∆trG

{H2O}
MX + ln

 b

{MEG}
MX

= ln γ

ln γ

b

{MEG}
MX

) foi calculado em função da
{H2O}
MX ) e das molalidades
), utilizando-se a energia livre de Gibbs de

2), pela equação (LORIMER, 1993):

0
H2O→MEG
νRT

(3.19)

2 Para valores de constantes, consulte a Tabela 6 da seção 3.11.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

44

Capítulo 3. METODOLOGIA

3.8.3 Constante de Debye-Hückel
3.8.3.1 Cálculo da constante de Debye-Hückel para a água

A constante de Debye-Hückel da água na forma para coeﬁciente osmótico (Aφ,H2O)

foi calculada em função da temperatura (T) pela equação (CHEN et al., 1982): 3.20

!

  T − 273, 15
Aφ,H2O = −61, 44534 exp
  T
+ 0, 0007875695(cid:16)

!
2 − 273, 152(cid:17) + 58, 95788

+ 183, 5379 ln

273, 15

273, 15

− 0, 6820223 (T − 273, 15) +
(cid:18)273, 15
(cid:19)

+ 2, 864468 exp

"

2

T

T

 T − 273, 15

!#

273, 15

+

(3.20)

3.8.3.2 Cálculo da constante de Debye-Hückel para o MEG

A constante de Debye-Hückel do MEG na forma para coeﬁciente osmótico (Aφ,MEG)
foi calculada em função das constante de Debye-Hückel da água na forma para coeﬁciente
osmótico (Aφ,H2O), densidade absoluta (ρH2O) e constante dielétrica (εr,H2O) da água, e
das densidade absoluta (ρMEG) e constante dielétrica (εr,MEG) do MEG, tudo a mesma
temperatura (T), pela Equação 3.21. Esta foi obtida a partir da razão entre a Equação 2.21
aplicada, primeiro, com ρsolv = ρH2O e, depois, com ρsolv = ρMEG, e da Equação 2.44.

  ρMEG

!1/2  εr,H2O

!3/2

ρH2O

εr,MEG

Aφ,MEG =

Aφ,H2O

(3.21)

3.8.3.3 Cálculo da constante de Debye-Hückel para a mistura de solventes

A constante de Debye-Hückel da mistura água e MEG na forma para coeﬁciente
osmótico (Aφ,H2O+MEG) foi calculada em função das constante de Debye-Hückel da água na
forma para coeﬁciente osmótico (Aφ,H2O), densidade absoluta (ρH2O) e constante dielétrica
(εr,H2O) da água, e das densidade absoluta (ρH2O+MEG) e constante dielétrica (εr,H2O+MEG)
da mistura água e MEG, tudo calculado a mesma temperatura (T), pela Equação 3.22.
Esta foi obtida a partir da razão entre a Equação 2.21 aplicada, primeiro, com ρsolv = ρH2O
e, depois, com ρsolv = ρH2O+MEG, e da Equação 2.44.

 ρH2O+MEG

!1/2  εr,H2O

!3/2

ρH2O

εr,H2O+MEG

Aφ,H2O+MEG =

Aφ,H2O

(3.22)

3.8.4 Parâmetros do Modelo de Pitzer em água
3.8.4.1 Cálculo dos parâmetros do Modelo de Pitzer para o NaCl em água

Os parâmetros do modelo para o NaCl em água (β

e C φ{H2O}
),
foram calculados em função da temperatura (T), pelas equações (SILVESTER; PITZER,

(0){H2O}
NaCl

(1){H2O}
NaCl

, β

NaCl

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

1977):

(0){H2O}
NaCl

β

  1

!

= 0, 0765 − 777, 03

+ 0, 008946 (T − 298, 15) − 0, 0000033158(cid:16)

298, 15

− 4, 4706 ln

T

T

− 1

!
  T
2 − 298, 152(cid:17)

298, 15

(1){H2O}
NaCl

β

= 0, 2664 + 0, 000061608 (T − 298, 15) +

2 − 298, 152(cid:17)
!

− 1

298, 15

+

T

+ 0, 0000010715(cid:16)
  1
!

  T

T

298, 15

C φ{H2O}
NaCl = 0, 00127 + 33, 317

+

45

(3.23)

(3.24)

+ 0, 09421 ln

− 0, 00004655 (T − 298, 15)

(3.25)

(1){H2O}
NaCl

e β

são parâmetros do Modelo de Pitzer para o NaCl em água, e
é o terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para o

(0){H2O}
NaCl

onde β
C φ{H2O}
NaCl
NaCl em água.

3.8.4.2 Cálculo dos parâmetros do Modelo de Pitzer para o KCl em água

Os parâmetros do modelo para o KCl em água (β

KCl
foram calculados em função da temperatura (T), pelas equações (ARCHER, 1999):

, β

(0){H2O}
KCl

(1){H2O}
KCl

e C φ{H2O}

),

(0){H2O}
KCl

β

= 0, 413229483398493 − 0, 000870121476114027 (T − 298, 15) +
+ 0, 00000101413736179231 (T − 298, 15)2 +
− 99, 8120581680816
− 1, 99822538522801

T − 225

T

(1){H2O}
KCl

β

= 0, 206691413598171 + 0, 00102544606022162 (T − 298, 15) +
− 1883, 49608000903

(T − 225)3

C φ{H2O}
KCl

= −0, 00133515934994478 + 0, 234117693834228
= 0, 75896583546707

T − 225

T

+

(3.26)

(3.27)

(3.28)

e β

(0){H2O}
são parâmetros do Modelo de Pitzer para o KCl em água, e
KCl
é o terceiro coeﬁciente do virial na forma para coeﬁciente de atividade para o KCl

(1){H2O}
KCl

onde β
C φ{H2O}
KCl
em água.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

46

Capítulo 3. METODOLOGIA

3.8.5 Parâmetros do Modelo de Pitzer em MEG e em mistura de solventes
A metodologia usada por Lorimer (1993), em relação a misturas água e MEG,
(0)
MX e C φMX são constantes, e que o parâmetro
considera que os parâmetros do modelo β
(1)
do modelo β
MX apresenta dependência linear, em escala logarítmica, com a constante
dielétrica. Com estas considerações, pode-se estender o Modelo de Pitzer para misturas
água e MEG, permitindo o cálculo dos parâmetros do modelo para estas misturas.

3.8.5.1 Cálculo dos parâmetros do Modelo de Pitzer em MEG

Os parâmetros do modelo em MEG, β

MX
função dos parâmetros do modelo em água, respectivamente β

e C φ{MEG}
(0){H2O}
MX

(0){MEG}
MX

e C φ{H2O}

MX

, foram calculados em

β

(0){MEG}
MX
C φ{MEG}
MX

(0){H2O}
= β
MX
= C φ{H2O}

MX

, por:

(3.29)
(3.30)

(1){MEG}
MX

O parâmetro do modelo em MEG, β

foi calculado resolvendo-se, para este
parâmetro, a equação do Modelo de Pitzer estendido para o MEG. Ou seja, usando,
{MEG}
neste modelo: o valor de ln γ
, obtido da Equação 3.19, o valor de Aφ,MEG, obtido da
MX
(0){MEG}
Equação 3.21, e os valores de β
, obtidos respectivamente da Equação 3.29
MX
e as constantes do sal e do modelo (zM, zX, ν,
e da Equação 3.30, além do valor de b
α e (cid:98)), resulta em β
como única incógnita. Logo, resolve-se a equação resultante
para β

e C φ{MEG}
MX
{MEG}
MX

(1){MEG}
MX

(1){MEG}
MX

.

3.8.5.2 Cálculo dos parâmetros do Modelo de Pitzer em mistura de solventes

Os parâmetros do modelo na mistura água e MEG, β

(0){H2O+MEG}
MX

foram calculados em função dos parâmetros do modelo em água, respectivamente β
e C φ{H2O}

, por:

MX

MX

e C φ{H2O+MEG}
,
(0){H2O}
MX

β

(0){H2O+MEG}
MX
C φ{H2O+MEG}
MX

(0){H2O}
= β
MX
= C φ{H2O}

MX

(3.31)
(3.32)

O parâmetro do modelo na mistura água e MEG, β

(1){H2O+MEG}
MX

em função dos parâmetros do modelo em água e em MEG (respectivamente β
(1){MEG}
) e das constantes dielétricas dos solventes puros (εr,H2O e εr,MEG), por:
β
MX

, foi calculado
e

(1){H2O}
MX

(1){H2O+MEG}
MX

β

= β0 exp ((cid:65)ln εr,solvente + (cid:66))

ln(cid:16)

(cid:65) =

(cid:17)

β

/β

(1){H2O}
(1){MEG}
MX
MX
ln (εr,H2O/εr,MEG)
(1){H2O}
MX

− (cid:65)ln εr,H2O

β0

(cid:66) = ln β

onde β0 = 1.

(3.33)

(3.34)

(3.35)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

47
Capítulo 3. METODOLOGIA
3.9 Equações para Ajuste por Regressão de Dados Experimentais
3.9.1 Molalidade do sal em solvente simples como função da temperatura

Adaptou-se a Equação de Clarke-Glew (CLARKE; GLEW, 1966) para a molalidade,

obtendo-se:

bMX
b0

= exp

Θ−2 ln T

T0

+ X

i=−1

Θi

(cid:19)i

(cid:18) T0

T

(3.36)

onde os Θ−2 e Θi são parâmetros ajustáveis da equação, e T0 = 1 K é a temperatura
unitária.

3.9.2 Potencial químico padrão de excesso do sal em mistura de solventes

como função da fração molar do MEG livre de sal e da temperatura

Adaptou-se a equação proposta por Lorimer (1993) generalizando-a, e tornando os

seus parâmetros dependentes polinomialmente da temperatura, obtendo-se:

h

0{H2O+MEG}
MX

µ

iE

= x0

MEG (1 − x0

Θi,j

MEG

i

(3.37)

MEG)X

X

j=0

(cid:19)j x0

(cid:18) T

T0

i=0
onde os Θi,j são parâmetros ajustáveis da equação.

νRT

3.10 Propriedades de Excesso Apresentadas em Lorimer (1993)

No cálculo das propriedades de excesso apresentadas em Lorimer (1993) foi neces-
sário, primeiramente, calcular as respectivas propriedades ideais. Estas, foram calculadas
utilizando-se regra de mistura ideal, em solventes simples, com a fração molar de MEG
livre de sal, ou seja:

{H2O+MEG}
MX
{H2O+MEG}
MX

= (1 − x0
= (1 − x0

MEG) ln b
MEG) ln γ

{H2O}
MX + x0
{H2O}
MX + x0

MEG ln b
MEG ln γ

{MEG}
MX
{MEG}
MX

(3.38)
(3.39)

hln b
hln γ

hln b
hln γ

iid
iid

iE
iE

Em seguida, as propriedades de excesso para a molalidade e o coeﬁciente de atividade
foram calculadas, a saber:

{H2O+MEG}
MX
{H2O+MEG}
MX

= ln b
= ln γ

{H2O+MEG}
MX
{H2O+MEG}
MX

−hln b
−hln γ

{H2O+MEG}
MX
{H2O+MEG}
MX

iid
iid

(3.40)
(3.41)

E, ﬁnalmente, com a Equação 3.40 e a Equação 3.41, a propriedade de excesso para o
potencial químico padrão foi obtida:

h

µ

0{H2O+MEG}
MX

νRT

iE

= −hln b

iE −hln γ

iE

{H2O+MEG}
MX

{H2O+MEG}
MX

(3.42)

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

48
3.11 Constantes Físico-Químicas e Parâmetros Utilizados

Capítulo 3. METODOLOGIA

A Tabela 6 apresenta os valores de diversas constantes utilizadas neste trabalho de

tese de doutorado, suas unidades e a referência de onde foram coletadas.

Tabela 6 – Valores de constantes utilizados nesta tese de doutorado.
Constante

Referência

Valor
2, 0 kg1/2mol1/2
1, 2 kg1/2mol1/2
1 mol · kg
7000 J · mol−1
1, 602176487 × 10−19 C
8, 854187817 × 10−12 F · m−1
1, 3806504 × 10−23 J · K−1
0, 018015 kg · mol−1
0, 0745550 kg · mol−1
0, 062068 kg · mol−1
0, 0584428 kg · mol−1
6, 02214179 × 1023 mol−1
8, 314472 J · K−1mol−1

H2O→MEG

α
(cid:98)
b0
∆trG0
e0
ε0
kB
MH2O
MKCl
MMEG
MNaCl
NA
R
Fonte: O autor.

Pitzer (1973)
Pitzer (1973)
Prausnitz, Lichtenthaler e Azevedo (1999, 511)
Marcus (1985)
Lide (2009)
Lide (2009)
Lide (2009)
Lide (2009)
Lide (2009)
Lide (2009)
Lide (2009)
Lide (2009)
Lide (2009)

3.12 Algoritmos

Nesta seção, várias sub-rotinas são apresentadas, na forma de ﬂuxograma, junta-
mente com um breve resumo que esclarece o seu funcionamento. Em seguida, mostra-se
como foram utilizadas a Equação 3.36 (subseção 3.12.5) e a Equação 3.37 (subseção 3.12.6)
nos ajustes, por regressão de dados de equilíbrio, para um sal (NaCl ou KCl) e, respec-
tivamente com solvente simples em função da temperatura, e com mistura água e MEG
em função da temperatura e da composição de MEG livre de sal. Finalmente, com estas
equações e as sub-rotinas, mostra-se como calcular propriedades de misturas água e MEG,
inclusive de excesso, em função da temperatura e da composição de MEG livre de sal
(subseção 3.12.7).

Nestas sub-rotinas usou-se os valores presentes na Tabela 6, bem como os valores:

zM = zX = νM = νX = 1

ν = νM + νX = 2

(3.43)
(3.44)

para as cargas dos íons (zM e zX), para os coeﬁcientes estequiométricos dos íons (νM e νX)
e para a sua soma (ν). Estes últimos valores, devem-se ao fato deste trabalho de tese de
doutorado abordar apenas os sais monovalentes: NaCl e KCl.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

3.12.1 Sub-rotina Pitzer

Esta sub-rotina (Figura 21) imple-
mentou o Modelo de Pitzer. O valor do lo-
garitmo do coeﬁciente de atividade de MX
(ln γMX) foi calculado em função da molali-
dade de MX (bMX), da constante de Debye-
Hückel na forma para coeﬁciente osmótico
(Aφ) e dos parâmetros do Modelo de Pitzer
(1)
(β
MX e C φMX). Usou-se, esta sub-rotina,
tanto para água, quanto para MEG ou mis-
turas água e MEG.

(0)
MX, β

3.12.2 Sub-rotina beta1_MEG

49

Figura 21 – Fluxograma da sub-rotina

Pitzer.

Sub-rotina Pitzer

bMX, Aφ, β
MX,
(0)
MX, C φ
(1)
MX

β

MX (Equação 3.14)
f γ
MX (Equação 3.15)
Bγ
MX (Equação 3.16)
C γ

I (Equação 3.17)

ln γMX (Equação 3.13)

Retorna ln γMX

Fonte: O autor.

Esta sub-rotina (Figura 22) foi utilizada para calcular-se o parâmetro β

(1){MEG}
MX
do Modelo de Pitzer em MEG. Este foi calculado em função da molalidade de MX em
), da constante de Debye-Hückel do MEG na forma para coeﬁciente osmótico
MEG (b
do Modelo de Pitzer em MEG. Um valor
(Aφ,MEG) e dos parâmetros β
(1){MEG}
inicial (estimativa) para β
MX

) também precisou ser fornecido.

e C φ{MEG}
(1){MEG}∗
MX

(0){MEG}
MX
(β

{MEG}
MX

MX

Figura 22 – Fluxograma da subrotina beta1_MEG.

Sub-rotina beta1_MEG

{MEG}
ln γ
MX
(0){MEG}
, β
MX

{MEG}
MX

, b
(1){MEG}∗
MX

, Aφ,MEG,
, C φ{MEG}

MX

β

SUBROTINA: Pitzer
{MEG}
, Aφ,MEG,
Entra: b
MX
(1){MEG}∗
(0){MEG}
, β
β
MX
MX
Retorna: ln γ

{MEG}∗
MX

, C φ{MEG}

MX

ln γ

{MEG}
MX

= ln γ

{MEG}∗
MX

?

Não

Corrige β

(1){MEG}∗
MX

Sim

Retorna β

(1){MEG}∗
MX

Fonte: O autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

50

3.12.3 Sub-rotina prop_mix

Capítulo 3. METODOLOGIA

Esta sub-rotina (Figura 23) foi utilizada para calcular-se propriedades de mistura.
Este cálculo foi realizado em função da molalidade de MX na mistura água e MEG
{H2O+MEG}
(b
MEG) e da temperatura (T). A
MX
propriedade de mistura foi escolhida, por meio da variável f lag, da seguinte forma:

), da fração molar de MEG livre de sal (x0

Tabela 7 – Valores de f lag na sub-rotina prop_mix.
Função retornada

Valor de f lag

1
2
3

qualquer outro valor

Fonte: O autor.

Figura 23 – Fluxograma da subrotina prop_mix.

iE
iE

ln γ

hln b
hln γ
(cid:2)µ

{H2O+MEG}
MX
{H2O+MEG}
MX
{H2O+MEG}
MX

(cid:3)E

0{H2O+MEG}
MX

νRT

SUBROTINA: beta1_MEG
{MEG}
Entra: ln γ
, b
MX
(1){H2O}
(0){MEG}
, β
β
MX
MX
(1){MEG}
Retorna: β
MX

{MEG}
MX
, C φ{MEG}

MX

, Aφ,MEG,

ρH2O+MEG (Equação 3.12)
εr,H2O+MEG (Equação 3.9)

Aφ,H2O+MEG (Equação 3.22)
(0){H2O+MEG}
(Equação 3.31)
β
MX
(1){H2O+MEG}
(Equação 3.33)
β
MX
C φ{H2O+MEG}
(Equação 3.32)
MX

{H2O+MEG}
MX

SUBROTINA: Pitzer
Entra: b
(0){H2O+MEG}
β
MX
C φ{H2O+MEG}
MX
Retorna: ln γ

, β

{H2O+MEG}
MX

, Aφ,H2O+MEG,

(1){H2O+MEG}
MX

,

f lag = 1?

Não

Sim

Retorna ln γ

{H2O+MEG}
MX

Subrotina prop_mix

{H2O+MEG}
,
b
MX
x0
MEG, T, f lag

{H2O}
(Equação 3.36)
b
MX
Aφ,H2O (Equação 3.20)
(Equação 3.23 ou Equação 3.26)
(Equação 3.24 ou Equação 3.27)
(Equação 3.25 ou Equação 3.28)

β

(0){H2O}
MX
(1){H2O}
β
MX
C φ{H2O}
MX

SUBROTINA: Pitzer
Entra: b
(1){H2O}
β
MX
MX
Retorna: ln γ

{H2O}
MX , Aφ,H2O, β
, C φ{H2O}
{H2O}
MX

(0){H2O}
MX

,

{MEG}
b
MX

(Equação 3.36)

ln γ

{MEG}
MX

(Equação 3.19)

ρH2O (Equação 3.10)
ρMEG (Equação 3.11
εr,H2O (Equação 3.7)
εr,MEG (Equação 3.8)

Aφ,MEG (Equação 3.21)
(0){MEG}
(Equação 3.29)
β
MX
C φ{MEG}
(Equação 3.30)
MX

Fonte: O autor.

hln b
hln γ
hln b
hln γ

{H2O+MEG}
MX
{H2O+MEG}
MX

{H2O+MEG}
MX
{H2O+MEG}
MX

iid (Equação 3.38)
iid (Equação 3.39)
iE (Equação 3.40)
iE (Equação 3.41)

Não

f lag = 2?

Sim

Retornahln b

{H2O+MEG}
MX

iE

f lag = 3?

Sim

{H2O+MEG}
MX

Não

iE

Retornahln γ
(cid:2)µ
(cid:3)E
(cid:2)µ

0{H2O+MEG}
MX

Retorna

νRT

(Equação 3.42)

(cid:3)E

0{H2O+MEG}
MX

νRT

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

51

corresponde ao valor do parâmetro em água (β

Observa-se que, na chamada a sub-rotina beta1_MEG, o valor inicial (estima-
(1){MEG}∗
tiva) β
). Os valores das
MX
molalidades de MX em solvente simples (b
) foram obtidos em função da
temperatura (T) com os parâmetros (Θi) da equação de ajuste por regressão de dados
experimentais (Equação 3.36).

(1){H2O}
MX

{M EG}
MX

{H2O}
MX

e b

3.12.4 Sub-rotina b_mix

Esta sub-rotina (Figura 24) foi utilizada para calcular-se a molalidade de MX na
) em função do potencial químico padrão de excesso de
0{H2O+MEG}
/νRT), da fração molar de MEG livre de sal
MX
{H2O+MEG}∗
)
MX

MEG) e da temperatura (T). Um valor inicial (estimativa) para b

mistura água e MEG (b
MX na mistura água e MEG (
(x0
também precisou ser fornecido.

{H2O+MEG}
MX

{H2O+MEG}
MX

iE

h

(b

µ

Figura 24 – Fluxograma da subrotina b_mix.

Subrotina b_mix

(cid:2)µ

0{H2O+MEG}
MX

(cid:3)E

νRT

, b

{H2O+MEG}∗
MX

, x0

MEG, T

SUBROTINA: prop_mix
Entra: b

{H2O+MEG}∗
MX

, x0
0{H2O+MEG}
MX

(cid:3)E

(cid:2)µ

Retorna:

MEG, T, 3

∗

νRT

(cid:2)µ

0{H2O+MEG}
MX

νRT

(cid:3)E

=

(cid:2)µ

0{H2O+MEG}
MX

νRT

(cid:3)E

∗

?

Não

Corrige b

{H2O+MEG}∗
MX

Sim

Retorna b

{H2O+MEG}∗
MX

Fonte: O autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

52

Capítulo 3. METODOLOGIA

3.12.5 Cálculo da molalidade do sal em solvente simples como função da

temperatura

Através dos dados experimentais coletados da literatura (Tabela 4 e Tabela 5),
selecionou-se os que referiam-se a solubilidade de um sal (NaCl ou KCl) em solvente simples
a diferentes temperaturas. Em seguida, quando necessário, os dados foram convertidos para
molalidade. Finalmente, usou-se a Equação 3.36 para, por meio de ajuste por regressão,
obter-se os melhores valores para os parâmetros Θi. A equação especíﬁca resultante, para
cada sal, que representava o conjunto experimental de forma satisfatória, foi selecionada
desprezando-se parâmetros considerados irrelevantes. As equações especíﬁcas, para cada
sal e solvente, encontram-se no Capítulo 4.

3.12.6 Cálculo do potencial padrão de excesso do sal na mistura de solventes

{H2O+MEG}
MX

), fração molar de MEG livre de sal na mistura água e MEG (x0

Através dos dados experimentais coletados da literatura (Tabela 4 e Tabela 5),
selecionou-se os que referiam-se a um sal (NaCl ou KCl) a diferentes frações de MEG na
mistura de solvente e, também, a diferentes temperaturas e concentrações. Em seguida,
quando necessário, os dados foram normalizados para molalidade de sal na mistura água e
MEG (b
MEG) e
temperatura (T). Prosseguindo, estes dados, juntamente com as equações especíﬁcas para
cada sal e solvente simples (obtidas conforme descrito na subseção 3.12.5) foram submetidos
a sub-rotina prop_mix (Figura 23), com o valor para a variável de controle: f lag = 0. Desta
forma, obteve-se valores de potencial padrão de excesso do sal na mistura água e MEG
(
MEG e T. Finalmente, usou-se a Equação 3.37 nestes
resultados para, por meio de ajuste por regressão, obter-se os melhores valores para os
parâmetros Θi,j. A equação especíﬁca resultante, para cada sal, que representava o conjunto
experimental de forma satisfatória, foi selecionada desprezando-se parâmetros considerados
irrelevantes. As equações especíﬁcas, para cada sal, encontram-se no Capítulo 4.

iE
/νRT), a diferentes x0

0{H2O+MEG}
MX

h

µ

3.12.7 Cálculo das propriedades de mistura

A partir das sub-rotinas apresentadas nesta seção e das equações especíﬁcas, geradas
por meio da regressão dos dados experimentais, cujos parâmetros foram selecionados
e calculados conforme descrito na subseção 3.12.5 e na subseção 3.12.6, obteve-se as
propriedades de mistura em função da fração molar de MEG livre de sal na mistura água e
MEG (x0
MEG) e da temperatura (T). Para isso, primeiramente, calculou-se a molalidade de
MX na mistura água e MEG (b
), usando a sub-rotina b_mix, com o valor para
/νRT) obtido
o potencial químico padrão de excesso na mistura água e MEG (
pela equação de regressão especíﬁca e, também, com os valores de x0
MEG e T. Finalmente,
utilizando estes resultados na sub-rotina prop_mix (Figura 23), com valores para a variável

{H2O+MEG}
MX

0{H2O+MEG}
MX

iE

h

µ

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

53

de controle (f lag) conforme a Tabela 7, obteve-se a propriedade de mistura especiﬁcada.

3.13 Programa JAFOSSMS

Por meio dos algoritmos apresentados na seção 3.12, foi implementado em Python
(python.org), utilizando-se o IDE Eclipse (eclipse.org) para depuração e desenvolvimento,
o programa denominado: JAFOSSMS - Solubilidade de Sais em Mistura de Solventes.
Este aplicativo possui uma interface gráﬁca, de comunicação com o usuário, desenvolvida
em PySide (qt-project.org), bem como utiliza as bibliotecas NumPy (numpy.org) e SciPy
(scipy.org) para cálculos numéricos e cientíﬁcos e, a biblioteca matplotlib (matplotlib.org)
para gerar gráﬁcos.

O sistema operacional adotado para programação foi o Ubuntu® (ubuntu.com),
pelas facilidades próprias deste sistema. No entanto, o programa é totalmente portável
em Windows® (windows.microsoft.com) e, também, em Mac OS X® (apple.com). Os
requisitos para a execução deste programa, em diferentes sistemas operacionais, encontram-
se descritos no Apêndice B. A seguir, apresenta-se o passo a passo de como utilizar o
programa JAFOSSMS.

Para utilizar-se o programa JAFOSSMS, primeiramente escolhe-se o arquivo prin-
cipal (subseção D.6.1), referente ao sistema a ser estudado, por meio do botão "Procurar"
(Figura 25) ou caixa de texto "Arquivo com Dados de Entrada". Em seguida, executa-se os
cálculos de regressão por meio do botão "Executar".

Figura 25 – Programa JAFOSSMS : Seleção do sistema a ser estudado.

Fonte: o autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

54

Capítulo 3. METODOLOGIA

Terminado os cálculos, o programa retorna para o usuário um relatório, na aba
"RELATÓRIO GERAL", de tudo que foi calculado e utilizado nos cálculos, inclusive toda
a parte estatística (Figura 26). Este relatório pode ser copiado ou salvo.

Figura 26 – Programa JAFOSSMS : Relatório gerado.

Fonte: o autor.

O programa oferece, por meio da aba "SOLVENTE SIMPLES", botões de opções e

caixas de seleção com opções para poder-se gerar um gráﬁco binário (Figura 27).

Figura 27 – programa JAFOSSMS: Opções para geração de gráﬁco binário.

Fonte: o autor.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

55

O programa oferece, por meio da aba "MISTURA DE SOLVENTES", botões de
opções e caixas de seleção com opções para poder-se gerar um gráﬁco ternário (Figura 28).

Figura 28 – Programa JAFOSSMS : Opções para geração de gráﬁco ternário.

Fonte: o autor.

Dentre estes objetos gráﬁcos, destacam-se as caixas de seleção, para escolher o modo
(regressão ou predição), e o botão para escolha de isotermas. A escolha de isotermas
realiza-se numa nova janela (Figura 29).

Figura 29 – Programa JAFOSSMS : Seleção das isotermas para geração de

gráﬁco ternário.

Fonte: o autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

56

Capítulo 3. METODOLOGIA

Por último, de acordo com a seleção, clicando no botão correspondente ao gráﬁco
desejado, obtém-se este, na aba "GRÁFICO E ESTATÍSTICAS", juntamente com um
pequeno resumo estatístico.

A Figura 30 ilustrada um gráﬁco binário.

Figura 30 – Programa JAFOSSMS : Gráﬁco binário.

Fonte: o autor.

A Figura 31 ilustrada um gráﬁco ternário.

Figura 31 – Programa JAFOSSMS : Gráﬁco ternário.

Fonte: o autor.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 3. METODOLOGIA

57

Na aba "GRÁFICO E ESTATÍSTICAS", apresenta-se o gráﬁco em uma interface
que permite executar personalizações, como por exemplo: ampliar regiões no gráﬁco, mudar
a posição e tamanho da legenda, mudar o tamanho dos rótulos nos eixos, e também, salvar
o gráﬁco. Além destas personalizações para o gráﬁco, pode-se copiar ou salvar o resumo
estatístico.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

CAPÍTULO 4

RESULTADOS E DISCUSSÕES

4 RESULTADOS E DISCUSSÕES

61

Neste capítulo, inicialmente apresenta-se cada resultado gerado pelo programa
JAFOSSMS (seção 3.13), juntamente com uma discussão que esclarece o que ocorreu.
Por último, apresenta-se a validação do Modelo de Pitzer implementado e, também, a
comparação do Modelo JAFOSSMS com outros modelos.

Foi escolhida uma sequência para a apresentação dos resultados e discussões.
Primeiramente, dividiu-se os sistemas estudados (Tabela 4 e Tabela 5) pelo sal. Ou seja,
primeiro os sistemas com NaCl e, em seguida, os com KCl. Para cada sal, foi feita a divisão
em sistemas com solvente simples e com mistura água e MEG. Para o caso dos sistemas
com solvente simples, primeiro apresenta-se os sistemas com água e, em seguida, os com o
MEG. Para o caso de sistemas com mistura de solventes, primeiro apresenta-se o potencial
químico padrão de excesso, prossegue-se com a molalidade, o logaritmo de excesso da
molalidade, o coeﬁciente de atividade e, ﬁnalmente, o logaritmo de excesso do coeﬁciente
de atividade. Para cada caso, nos sistemas com mistura de solventes, primeiro apresenta-se
o resultado cujos pontos experimentais foram utilizados no procedimento de ajuste por
regressão do potencial químico padrão de excesso, seguido por outro resultado, cujos
pontos experimentais não foram utilizados neste procedimento. O primeiro é chamado de
modo de Cálculo Normal / Regressão e o outro de modo de Predição.

4.1 Sistemas com NaCl
4.1.1 Sistemas com solvente simples
4.1.1.1 Sistema H2O+NaCl

Dados de solubilidade de NaCl em água, selecionados dos sistemas estudados
(Tabela 4 e Tabela 5), foram ajustados por regressão não linear, conforme descrito na
subseção 3.12.5, utilizando-se a Equação 3.36. Resultando, após desprezar-se b0 e outras
simpliﬁcações, na equação:

{H2O}
NaCl = exp (θ0 + θ1T + θ2 ln T)

b

(4.1)

onde θ0 = Θ0, θ1 = Θ1 e θ2 = Θ−2.

A análise estatística do ajuste por regressão não linear foi realizada com um nível

da signiﬁcância (α) de 5,0%, obtendo-se:

a) desvio padrão assintótico: s = 0, 020406 mol · kg−1;
b) coeﬁciente de determinação: R

2 = 0,99294;

Capítulo 4. RESULTADOS E DISCUSSÕES

c) coeﬁciente de determinação ajustado: R
A Tabela 8 apresenta a análise de variância (ANOVA) do ajuste por regressão não

2
ajustado = 0,99244.

62

linear.

Tabela 8 – ANOVA (Sistema H2O+NaCl).

Fonte

Regressão
Resíduo
Total

Total Corrigido

Fonte: O autor.

GL Soma de Quadrados Quadrado Médio
3
28
31
30

1252,9
0,011660
1252,9
1,6519

417,62

0,00041642

F-valor
1002900,0

Pr(>F)
0,00000

A Tabela 9 apresenta os parâmetros obtidos, do ajuste por regressão não linear,
para a Equação 4.1, juntamente com seus intervalos de conﬁança. O valor, para este caso,
do t de Student crítico foi: t-crítico = 2,0484.

Tabela 9 – Parâmetros obtidos (Sistema H2O+NaCl).

Parâmetro Estimativa Erro Padrão
Assintótico

t-valor Pr(>|t|)

θ0
θ1
θ2

5,1695

0,0033193
-0,76200

0,5809

0,0003601
0,12075

8,8990
9,2172
-6,3106

0,00000
0,00000
0,00000

Fonte: O autor.

Intervalo de Conﬁança

Assintótico 95,0%
Superior
Inferior
3,9795
6,3594

0,0025816
-1,00935

0,0040569
-0,51466

A Tabela 10 apresenta a matriz de correlação dos parâmetros obtidos, do ajuste

por regressão não linear, para a Equação 4.1.

Tabela 10 – Matriz de Correlação (Sis-

tema H2O+NaCl).

Parâmetro

θ0
θ1
θ2

θ0

1,00000
0,99846
-0,99995

θ1

0,99846
1,00000
-0,99894

θ2

-0,99995
-0,99894
1,00000

Fonte: O autor.

Algumas outras medidas estatísticas básicas, também foram calculadas:
a) desvio absoluto médio = 0, 01451 mol · kg−1;
b) desvio absoluto máximo = 0, 06464 mol · kg−1;
c) desvio relativo absoluto médio = 0,23%;
d) desvio relativo absoluto máximo = 0,96%.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

63

O ajuste foi bastante satisfatório, o que é evidenciado pelo valor R

2 = 0, 99294
para o coeﬁciente de determinação, pela ANOVA (Tabela 8) com Pr(>F) = 0,00000 e
pelo desvio relativo absoluto médio = 0,23%. Todos os parâmetros obtidos (Tabela 9)
contribuem signiﬁcativamente para o modelo, pois, possuem baixos valores de Pr(>|t|).
Estes, também, apresentam signiﬁcante correlação entre si, conforme evidenciado pelos
altos valores absolutos na matriz de correlação (Tabela 10).

Observa-se, na Figura 32, que a molalidade do NaCl aumenta com a temperatura,
de forma ligeiramente acima da linear, em toda a faixa de temperatura correlacionada. Os
dados experimentais, de todos os autores, dispuseram-se em torno da curva, conﬁrmando
um bom ajuste.

Figura 32 – Molalidade do NaCl em H2O em função da Temperatura.

Fonte: O autor.

4.1.1.2 Sistema MEG+NaCl

Dados de solubilidade de NaCl em MEG, selecionados dos sistemas estudados
(Tabela 4 e Tabela 5), foram ajustados por regressão não linear, conforme descrito na
subseção 3.12.5, utilizando-se a Equação 3.36. Resultando, após desprezar-se b0 e outras
simpliﬁcações, na equação:

onde θ0 = Θ0 e θ1 = Θ1.

b

{MEG}
NaCl = exp (θ0 + θ1T)

(4.2)

A análise estatística do ajuste por regressão não linear foi realizada com um nível

da signiﬁcância (α) de 5,0%, obtendo-se:

a) desvio padrão assintótico: s = 0, 010445 mol · kg−1;
b) coeﬁciente de determinação: R
c) coeﬁciente de determinação ajustado: R

2 = 0,93533;

2
ajustado = 0,92455.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

64

Capítulo 4. RESULTADOS E DISCUSSÕES

A Tabela 11 apresenta a ANOVA do ajuste por regressão não linear.

Tabela 11 – ANOVA (Sistema MEG+NaCl).

Fonte

Regressão
Resíduo
Total

Total Corrigido

Fonte: O autor.

GL Soma de Quadrados Quadrado Médio F-valor Pr(>F)
2
0,00002
6
8
7

11,365
0,010122

0,00010910

11,364

0,00065462

5,682

52079,0

A Tabela 12 apresenta os parâmetros obtidos, do ajuste por regressão não linear,
para a Equação 4.2, juntamente com seus intervalos de conﬁança. O valor, para este caso,
do t de Student crítico foi: t-crítico = 2,4469.

Tabela 12 – Parâmetros obtidos (Sistema MEG+NaCl).

Parâmetro

Estimativa

Erro Padrão
Assintótico

t-valor

Pr(>|t|)

θ0
θ1

0,41306

-0,00072237

0,02593

0,00007854

15,9327
-9,1973

0,00000
0,00009

Fonte: O autor.

Intervalo de Conﬁança

Assintótico 95,0%

Inferior
0,34963

-0,00091455

Superior
0,47650

-0,00053019

A Tabela 13 apresenta a matriz de correlação dos parâmetros obtidos, do ajuste

por regressão não linear, para a Equação 4.2.

Tabela 13 – Matriz de Correlação (Sis-

tema MEG+NaCl).

Parâmetro

θ0
θ1

θ0

θ1

1,00000
-0,99283

-0,99283
1,00000

Fonte: O autor.

Algumas outras medidas estatísticas básicas foram calculadas:
a) desvio absoluto médio = 0, 00699 mol · kg−1;
b) desvio absoluto máximo = 0, 02083 mol · kg−1;
c) desvio relativo absoluto médio = 0,58%;
d) desvio relativo absoluto máximo = 1,74%.
O ajuste foi bastante satisfatório, o que é evidenciado pelo valor R

2 = 0, 93533
para o coeﬁciente de determinação, pela ANOVA (Tabela 8) com Pr(>F) = 0,00002 e

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

65

pelo desvio relativo absoluto médio = 0,58%. Todos os parâmetros obtidos (Tabela 12)
contribuem signiﬁcativamente para o modelo, pois, possuem baixos valores de Pr(>|t|).
Estes, também, apresentam signiﬁcante correlação entre si, conforme evidenciado pelos
altos valores absolutos na matriz de correlação (Tabela 13).

Observa-se, na Figura 33, que a molalidade do NaCl diminui com a temperatura, de
forma quase linear, em toda a faixa de temperatura correlacionada. Os dados experimentais,
de todos os autores, dispuseram-se em torno da curva, conﬁrmando um bom ajuste. O
ponto experimental de Kraus, Raridon e Baldwin (1964), próximo a 300K, embora sendo
o mais deslocado da curva ajustada, apresenta um desvio absoluto, relativo a molalidade,
muito pequeno.

Figura 33 – Molalidade do NaCl em MEG em função da Temperatura.

Fonte: O autor.

4.1.2 Sistema com mistura água e MEG (H2O+MEG+NaCl)
4.1.2.1 Potencial químico padrão de excesso do NaCl na mistura água e MEG (Regressão)

Dados de solubilidade de NaCl em água e MEG, selecionados dos sistemas estudados
(Tabela 4 e Tabela 5), foram ajustados por regressão não linear, conforme descrito na
subseção 3.12.6, utilizando-se a Equação 3.37. Resultando, após desprezar-se b0 e outras
simpliﬁcações, na equação:

iE

h

0{H2O+MEG}
NaCl

µ

νRT

(cid:16)1 − x

(cid:17)(cid:20)

θ0 + θ1T +

= x

{H2O+MEG}
MEG

+ (θ2 + θ3T) x

{H2O+MEG}
MEG
{H2O+MEG}
MEG

+ (θ4 + θ5T) x

{H2O+MEG}
MEG

2(cid:21)

(4.3)

onde θ0 = Θ0,0, θ1 = Θ0,1, θ2 = Θ1,0, θ3 = Θ1,1, θ4 = Θ2,0 e θ5 = Θ2,1.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

66

Capítulo 4. RESULTADOS E DISCUSSÕES

A análise estatística do ajuste por regressão não linear foi realizada com um nível

da signiﬁcância (α) de 5,0%, obtendo-se:

a) desvio padrão assintótico: s = 0,012440;
b) coeﬁciente de determinação: R
c) coeﬁciente de determinação ajustado: R
A Tabela 14 apresenta a ANOVA do ajuste por regressão não linear.

2
ajustado = 0,99926.

2 = 0,99930;

Tabela 14 – ANOVA (Sistema H2O+MEG+NaCl).

Fonte

Regressão
Resíduo
Total

Total Corrigido

Fonte: O autor.

GL Soma de Quadrados Quadrado Médio F-valor Pr(>F)
6
0,00000
101
107
106

45,517
0,015629
45,533
22,215

0,00041642

49024,0

7,5862

A Tabela 15 apresenta os parâmetros obtidos, do ajuste por regressão não linear,
para a Equação 4.3, juntamente com seus intervalos de conﬁança. O valor, para este caso,
do t de Student crítico foi: t-crítico = 1,9837.

Tabela 15 – Parâmetros obtidos (Sistema H2O+MEG+NaCl).

Parâmetro Estimativa Erro Padrão
Assintótico

t-valor

Pr(>|t|)

θ0
θ1
θ2
θ3
θ4
θ5

8,0858

-0,0078341

-17,963
0,037503
13,113
-0,016159

0,3384

0,0009962

1,590

0,004678

1,675

0,004914

23,8961
-7,8643
-11,2954
8,0161
7,8306
-3,2883

0,00000
0,00000
0,00000
0,00000
0,00000
0,00139

Intervalo de Conﬁança

Assintótico 95,0%
Inferior
7,4145

Superior
8,7570

-0,0098103

-21,117
0,028222

9,791

-0,025907

-0,0058580

-14,808
0,046784
16,435
-0,006411

Fonte: O autor.

A Tabela 16 apresenta a matriz de correlação dos parâmetros obtidos, do ajuste

por regressão não linear, para a Equação 4.3.

Tabela 16 – Matriz de Correlação (Sistema H2O+MEG+NaCl).
Parâmetro

θ0

θ1

θ4

θ2

θ3

θ5

θ0
θ1
θ2
θ3
θ4
θ5

1,00000
-0,99248
-0,93807
0,93154
0,85049
-0,84601

-0,99248
1,00000
0,93090
-0,93849
-0,84326
0,85156

-0,93807
0,93090
1,00000
-0,99249
-0,97273
0,96676

0,93154
-0,93849
-0,99249
1,00000
0,96428
-0,97289

0,85049
-0,84326
-0,97273
0,96428
1,00000
-0,99252

-0,84601
0,85156
0,96676
-0,97289
-0,99252
1,00000

Fonte: O autor.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

67

Algumas outras medidas estatísticas básicas foram calculadas:
a) desvio absoluto médio = 0,00834;
b) desvio absoluto máximo = 0,04081;
c) desvio relativo absoluto médio1 = 2,96%;
d) desvio relativo absoluto máximo1 = 72,20%.
O ajuste foi bastante satisfatório, o que é evidenciado pelo valor R

2 = 0, 99930
para o coeﬁciente de determinação, pela ANOVA (Tabela 14) com Pr(>F) = 0,00000 e
pelo desvio relativo absoluto médio = 2,96%. O ponto experimental com desvio relativo
absoluto máximo = 72,20% não foi considerado ruim devido ao seu baixo desvio absoluto
(0,01944). Todos os parâmetros obtidos (Tabela 15) contribuem signiﬁcativamente para o
modelo, pois, possuem baixos valores de Pr(>|t|). Estes, também, apresentam signiﬁcante
correlação entre si, conforme evidenciado pelos altos valores absolutos na matriz de
correlação (Tabela 16).

Observa-se, na Figura 34, que o potencial químico padrão de excesso do NaCl na
mistura água e MEG, nas diversas isotermas, cresce desde zero até um valor máximo
correspondente a fração molar de MEG livre de solvente próximo a 0,6 e, depois, decresce
até o valor zero. Nota-se, também, que as isotermas se cruzam no valor aproximado de 0,2
para a fração molar de MEG livre de solvente. Para valores menores que este, o potencial
químico padrão de excesso do NaCl na mistura água e MEG diminui com o aumento da
temperatura e, para a faixa restante da fração molar de MEG livre de solvente, tem um
comportamento inverso. Os dados experimentais, de todos os autores, dispuseram-se em
torno das respectivas isotermas, conﬁrmando o bom ajuste.

Figura 34 – Potencial químico padrão de excesso do NaCl na mistura água e MEG

em função da fração molar de MEG livre de NaCl (Regressão)2.

Fonte: O autor.

1 Foram desconsiderados 38 pontos experimentais.
2

Isotermas com menos de 3 pontos experimentais foram omitidas.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

68

Capítulo 4. RESULTADOS E DISCUSSÕES

4.1.2.2 Potencial químico padrão de excesso do NaCl na mistura água e MEG (Predição)

A Figura 35 representa as isotermas do potencial químico padrão de excesso do NaCl
na mistura água e MEG em função da fração molar de MEG livre de NaCl (Predição). Nela,
as regiões de crescimento e decrescimento correspondem, aproximadamente, as observadas
na Figura 34. Nota-se, também, o fenômeno de inversão em torno do mesmo valor citado
na Figura 34, ou seja, no valor aproximado de 0,2 para a fração molar de MEG livre
de solvente. Os dados experimentais, de todos os autores, dispuseram-se em torno das
respectivas isotermas, conﬁrmando a boa predição.

Figura 35 – Potencial químico padrão de excesso do NaCl na mistura água e MEG

em função da fração molar de MEG livre de NaCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,01359;
b) desvio absoluto máximo = 0,05278;
c) desvio relativo absoluto médio3 = 2,05
d) desvio relativo absoluto máximo3 = 5,17
Os valores do desvio absoluto médio = 0,01359 e do desvio relativo absoluto
médio = 2,05% indicam uma representatividade satisfatória em relação aos valores expe-
rimentais confrontados. Sendo assim, foi considerado que a estimativa para o potencial
químico padrão de excesso do NaCl na mistura água e MEG previu, de forma aceitável, os
dados experimentais comparativos usados.

3 Foram desconsiderados 5 pontos experimentais.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

69

4.1.2.3 Molalidade do NaCl na mistura água e MEG

Observa-se, na Figura 36, que a molalidade do NaCl na mistura água e MEG, nas
diversas isotermas, diminui, a razão inferior que a linear, com o aumento da fração molar
de MEG livre de solvente em toda a faixa desta. Nota-se, também, que as isotermas se
cruzam no valor aproximado de 0,8 para a fração molar de MEG livre de solvente. Para
valores menores que este, a molalidade do NaCl na mistura água e MEG aumenta com
o aumento da temperatura e, para a faixa restante da fração molar de MEG livre de
solvente, tem um comportamento inverso. Os dados experimentais, de todos os autores,
dispuseram-se em torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 36 – Molalidade do NaCl na mistura água e MEG em função da fração

molar de MEG livre de NaCl.

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0, 02186 mol · kg−1;
b) desvio absoluto máximo = 0, 12584 mol · kg−1;
c) desvio relativo absoluto médio = 0,83%;
d) desvio relativo absoluto máximo = 4,27%.
Os valores do desvio absoluto médio = 0, 02186 mol · kg−1 e do valor do desvio
relativo absoluto médio = 0,83% indicam uma representatividade satisfatória em relação aos
valores experimentais confrontados. Sendo assim, foi considerado que os valores calculados
para a molalidade do NaCl na mistura água e MEG representaram, de forma aceitável, os
dados experimentais comparativos usados.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

70

Capítulo 4. RESULTADOS E DISCUSSÕES

4.1.2.4 Molalidade do NaCl na mistura água e MEG (Predição)

A Figura 37 representa as isotermas da molalidade do NaCl na mistura água e
MEG em função da fração molar de MEG livre de NaCl (Predição). Nela, a forma como
ocorre o decrescimento da molalidade do NaCl na mistura água e MEG corresponde,
aproximadamente, a observada na Figura 36. Nota-se, também, o fenômeno de inversão
em torno do mesmo valor citado na Figura 36, ou seja, no valor aproximado de 0,8 para
a fração molar de MEG livre de solvente. Os dados experimentais, de todos os autores,
dispuseram-se em torno das respectivas isotermas, conﬁrmando a boa predição.

Figura 37 – Molalidade do NaCl na mistura água e MEG em função da fração

molar de MEG livre de NaCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0, 02791 mol · kg−1;
b) desvio absoluto máximo = 0, 10249 mol · kg−1;
c) desvio relativo absoluto médio = 1,26%;
d) desvio relativo absoluto máximo = 5,27%.
Os valores do desvio absoluto médio = 0, 02791 mol · kg−1 e do desvio relativo
absoluto médio = 1,26% indicam uma representatividade satisfatória em relação aos
valores experimentais confrontados. Sendo assim, foi considerado que a estimativa para
a molalidade do NaCl na mistura água e MEG previu, de forma aceitável, os dados
experimentais comparativos usados.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

71

4.1.2.5 Logaritmo de excesso da molalidade do NaCl na mistura água e MEG

Observa-se, na Figura 38, que o logaritmo de excesso da molalidade do NaCl na
mistura água e MEG, nas diversas isotermas, decresce desde zero até um valor mínimo
correspondente a fração molar de MEG livre de solvente próximo a 0,4 e, depois, cresce
até o valor zero. Nota-se, também, que o logaritmo de excesso da molalidade do NaCl na
mistura água e MEG, para cada fração molar de MEG livre de solvente, aumenta com o
aumento da temperatura. Os dados experimentais, de todos os autores, dispuseram-se em
torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 38 – Logaritmo de excesso da molalidade do NaCl na mistura água e MEG

em função da fração molar de MEG livre de NaCl.

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00834;
b) desvio absoluto máximo = 0,04363;
c) desvio relativo absoluto médio4 = 6,35%;
d) desvio relativo absoluto máximo4 = 93,65%.
Os valores do desvio absoluto médio = 0,00834 e do desvio relativo absoluto
médio = 6,35% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. O ponto experimental com desvio relativo absoluto máximo = 93,65%
não foi considerado ruim devido ao seu baixo desvio absoluto (0,01771). Sendo assim,
foi considerado que os valores calculados para o logaritmo de excesso da molalidade do
NaCl na mistura água e MEG representaram, de forma aceitável, os dados experimentais
comparativos usados.
4 Foram desconsiderados 18 pontos experimentais.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

72

Capítulo 4. RESULTADOS E DISCUSSÕES

4.1.2.6 Logaritmo de excesso da molalidade do NaCl na mistura água e MEG (Predição)

A Figura 39 representa as isotermas do logaritmo de excesso da molalidade do NaCl
na mistura água e MEG em função da fração molar de MEG livre de NaCl (Predição). Nela,
as regiões de decrescimento e crescimento correspondem, aproximadamente, as observadas
na Figura 38. Nota-se, como na Figura 38, que o logaritmo de excesso da molalidade
do NaCl na mistura água e MEG, para cada fração molar de MEG livre de solvente,
aumenta com o aumento da temperatura. Os dados experimentais, de todos os autores,
dispuseram-se em torno das respectivas isotermas, conﬁrmando a boa predição.

Figura 39 – Logaritmo de excesso da molalidade do NaCl na mistura água e MEG

em função da fração molar de MEG livre de NaCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,01240;
b) desvio absoluto máximo = 0,05138;
c) desvio relativo absoluto médio5 = 5,98%;
d) desvio relativo absoluto máximo5 = 19,23%.
Os valores do desvio absoluto médio = 0,01240 e do desvio relativo absoluto
médio = 5,98% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. O ponto experimental com desvio relativo absoluto máximo = 19,23%
não foi considerado ruim devido ao seu baixo desvio absoluto (0,03351). Sendo assim,
foi considerado que a estimativa para o logaritmo de excesso da molalidade do NaCl na
mistura água e MEG previu, de forma aceitável, os dados experimentais comparativos
usados.
5 Foram desconsiderados 5 pontos experimentais.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

73

4.1.2.7 Coeﬁciente de atividade do NaCl na mistura água e MEG

Observa-se, na Figura 40, que o coeﬁciente de atividade do NaCl na mistura
água e MEG, nas diversas isotermas, diminui da faixa de 0,8-1,0 até um valor mínimo
correspondente a fração molar de MEG livre de solvente próximo a 0,6 e, depois, cresce até
a faixa de 1,2-1,7. Nota-se, também, que as isotermas se cruzam no valor aproximado de 0,8
para a fração molar de MEG livre de solvente. Para valores menores que este, o coeﬁciente
de atividade do NaCl na mistura água e MEG diminui com o aumento da temperatura e,
para a faixa restante da fração molar de MEG livre de solvente, tem um comportamento
inverso. Logo, os maiores afastamentos da idealidade ocorrem no mínimo antes da inversão
e em MEG puro. Os dados experimentais, de todos os autores, dispuseram-se em torno
das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 40 – Coeﬁciente de atividade do NaCl na mistura água e MEG em função

da fração molar de MEG livre de NaCl.

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00125;
b) desvio absoluto máximo = 0,01173;
c) desvio relativo absoluto médio = 0,16%;
d) desvio relativo absoluto máximo = 1,42%.
Os valores do desvio absoluto médio = 0,00125 e do desvio relativo absoluto
médio = 0,16% indicam uma representatividade satisfatória em relação aos valores ex-
perimentais confrontados. Sendo assim, foi considerado que os valores calculados para
o coeﬁciente de atividade do NaCl na mistura água e MEG representaram, de forma
aceitável, os dados experimentais comparativos usados.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

74

Capítulo 4. RESULTADOS E DISCUSSÕES

4.1.2.8 Coeﬁciente de atividade do NaCl na mistura água e MEG (Predição)

A Figura 41 representa as isotermas do coeﬁciente de atividade do NaCl na mistura
água e MEG em função da fração molar de MEG livre de NaCl (Predição). Nela, as
regiões de decrescimento e crescimento correspondem, aproximadamente, as observadas
na Figura 40. Nota-se, também, o fenômeno de inversão em torno do mesmo valor citado
na Figura 40, ou seja, no valor aproximado de 0,8 para a fração molar de MEG livre
de solvente. Os dados experimentais, de todos os autores, dispuseram-se em torno das
respectivas isotermas, conﬁrmando a boa predição.

Figura 41 – Coeﬁciente de atividade do NaCl na mistura água e MEG em função

da fração molar de MEG livre de NaCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00140;
b) desvio absoluto máximo = 0,00520;
c) desvio relativo absoluto médio = 0,16%;
d) desvio relativo absoluto máximo = 0,48%.
Os valores do desvio absoluto médio = 0,00140 e do desvio relativo absoluto
médio = 0,16% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. Sendo assim, foi considerado que a estimativa para o coeﬁciente
de atividade do NaCl na mistura água e MEG previu, de forma aceitável, os dados
experimentais comparativos usados.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

75

4.1.2.9 Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura água e MEG

Observa-se, na Figura 42, que o logaritmo de excesso do coeﬁciente de atividade do
NaCl na mistura água e MEG, nas diversas isotermas, decresce desde zero até um valor
mínimo correspondente a fração molar de MEG livre de solvente próximo a 0,65 e, depois,
cresce até o valor zero. Nota-se, também, que as isotermas se cruzam no valor aproximado
de 0,1 para a fração molar de MEG livre de solvente. Para valores menores que este, o
logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura água e MEG aumenta
com o aumento da temperatura e, para a faixa restante da fração molar de MEG livre de
solvente, tem um comportamento inverso. Os dados experimentais, de todos os autores,
dispuseram-se em torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 42 – Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura

água e MEG em função da fração molar de MEG livre de NaCl.

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00159;
b) desvio absoluto máximo = 0,01413;
c) desvio relativo absoluto médio6 = 1,08%;
d) desvio relativo absoluto máximo6 = 21,51%.
Os valores do desvio absoluto médio = 0,00159 e do desvio relativo absoluto
médio = 1,08% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. O ponto experimental com desvio relativo absoluto máximo = 21,51%
não foi considerado ruim devido ao seu baixo desvio absoluto (0,00172). Sendo assim, foi
considerado que os valores calculados para a molalidade do NaCl na mistura água e MEG
representaram, de forma aceitável, os dados experimentais comparativos usados.
6 Foram desconsiderados 18 pontos experimentais.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

76

Capítulo 4. RESULTADOS E DISCUSSÕES

4.1.2.10 Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura água e MEG

(Predição)

A Figura 43 representa as isotermas do logaritmo de excesso do coeﬁciente de
atividade do NaCl na mistura água e MEG em função da fração molar de MEG livre de
NaCl (Predição). Nela, as regiões de decrescimento e crescimento correspondem, aproxi-
madamente, as observadas na Figura 42. Nota-se, também, o fenômeno de inversão em
torno do mesmo valor citado na Figura 42, ou seja, no valor aproximado de 0,1 para a
fração molar de MEG livre de solvente. Os dados experimentais, de todos os autores,
dispuseram-se em torno das respectivas isotermas, conﬁrmando a boa predição.

Figura 43 – Logaritmo de excesso do coeﬁciente de atividade do NaCl na mistura
água e MEG em função da fração molar de MEG livre de NaCl
(Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00160;
b) desvio absoluto máximo = 0,00482;
c) desvio relativo absoluto médio7 = 0,57%;
d) desvio relativo absoluto máximo7 = 2,82%.
Os valores do desvio absoluto médio = 0,00160 e do desvio relativo absoluto
médio = 0,57% indicam uma representatividade satisfatória em relação aos valores expe-
rimentais confrontados. Sendo assim, foi considerado que a estimativa para o logaritmo
de excesso do coeﬁciente de atividade do NaCl na mistura água e MEG previu, de forma
aceitável, os dados experimentais comparativos usados.
7 Foram desconsiderados 5 pontos experimentais.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES
4.2 Sistemas com KCl
4.2.1 Sistemas com solvente simples
4.2.1.1 Sistema H2O+KCl

77

Dados de solubilidade de KCl em água, selecionados dos sistemas estudados (Ta-
bela 4 e Tabela 5), foram ajustados por regressão não linear, conforme descrito na
subseção 3.12.5, utilizando-se a Equação 3.36. Resultando, após desprezar-se b0 e outras
simpliﬁcações, na equação:

{H2O}
KCl = exp (θ0 + θ1T + θ2 ln T)

b

(4.4)

onde θ0 = Θ0, θ1 = Θ1 e θ2 = Θ−2.

A análise estatística do ajuste por regressão não linear foi realizada com um nível

da signiﬁcância (α) de 5,0%, obtendo-se:

a) desvio padrão assintótico: s = 0, 025689 mol · kg−1;
b) coeﬁciente de determinação: R
c) coeﬁciente de determinação ajustado: R
A Tabela 17 apresenta a análise de variância (ANOVA) do ajuste por regressão

2
ajustado = 0,99927.

2 = 0,99933;

não linear.

Tabela 17 – ANOVA (Sistema H2O+KCl).

Fonte

Regressão
Resíduo
Total

Total Corrigido

Fonte: O autor.

GL Soma de Quadrados Quadrado Médio
3
22
25
24

759,88
0,014518
759,89
21,661

0,00065993

253,29

F-valor
383820,0

Pr(>F)
0,00000

A Tabela 18 apresenta os parâmetros obtidos, do ajuste por regressão não linear,
para a Equação 4.4, juntamente com seus intervalos de conﬁança. O valor, para este caso,
do t de Student crítico foi: t-crítico = 2,0739.

Tabela 18 – Parâmetros obtidos (Sistema H2O+KCl).

Parâmetro Estimativa Erro Padrão
Assintótico

t-valor

Pr(>|t|)

θ0
θ1
θ2

-28,334
-0,011414
5,8452

1,474

0,000943
0,3079

-19,2259
-12,1105
18,9840

0,00000
0,00000
0,00000

Fonte: O autor.

Intervalo de Conﬁança

Assintótico 95,0%
Inferior
Superior
-25,278
-31,391
-0,009460
-0,013369
5,2066
6,4837

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

78

Capítulo 4. RESULTADOS E DISCUSSÕES

A Tabela 19 apresenta a matriz de correlação dos parâmetros obtidos, do ajuste

por regressão não linear, para a Equação 4.4.

Tabela 19 – Matriz de Correlação (Sis-

tema H2O+KCl).

Parâmetro

θ0
θ1
θ2

θ0

1,00000
0,99899
-0,99997

θ1

0,99899
1,00000
-0,99931

θ2

-0,99997
-0,99931
1,00000

Fonte: O autor.

Algumas outras medidas estatísticas básicas foram calculadas:
a) Desvio Absoluto Médio = 0, 01535 mol · kg−1
b) Desvio Absoluto Máximo = 0, 07874 mol · kg−1
c) Desvio Relativo Absoluto Médio = 0,31%
d) Desvio Relativo Absoluto Máximo = 1,62%
O ajuste foi bastante satisfatório, o que é evidenciado pelo valor R

2 = 0, 99933
para o coeﬁciente de determinação, pela ANOVA (Tabela 17) com Pr(>F) = 0,00000 e
pelo desvio relativo absoluto médio = 0,31%. Todos os parâmetros obtidos (Tabela 18)
contribuem signiﬁcativamente para o modelo, pois, possuem baixos valores de Pr(>|t|).
Estes, também, apresentam signiﬁcante correlação entre si, conforme evidenciado pelos
altos valores absolutos na matriz de correlação (Tabela 19).

Observa-se, na Figura 44, que a molalidade do KCl aumenta com a temperatura, de
forma quase linear, em toda a faixa de temperatura correlacionada. Os dados experimentais,
de todos os autores, dispuseram-se em torno da curva, conﬁrmando um bom ajuste.

Figura 44 – Molalidade do KCl em H2O em função da Temperatura.

Fonte: O autor.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

4.2.1.2 Sistema MEG+KCl

79

Dados de solubilidade de KCl em MEG, selecionados dos sistemas estudados
(Tabela 4 e Tabela 5), foram ajustados por regressão não linear, conforme descrito na
subseção 3.12.5, utilizando-se a Equação 3.36. Resultando, após desprezar-se b0 e outras
simpliﬁcações, na equação:

onde θ0 = Θ0 e θ1 = Θ1.

b

{MEG}
KCl = exp (θ0 + θ1T)

(4.5)

A análise estatística do ajuste por regressão não linear foi realizada com um nível

da signiﬁcância (α) de 5,0%, obtendo-se:

a) desvio padrão assintótico: s = 0, 021080 mol · kg−1;
b) coeﬁciente de determinação: R
c) coeﬁciente de determinação ajustado: R

2 = 0,94418;

2
ajustado = 0,93301.

A Tabela 20 apresenta a análise de variância (ANOVA) do ajuste por regressão

não linear.

Tabela 20 – ANOVA (Sistema MEG+KCl).

Fonte

Regressão
Resíduo
Total

Total Corrigido

Fonte: O autor.

GL Soma de Quadrados Quadrado Médio F-valor Pr(>F)
2
0,00022
5
7
6

4,0160
0,039801

0,00044437

4,0137

0,0022219

2,0069

4516,2

A Tabela 21 apresenta os parâmetros obtidos, do ajuste por regressão não linear,
para a Equação 4.5, juntamente com seus intervalos de conﬁança. O valor, para este caso,
do t de Student crítico foi: t-crítico = 2,5706.

Tabela 21 – Parâmetros obtidos (Sistema MEG+KCl).

Parâmetro Estimativa Erro Padrão
Assintótico

t-valor

Pr(>|t|)

θ0
θ1

-1,8722
0,0051201

0,1658

0,0005283

-11,2902
9,6914

0,00010
0,00020

Fonte: O autor.

Intervalo de Conﬁança

Assintótico 95,0%
Superior
Inferior
-2,2985
-1,4459
0,0064781
0,0037620

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

80

Capítulo 4. RESULTADOS E DISCUSSÕES

A Tabela 22 apresenta a matriz de correlação dos parâmetros obtidos, do ajuste

por regressão não linear, para a Equação 4.5.

Tabela 22 – Matriz de Correlação
(Sistema MEG+KCl).

Parâmetro

θ0
θ1

θ0

θ1

1,00000
-0,99798

-0,99798
1,00000

Fonte: O autor.

Algumas outras medidas estatísticas básicas foram calculadas:
a) Desvio Absoluto Médio = 0, 01262 mol · kg−1
b) Desvio Absoluto Máximo = 0, 03993 mol · kg−1
c) Desvio Relativo Absoluto Médio = 1,74%
d) Desvio Relativo Absoluto Máximo = 5,34%
O ajuste foi satisfatório, o que é evidenciado pelo valor R

2 = 0, 944175 para o
coeﬁciente de determinação, pela ANOVA (Tabela 20) com Pr(>F) = 0,00022 e pelo desvio
relativo absoluto médio = 1,74%. Todos os parâmetros obtidos (Tabela 21) contribuem
signiﬁcativamente para o modelo, pois, possuem baixos valores de Pr(>|t|). Estes, também,
apresentam signiﬁcante correlação entre si, conforme evidenciado pelos altos valores
absolutos na matriz de correlação (Tabela 22).

Observa-se, na Figura 45, que a molalidade do KCl aumenta com a temperatura, de
forma quase linear, em toda a faixa de temperatura correlacionada. Os dados experimentais,
de todos os autores, dispuseram-se em torno da curva, conﬁrmando um bom ajuste.

Figura 45 – Molalidade do KCl em MEG em função da Temperatura.

Fonte: O autor.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

81

4.2.2 Sistema com mistura água e MEG (H2O+MEG+KCl)
4.2.2.1 Potencial químico padrão de excesso do KCl na mistura água e MEG (Regressão)

Dados de solubilidade de KCl em água e MEG, selecionados dos sistemas estudados
(Tabela 4 e Tabela 5), foram ajustados por regressão não linear, conforme descrito na
subseção 3.12.6, utilizando-se a Equação 3.37. Resultando, após desprezar-se b0 e outras
simpliﬁcações, na equação:

iE

h

0{H2O+MEG}
KCl

µ

νRT

(cid:16)1 − x

(cid:17)(cid:20)

θ0 + θ1T +

= x

{H2O+MEG}
MEG

+ (θ2 + θ3T) x

{H2O+MEG}
MEG
{H2O+MEG}
MEG

+ (θ4 + θ5T) x

{H2O+MEG}
MEG

2(cid:21)

(4.6)

onde θ0 = Θ0,0, θ1 = Θ0,1, θ2 = Θ1,0, θ3 = Θ1,1, θ4 = Θ2,0 e θ5 = Θ2,1.

A análise estatística do ajuste por regressão não linear foi realizada com um nível

da signiﬁcância (α) de 5,0%, obtendo-se:

a) desvio padrão assintótico: s = 0,021573;
b) coeﬁciente de determinação: R
c) coeﬁciente de determinação ajustado: R
A Tabela 23 apresenta a análise de variância (ANOVA) do ajuste por regressão

2
ajustado = 0,99676.

2 = 0,99703;

não linear.

Tabela 23 – ANOVA (Sistema H2O+MEG+KCl).

Fonte

Regressão
Resíduo
Total

Total Corrigido

Fonte: O autor.

GL Soma de Quadrados Quadrado Médio F-valor Pr(>F)
6
0,00000
54
60
59

14,219
0,025131
14,244
8,4706

0,00046539

2,3699

5092,2

A Tabela 24 apresenta os parâmetros obtidos, do ajuste por regressão não linear,
para a Equação 4.6, juntamente com seus intervalos de conﬁança. O valor, para este caso,

Tabela 24 – Parâmetros obtidos (Sistema H2O+MEG+KCl).

Parâmetro Estimativa Erro Padrão
Assintótico

t-valor Pr(>|t|)

θ0
θ1
θ2
θ3
θ4
θ5

1,4330
0,010232
-20,276
0,050807
12,410
-0,018566

3,6517
0,012044
16,940
0,055854
17,368
0,057203

0,3924
0,8495
-1,1969
0,9096
0,7145
-0,3246

0,69629
0,39934
0,23658
0,36705
0,47797
0,74676

Fonte: O autor.

Intervalo de Conﬁança

Assintótico 95,0%
Superior
Inferior
8,7543
-5,8882
0,034378
-0,013915
-54,239
13,688
0,162788
-0,061173
47,231
-22,411
-0,133251
0,096119

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

82

Capítulo 4. RESULTADOS E DISCUSSÕES

do t de Student crítico foi: t-crítico = 2,0049.

A Tabela 25 apresenta a matriz de correlação dos parâmetros obtidos, do ajuste

por regressão não linear, para a Equação 4.6.

Tabela 25 – Matriz de Correlação (Sistema H2O+MEG+KCl).
Parâmetro

θ2

θ3

θ0

θ1

θ4

θ5

θ0
θ1
θ2
θ3
θ4
θ5

1,00000
-0,99955
-0,94216
0,94194
0,86660
-0,86704

-0,99955
1,00000
0,94163
-0,94227
-0,86583
0,86707

-0,94216
0,94163
1,00000
-0,99954
-0,97823
0,97836

0,94194
-0,94227
-0,99954
1,00000
0,97731
-0,97838

0,86660
-0,86583
-0,97823
0,97731
1,00000
-0,99950

-0,86704
0,86707
0,97836
-0,97838
-0,99950
1,00000

Fonte: O autor.

Algumas outras medidas estatísticas básicas foram calculadas:
a) Desvio Absoluto Médio = 0,01215
b) Desvio Absoluto Máximo = 0,09846
c) Desvio Relativo Absoluto Médio8 = 14,88%
d) Desvio Relativo Absoluto Máximo8 = 197,84%
O ajuste foi satisfatório, o que é evidenciado pelo valor R

2 = 0, 99703 para o
coeﬁciente de determinação, pela ANOVA (Tabela 14) com Pr(>F) = 0,00000 e visualmente
pela Figura 46, mesmo com um desvio relativo absoluto médio = 14,88%. O ponto

Figura 46 – Potencial químico padrão de excesso do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl (Regressão).

Fonte: O autor.

8 Foram desconsiderados 28 pontos experimentais.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

83

experimental com desvio relativo absoluto máximo = 197,84% não foi considerado ruim
devido ao seu baixo desvio absoluto (0,00609). Todos os parâmetros obtidos (Tabela 24),
dentro do nível de signiﬁcância adotado (5%), foram considerados, individualmente, não
signiﬁcativos para o modelo por possuirem |t-valor|<t-crítico, o que gerou altos valores
para Pr(>|t|). Estes, entretanto, apresentaram signiﬁcante correlação entre si, conforme
evidenciado pelos altos valores absolutos na matriz de correlação (Tabela 25). Este fato,
2 e da ANOVA, ﬁzeram com que, coletivamente, os parâmetros
juntamente os valores de R
obtidos fossem considerados relevantes para o modelo.

Observa-se, na Figura 46, que o potencial químico padrão de excesso do KCl na
mistura água e MEG, nas diversas isotermas, cresce desde zero até um valor máximo
correspondente a fração molar de MEG livre de solvente próximo a 0,6 e, depois, decresce
até o valor zero. Nota-se, também, que o potencial químico padrão de excesso do KCl
na mistura água e MEG, para cada fração molar de MEG livre de solvente, aumenta
com o aumento da temperatura. De todos os autores, somente os dados experimentais de
Zhou et al. (2010), apresentaram um maior afastamento da respectiva isoterma, os demais,
dispuseram-se em torno das respectivas isotermas, conﬁrmando o bom ajuste.

4.2.2.2 Potencial químico padrão de excesso do KCl na mistura água e MEG (Predição)

A Figura 47 representa uma isoterma do potencial químico padrão de excesso do
KCl na mistura água e MEG em função da fração molar de MEG livre de KCl (Predição).
Nela, as regiões de crescimento e decrescimento correspondem, aproximadamente, as
observadas na Figura 46. Os dados experimentais, de todos os autores, dispuseram-se em
torno das respectivas isotermas, conﬁrmando a boa predição.

Figura 47 – Potencial químico padrão de excesso do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl (Predição).

Fonte: O autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

84

Capítulo 4. RESULTADOS E DISCUSSÕES

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00378;
b) desvio absoluto máximo = 0,01199;
c) desvio relativo absoluto médio9 = 0,65%;
d) desvio relativo absoluto máximo9 = 1,33%.
Os valores do desvio absoluto médio = 0,00378 e do desvio relativo absoluto
médio = 0,65% indicam uma representatividade satisfatória em relação aos valores expe-
rimentais confrontados. Sendo assim, foi considerado que a estimativa para o potencial
químico padrão de excesso do KCl na mistura água e MEG previu, de forma aceitável, os
dados experimentais comparativos usados.

4.2.2.3 Molalidade do KCl na mistura água e MEG

Observa-se, na Figura 48, que a molalidade do KCl na mistura água e MEG, nas
diversas isotermas, diminui, a razão inferior que a linear, com o aumento da fração molar de
MEG livre de solvente em toda a faixa desta. Nota-se, também, que a molalidade do KCl
na mistura água e MEG, para cada fração molar de MEG livre de solvente, aumenta com
o aumento da temperatura. Os dados experimentais, de todos os autores, dispuseram-se
em torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 48 – Molalidade do KCl na mistura água e MEG em função da fração

molar de MEG livre de KCl.

Fonte: O autor.

9 Foi desconsiderado 1 ponto experimental.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

85

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0, 02489 mol · kg−1;
b) desvio absoluto máximo = 0, 10623 mol · kg−1;
c) desvio relativo absoluto médio = 1,58%;
d) desvio relativo absoluto máximo = 10,94%.
Os valores do desvio absoluto médio = 0, 02489 mol · kg−1 e do valor do desvio
relativo absoluto médio = 1,58% indicam uma representatividade satisfatória em relação aos
valores experimentais confrontados. Sendo assim, foi considerado que os valores calculados
para a molalidade do KCl na mistura água e MEG representaram, de forma aceitável, os
dados experimentais comparativos usados.

4.2.2.4 Molalidade do KCl na mistura água e MEG (Predição)

A Figura 49 representa a isoterma da molalidade do KCl na mistura água e
MEG em função da fração molar de MEG livre de KCl (Predição). Nela, a forma como
ocorre o decrescimento da molalidade do KCl na mistura água e MEG corresponde,
aproximadamente, a observada na Figura 48. Os dados experimentais, de todos os autores,
dispuseram-se em torno da isoterma, conﬁrmando a boa predição.

Figura 49 – Isoterma da molalidade do KCl na mistura água e MEG em função

da fração molar de MEG livre de KCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0, 06224 mol · kg−1;

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

86

Capítulo 4. RESULTADOS E DISCUSSÕES

b) desvio absoluto máximo = 0, 10643 mol · kg−1;
c) desvio relativo absoluto médio = 2,96%;
d) desvio relativo absoluto máximo = 8,01%.
Os valores do desvio absoluto médio = 0, 06224 mol · kg−1 e do desvio relativo
absoluto médio = 2,96% indicam uma representatividade satisfatória em relação aos
valores experimentais confrontados. Sendo assim, foi considerado que a estimativa para
a molalidade do KCl na mistura água e MEG previu, de forma aceitável, os dados
experimentais comparativos usados.

4.2.2.5 Logaritmo de excesso da molalidade do KCl na mistura água e MEG

Observa-se, na Figura 50, que o logaritmo de excesso da molalidade do KCl na
mistura água e MEG, nas diversas isotermas, decresce desde zero até um valor mínimo
correspondente a fração molar de MEG livre de solvente próximo a 0,4 e, depois, cresce
até o valor zero. Nota-se, também, que o logaritmo de excesso da molalidade do KCl
na mistura água e MEG, para cada fração molar de MEG livre de solvente, aumenta
com o aumento da temperatura. De todos os autores, somente os dados experimentais de
Zhou et al. (2010), apresentaram um maior afastamento da respectiva isoterma, os demais,
dispuseram-se em torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 50 – Logaritmo de excesso da molalidade do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl.

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,01593;
b) desvio absoluto máximo = 0,11588;

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

87

c) desvio relativo absoluto médio10 = 15,58%;
d) desvio relativo absoluto máximo10 = 109,53%.
Os valores do desvio absoluto médio = 0,01593 e do desvio relativo absoluto
médio = 15,58% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. O ponto experimental com desvio relativo absoluto máximo = 109,53%
não foi considerado ruim devido ao seu baixo desvio absoluto (0,00487). Sendo assim,
foi considerado que os valores calculados para o logaritmo de excesso da molalidade do
KCl na mistura água e MEG representaram, de forma aceitável, os dados experimentais
comparativos usados.

4.2.2.6 Logaritmo de excesso da molalidade do KCl na mistura água e MEG (Predição)

A Figura 51 representa a isoterma do logaritmo de excesso da molalidade do KCl na
mistura água e MEG em função da fração molar de MEG livre de KCl (Predição). Nela, as
regiões de decrescimento e crescimento correspondem, aproximadamente, as observadas na
Figura 50. Nota-se, como na Figura 50, que o logaritmo de excesso da molalidade do KCl
na mistura água e MEG, para cada fração molar de MEG livre de solvente, aumenta com
o aumento da temperatura. Os dados experimentais dispuseram-se em torno da isoterma,
conﬁrmando a boa predição.

Figura 51 – Logaritmo de excesso da molalidade do KCl na mistura água e MEG

em função da fração molar de MEG livre de KCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,03039;
10 Foram desconsiderados 14 pontos experimentais.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

88

Capítulo 4. RESULTADOS E DISCUSSÕES

b) desvio absoluto máximo = 0,08347;
c) desvio relativo absoluto médio11 = 10,95%;
d) desvio relativo absoluto máximo11 = 23,37%.
Os valores do desvio absoluto médio = 0,03039 e do desvio relativo absoluto
médio = 10,95% indicam uma representatividade satisfatória em relação aos valores expe-
rimentais confrontados. Sendo assim, foi considerado que a estimativa para o logaritmo
de excesso da molalidade do NaCl na mistura água e MEG previu, de forma aceitável, os
dados experimentais comparativos usados.

4.2.2.7 Coeﬁciente de atividade do KCl na mistura água e MEG

Observa-se, na Figura 52, que o coeﬁciente de atividade do KCl na mistura água e
MEG, nas diversas isotermas, diminui da faixa de 0,6-0,7 até um valor mínimo correspon-
dente a fração molar de MEG livre de solvente próximo a 0,6 e, depois, cresce até a faixa
de 1,0-1,3. Nota-se, também, que as isotermas se cruzam nos valores aproximados de 0,2 e
0,7 para a fração molar de MEG livre de solvente. Para a faixa 0,2-0,7, o coeﬁciente de
atividade do KCl na mistura água e MEG diminui com o aumento da temperatura e, para
as faixas restantes de fração molar de MEG livre de solvente, tem um comportamento
inverso. Logo, os maiores afastamentos da idealidade ocorrem no mínimo interno a faixa
0,2-0,7 e em MEG puro. Os dados experimentais, de todos os autores, dispuseram-se em
torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 52 – Coeﬁciente de atividade do KCl na mistura água e MEG em função

da fração molar de MEG livre de KCl.

Fonte: O autor.

11 Foi desconsiderado 1 ponto experimental.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

89

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00133;
b) desvio absoluto máximo = 0,00933;
c) desvio relativo absoluto médio = 0,21%;
d) desvio relativo absoluto máximo = 1,76%.
Os valores do desvio absoluto médio = 0,00133 e do desvio relativo absoluto
médio = 0,21% indicam uma representatividade satisfatória em relação aos valores ex-
perimentais confrontados. Sendo assim, foi considerado que os valores calculados para o
coeﬁciente de atividade do KCl na mistura água e MEG representaram, de forma aceitável,
os dados experimentais comparativos usados.

4.2.2.8 Coeﬁciente de atividade do KCl na mistura água e MEG (Predição)

A Figura 53 representa a isoterma do coeﬁciente de atividade do KCl na mistura
água e MEG em função da fração molar de MEG livre de KCl (Predição). Nela, as
regiões de decrescimento e crescimento correspondem, aproximadamente, as observadas
na Figura 52. Os dados experimentais, de todos os autores, dispuseram-se em torno da
isoterma, conﬁrmando a boa predição.

Figura 53 – Coeﬁciente de atividade do KCl na mistura água e MEG em função

da fração molar de MEG livre de KCl (Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00205;

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

90

Capítulo 4. RESULTADOS E DISCUSSÕES

b) desvio absoluto máximo = 0,00571;
c) desvio relativo absoluto médio = 0,38%;
d) desvio relativo absoluto máximo = 1,21%.
Os valores do desvio absoluto médio = 0,00205 e do desvio relativo absoluto
médio = 0,38% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. Sendo assim, foi considerado que a estimativa para o coeﬁciente de
atividade do KCl na mistura água e MEG previu, de forma aceitável, os dados experimentais
comparativos usados.

4.2.2.9 Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura água e MEG

Observa-se, na Figura 54, que o logaritmo de excesso do coeﬁciente de atividade
do KCl na mistura água e MEG, nas diversas isotermas, decresce desde zero até um valor
mínimo correspondente a fração molar de MEG livre de solvente próximo a 0,7 e, depois,
cresce até o valor zero. Nota-se, também, que o logaritmo de excesso do coeﬁciente de
atividade do KCl na mistura água e MEG, para cada fração molar de MEG livre de
solvente, diminui com o aumento da temperatura. Os dados experimentais, de todos os
autores, dispuseram-se em torno das respectivas isotermas, conﬁrmando o bom cálculo.

Figura 54 – Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura

água e MEG em função da fração molar de MEG livre de KCl.

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores calculados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00209;
b) desvio absoluto máximo = 0,01742;

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

91

c) desvio relativo absoluto médio12 = 6,21%;
d) desvio relativo absoluto máximo12 = 89,24%.
Os valores do desvio absoluto médio = 0,00209 e do desvio relativo absoluto
médio = 6,21% indicam uma representatividade satisfatória em relação aos valores experi-
mentais confrontados. O ponto experimental com desvio relativo absoluto máximo = 89,24%
não foi considerado ruim devido ao seu baixo desvio absoluto (0,00122). Sendo assim, foi
considerado que os valores calculados para a molalidade do NaCl na mistura água e MEG
representaram, de forma aceitável, os dados experimentais comparativos usados.

4.2.2.10 Logaritmo de excesso do coeﬁciente de atividade do KCl na mistura água e MEG

(Predição)

A Figura 55 representa a isoterma do logaritmo de excesso do coeﬁciente de atividade
do KCl na mistura água e MEG em função da fração molar de MEG livre de KCl (Predição).
Nela, as regiões de decrescimento e crescimento correspondem, aproximadamente, as
observadas na Figura 54. Os dados experimentais dispuseram-se em torno da isoterma,
conﬁrmando a boa predição.

Figura 55 – Logaritmo de excesso do coeﬁciente de atividade do KCl na mis-
tura água e MEG em função da fração molar de MEG livre de KCl
(Predição).

Fonte: O autor.

Algumas medidas estatísticas básicas, para os desvios entre valores estimados e

pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00378;
12 Foram desconsiderados 14 pontos experimentais.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

92

Capítulo 4. RESULTADOS E DISCUSSÕES

b) desvio absoluto máximo = 0,01199;
c) desvio relativo absoluto médio13 = 0,65%;
d) desvio relativo absoluto máximo13 = 1,33%.
Os valores do desvio absoluto médio = 0,00378 e do desvio relativo absoluto
médio = 0,65% indicam uma representatividade satisfatória em relação aos valores expe-
rimentais confrontados. Sendo assim, foi considerado que a estimativa para o logaritmo
de excesso do coeﬁciente de atividade do KCl na mistura água e MEG previu, de forma
aceitável, os dados experimentais comparativos usados.

4.3 Validação do Modelo de Pitzer implementado

A subrotina do Modelo de Pitzer, utilizada pelo programa JAFOSSMS (seção 3.13),
foi validada com base nos dados de Hamer e Wu (1972). A validação foi feita para o
coeﬁciente de atividade. Os sistemas utilizados na validação consistiam de um sal (NaCl
ou KCl) em água. Apresenta-se, a seguir, os resultados obtidos neste processo de validação.

4.3.1 Coeﬁciente de atividade do NaCl em água

Observa-se, na Figura 56, que o coeﬁciente de atividade do NaCl em água a 25 ℃,
como função da molalidade do NaCl, calculado pelo programa JAFOSSMS (seção 3.13),
ajusta-se muito bem aos dados experimentais de Hamer e Wu (1972).

Figura 56 – Modelo de Pitzer implementado (γ

NaCl × b
{H2O}

{H2O}
NaCl a 25 ℃).

Fonte: O autor.

13 Foi desconsiderado 1 ponto experimental.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

93

Algumas medidas estatísticas básicas, relativas a Figura 56, para os desvios entre

valores calculados e pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00089;
b) desvio absoluto máximo = 0,00418;
c) desvio relativo absoluto médio = 0,11%;
d) desvio relativo absoluto máximo = 0,42%.

Os valores baixos destes desvios demostraram uma grande precisão no cálculo do coeﬁciente
de atividade do NaCl em água a 25 ℃.

4.3.2 Coeﬁciente de atividade do KCl em água

Observa-se, na Figura 57, que o coeﬁciente de atividade do KCl em água a 25 ℃,
como função da molalidade do KCl, calculado pelo programa JAFOSSMS (seção 3.13),
ajusta-se bem aos dados experimentais de Hamer e Wu (1972). Nota-se, que o desvio em
relação aos dados experimentais aumenta com o aumento da molalidade do KCl.

Figura 57 – Modelo de Pitzer implementado (γ

KCl × b
{H2O}

{H2O}
KCl

).

Fonte: O autor.

Algumas medidas estatísticas básicas, relativas a Figura 57, para os desvios entre

valores calculados e pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00409;
b) desvio absoluto máximo = 0,01669;
c) desvio relativo absoluto médio = 0,69%;
d) desvio relativo absoluto máximo = 2,81%.

Os valores baixos destes desvios demostraram uma boa precisão no cálculo do coeﬁciente
de atividade do KCl em água a 25 ℃.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

94

Capítulo 4. RESULTADOS E DISCUSSÕES

O programa JAFOSSMS (seção 3.13) calcula os parâmetros do Modelo de Pitzer
para o KCl, em função da temperatura, pelas equações de Archer (1999) (subseção 3.8.4.2).
Estas equações apresentam uma precisão muito boa, no então, para demostrar a inﬂuência
dos parâmetros do Modelo de Pitzer no cálculo do coeﬁciente de atividade, utilizou-se os
parâmetros de Zemaitis Jr. et al. (1986, p. 103). Os resultados obtidos com estes parãmetros
são mostrados na Figura 58. Nesta, observa-se, que o coeﬁciente de atividade do KCl em
água a 25 ℃, como função da molalidade do KCl, calculado pelo programa JAFOSSMS
(seção 3.13), ajusta-se muito bem aos dados experimentais de Hamer e Wu (1972).

Figura 58 – Modelo de Pitzer implementado (γ

KCl × b
{H2O}
metros de Zemaitis Jr. et al. (1986, p. 103).

{H2O}
KCl

) utilizando os parâ-

Fonte: O autor.

Algumas medidas estatísticas básicas, relativas a Figura 58, para os desvios entre

valores calculados e pontos experimentais, foram geradas:

a) desvio absoluto médio = 0,00052;
b) desvio absoluto máximo = 0,00169;
c) desvio relativo absoluto médio = 0,08%;
d) desvio relativo absoluto máximo = 0,30%.

Os valores baixos destes desvios demostraram uma grande precisão no cálculo do coeﬁciente
de atividade do KCl em água a 25 ℃. Estes resultados conﬁrmam que os parâmetros de
Zemaitis Jr. et al. (1986, p. 103) são melhores que os calculados utilizando as equações de
Archer (1999) (subseção 3.8.4.2). Entretanto, os parâmetros de Zemaitis Jr. et al. (1986,
p. 103) são apenas para 25 ℃, enquanto que as equações de Archer (1999) (subseção 3.8.4.2)
cobrem uma ampla faixa de temperatura.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES
4.4 Comparação do Modelo JAFOSSMS com outros modelos

95

O Modelo JAFOSSMS foi comparado com o Modelo Ideal, extremamente simples,
e com o Modelo UNIQUAC+DH, de maior complexidade, usado em Chiavone-Filho e
Rasmussen (2000).

4.4.1 Modelo Ideal

A molalidade do NaCl na mistura água e MEG foi calculada em função da fração
molar do MEG livre de sal, para 6 isotermas, usando-se tanto o Modelo JAFOSSMS
quanto o Modelo Ideal (Equação 2.38). Estes resultados são apresentados na Figura 59 .

Figura 59 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (NaCl).

Fonte: O autor.

Observa-se, na Figura 59, a excelente representatividade dos dados experimentais
pelo Modelo JAFOSSMS e o afastamento deste em relação ao Modelo Ideal, exceto nos
extremos de fração molar de MEG livre de sal. Na Tabela 26, nota-se os baixos desvios
dos dados experimentais em relação ao Modelo JAFOSSMS e os altos desvios em relação
ao Modelo Ideal. Conﬁrmando a melhor representatividade do Modelo JAFOSSMS.

Tabela 26 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (NaCl).

Desvio

Desvio Absoluto Médio
Desvio Absoluto Máximo
Desvio Relativo Absoluto Médio
Desvio Relativo Absoluto Máximo

Modelo JAFOSSMS
0, 02186 mol · kg−1
0, 12584 mol · kg−1

0,83%
4,27%

Modelo Ideal

0, 58587 mol · kg−1
1, 26178 mol · kg−1

15,79%
34,04%

Fonte: O autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

96

Capítulo 4. RESULTADOS E DISCUSSÕES

A molalidade do KCl na mistura água e MEG foi calculada em função da fração
molar do MEG livre de sal, para 3 isotermas, usando-se tanto o Modelo JAFOSSMS
quanto o Modelo Ideal (Equação 2.38). Estes resultados são apresentados na Figura 60 .

Figura 60 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (KCl).

Fonte: O autor.

Observa-se, na Figura 60, a excelente representatividade dos dados experimentais
pelo Modelo JAFOSSMS e o afastamento deste em relação ao Modelo Ideal, exceto nos
extremos de fração molar de MEG livre de sal. Na Tabela 27, nota-se os baixos desvios dos
dados experimentais em relação ao Modelo JAFOSSMS e os altos desvios em relação ao
Modelo Ideal. Conﬁrmando, novamente, a melhor representatividade do Modelo JAFOSSMS.

Tabela 27 – Comparação do Modelo JAFOSSMS com o Modelo Ideal (KCl).

Desvio

Desvio Absoluto Médio
Desvio Absoluto Máximo
Desvio Relativo Absoluto Médio
Desvio Relativo Absoluto Máximo

Modelo JAFOSSMS
0, 02489 mol · kg−1
0, 10623 mol · kg−1

1,58%
10,94%

Modelo Ideal

0, 45212 mol · kg−1
1, 11111 mol · kg−1

17,22%
37,59%

Fonte: O autor.

4.4.2 Modelo UNIQUAC+DH

Uma comparação quantitativa foi feita entre o Modelo JAFOSSMS e o modelo
utilizado em Chiavone-Filho e Rasmussen (2000), aqui chamado Modelo UNIQUAC+DH.
Os cálculos realizados em Chiavone-Filho e Rasmussen (2000), foram feitos por meio do
programa PARASOLY (CHIAVONE-FILHO, 1993). Para que a comparação fosse possível

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Capítulo 4. RESULTADOS E DISCUSSÕES

97

os valores de solubilidade, obtidos pelo Modelo JAFOSSMS, foram convertidos para
fração molar de KCl em base iônica mediante a Equação 4.7, pois, esta foi usada em
Chiavone-Filho e Rasmussen (2000).

ionizada
MX

x

=

νxMX

1 + (ν − 1) xMX

(4.7)

ionizada
MX

onde x
os dados utilizados nesta comparação

é a fração molar de MX em base ionizada. Na Tabela 28, apresenta-se todos

Tabela 28 – Dados de equilíbrio usados na comparação do Modelo JAFOSSMS

com o Modelo UNIQUAC+DH.

xKCl (Base Não Ionizada)

xKCl (Base Ionizada)

Experimental Modelo JAFOSSMS Experimental Modelo JAFOSSMS Modelo UNIQUAC+DH

0,04182
0,03962
0,04121
0,04778
0,05750
0,06854
0,07971
0,04778
0,04751
0,04935
0,05834
0,07008
0,08266
0,09370
0,05361
0,05410
0,05749
0,06899
0,08239
0,09524
0,10675

0,04208
0,04114
0,04217
0,04866
0,05713
0,06800
0,07939
0,04756
0,04773
0,04886
0,05841
0,07015
0,08265
0,09403
0,05370
0,05299
0,05313
0,06595
0,08154
0,09595
0,10763

0,08028
0,07622
0,07916
0,09120
0,10875
0,12829
0,14765
0,09120
0,09071
0,09406
0,11025
0,13098
0,15270
0,17134
0,10176
0,10265
0,10873
0,12908
0,15224
0,17392
0,19291

0,08076
0,07903
0,08093
0,09280
0,10809
0,12734
0,14710
0,09080
0,09111
0,09317
0,11037
0,13110
0,15268
0,17190
0,10193
0,10065
0,10090
0,12374
0,15078
0,17510
0,19434

0,08021
0,07790
0,07851
0,09058
0,10996
0,13035
0,14757
0,08978
0,08997
0,09278
0,10879
0,13010
0,15103
0,16834
0,10223
0,10409
0,10954
0,12970
0,15338
0,17551
0,19360

T (K)

x0
H2O

298,15
0,00041
298,15
0,17754
298,15
0,36728
298,15
0,64470
298,15
0,81235
298,15
0,92412
298,15
1,00000
323,15
0,00041
323,15
0,17754
323,15
0,36728
323,15
0,64470
323,15
0,81235
323,15
0,92412
323,15
1,00000
348,15
0,00041
348,15
0,17754
348,15
0,36728
348,15
0,64470
348,15
0,81235
348,15
0,92412
348,15
1,00000
Fonte: O autor.

Na Tabela 29, apresenta-se a comparação entre o Modelo JAFOSSMS e o Modelo
UNIQUAC+DH. Observando os resultados, notou-se que, embora o Modelo UNIQUAC+DH
tenha representado melhor os dados experimentais, dentro das incertezas experimentais, os
cálculos resultaram, na realidade, em precisões equivalentes. No entanto, deve-se ressaltar
que o Modelo JAFOSSMS possui, por ser parametrizado, a vantagem de necessitar de
uma menor quantidade de informações para poder-se gerar resultados.

Tabela 29 – Comparação do Modelo JAFOSSMS com o Modelo UNIQUAC+DH.

Desvio

Modelo JAFOSSMS Modelo UNIQUAC+DH

Desvio Absoluto Médio
Desvio Absoluto Máximo
Desvio Relativo Absoluto Médio
Desvio Relativo Absoluto Máximo

0,00146
0,00783
1,34%
7,20%

0,00112
0,00300
0,97%
2,20%

Fonte: O autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

CAPÍTULO 5
CONCLUSÕES

5 CONCLUSÕES

101

Uma metodologia para descrever a solubilidade de sais em mistura de solventes foi
desenvolvida partindo-se do Modelo de Pitzer (Pitzer (1973)), o qual foi estendido para
misturas de solventes pela metodologia adotada por Lorimer (1993). Esta metodologia
mostrou-se bastante adequada na descrição dos sistemas estudados neste trabalho de tese
de doutorado (Tabela 4 e Tabela 5).

Os resultados obtidos, como foi apresentado no Capítulo 4, demonstraram a precisão
da metodologia nos cálculos realizados, dentro das incertezas experimentais, para os sais
KCl e NaCl em misturas com água e MEG.

Modelos e métodos de cálculo para propriedades de sais em misturas de solventes são
escassos. Logo, a metodologia desenvolvida neste trabalho de tese de doutorado contribui
de forma relevante para a área de equilíbrio eletrolítico de sais em misturas de solventes.
A extensão do Modelo de Pitzer para misturas de solventes, proposta neste trabalho
de tese de doutorado, permite que lacunas existentes em bancos de dados experimentais
disponíveis sejam preenchidas.

Além da parte referente ao modelo e metodologia termodinâmicos, foi desenvolvido
um aplicativo (Programa JAFOSSMS), adequado para cálculos de solubilidade de sais
em misturas aquosas contendo MEG, nos modos de correlação e predição. Este aplicativo
possui um código muito ﬂexível (Apêndice D) de fácil implementação e adaptação para
outras condições que se façam necessárias. Embora o desenvolvimento deste aplicativo
tenha sido realizado em Ubuntu® (ubuntu.com), usando a linguagem Python (python.org)
no ambiente Eclipse (eclipse.org), este aplicativo é totalmente portável para Windows®
(windows.microsoft.com) e, também, para Mac OS X® (apple.com), como apresentado no
Apêndice B.

Para trabalhos futuros são feitas as seguintes sugestões:
a) utilização desta metodologia de cálculo em sistemas com os mesmos solventes e

com outras espécies de sal;

b) utilização desta metodologia de cálculo em sistemas com os mesmos solventes e

com mais de um sal;

c) utilização desta metodologia de cálculo em sistemas com outros solventes e sais;
d) estudar outros sais presentes na água de produção do campo de Mexilhão;
e) aplicar o modelo diretamente na modelagem e simulação de processos, como na

unidade de regeneração do MEG.

Referências

103

ABRAMS, D. S.; PRAUSNITZ, J. M. Statistical Thermodynamics of Liquid Mixtures: A
New Expression for the Excess Gibbs Energy of Partly or Completely Miscible Systems.
AIChE Journal, American Institute of Chemical Engineers, v. 21, n. 1, p. 116–128, jan.
1975. ISSN 1547-5905. Disponível em: <http://doi.wiley.com/10.1002/aic.690210115>.
Citado na página 33.
ÅKERLÖF, G. DIELECTRIC CONSTANTS OF SOME ORGANIC SOLVENT-WATER
MIXTURES AT VARIOUS TEMPERATURES. Journal of the American Chemical
Society, ACS Publications, v. 54, n. 11, p. 4125–4139, nov. 1932. Disponível em:
<http://pubs.acs.org/doi/abs/10.1021/ja01350a001>. Citado na página 42.
ANDERKO, A.; WANG, P.; RAFAL, M. Electrolyte solutions: from thermodynamic
and transport property models to the simulation of industrial processes. Fluid Phase
Equilibria, Elsevier Science Publishers B. V., v. 194-197, p. 123–142, mar. 2002. ISSN 0378-
3812. Disponível em: <http://linkinghub.elsevier.com/retrieve/pii/S0378381201006458>.
Citado na página 32.
ANDRADE, A. R. Hidratos no Âmbito da Perfuração: Histórico, Mecanismos
de Inibição e Técnicas para Análises de Hidrato. Monograﬁa (Especialização em
Engenharia de Dutos) — Departamento de Engenharia Mecânica da PUC-Rio, 2009.
Disponível em: <http://www.ppgem.ct.utfpr.edu.br/lacit/publicacoes/monograﬁas/
monograﬁa%20Alex%20R.%20de%20Andrade%20-%20Vers%E3o%20Final.pdf>. Acesso
em: 21 jan. 2015. Citado 3 vezes nas páginas 7, 8 e 9.
APPLE.COM. Apple - OS X Yosemite - Overview. Disponível em: <http:
//www.apple.com/osx/>. Acesso em: 21 jan. 2015. Citado 4 vezes nas páginas 34, 53,
101 e 121.
ARCHER, D. G. Thermodynamic Properties of the KCl + H2O System. Journal of
Physical and Chemical Reference Data, AIP Publishing, v. 28, n. 1, p. 1–17, maio
1999. ISSN 0047-2689. Disponível em: <http://link.aip.org/link/?JPR/28/1/1>. Citado
2 vezes nas páginas 45 e 94.
ASPENTECH.COM. Aspen HYSYS® - AspenTech. Disponível em: <http:
//www.aspentech.com/products/aspen-hysys/>. Acesso em: 21 jan. 2015. Citado 2 vezes
nas páginas 33 e 34.
BALDWIN, W. H.; RARIDON, R. J.; KRAUS, K. A. Properties of Organic-Water
Mixtures. X. Activity Coeﬃcients of Sodium Chloride at Saturation in Water
Mixtures of Polyglycols and Polyglycol Ethers at 50°. The Journal of Physical
Chemistry, ACS Publications, v. 73, n. 10, p. 3417–3420, out. 1969. Disponível em:
<http://pubs.acs.org/doi/abs/10.1021/j100844a045>. Citado 2 vezes nas páginas 28
e 40.
BAPTISTA, J. M. M. Análise da Formação de Hidratos em Atividades de
Perfuração de Campos Petrolíferos. Monograﬁa (Projeto Final de Curso), 2007.
Disponível em: <http://www.ppgem.ct.utfpr.edu.br/lacit/publicacoes/projetos_

104

Referências

ﬁnais/PF%20-%20An%E1lise%20da%20Forma%E7%E3o%20de%20Hidratos%20em%
20atividades%20de%20Perfura%E7%E3o%20de%20Campos%20Petrol%EDferos%
202007.pdf>. Acesso em: 21 jan. 2015. Citado na página 7.
BELCHIOR, M. GOVERNO FEDERAL E O DESENVOLVIMENTO DE SÃO PAULO.
In: 57º Congresso de Municípios Paulistas. Santos, SP, BRA: [s.n.], 2013. Disponível
em: <http://www.pac.gov.br/sobre-o-pac/apresentacoes/v/38e11f18>. Acesso em: 21 jan.
2015. Citado na página 4.
BIPM. Le Système international d’unités (SI) = The International System
of Units (SI). 8th. ed. Sèvres, FRA: [s.n.], 2006. ISBN 92-822-2213-6. Disponível em:
<http://www.bipm.org/utils/common/pdf/si_brochure_8.pdf>. Citado na página 41.
BRAUN, N. O.; PERSSON, U. Å.; KARLSSON, H. T. Densities and Viscosities of
Mono(ethylene glycol) + 2-Amino-2-methyl-1-propanol + Water. Journal of Chemical
& Engineering Data, ACS Publications, v. 46, n. 4, p. 805–808, maio 2001. ISSN
0021-9568. Disponível em: <http://pubs.acs.org/doi/abs/10.1021/je010004z>. Citado na
página 28.
CAMERON. PureMEG - MEG reclamation and regeneration technology. 2012.
Disponível em: <http://www.c-a-m.com/~/media/1999835b6dfc462ead163ea4464a080f.
ashx>. Acesso em: 21 jan. 2015. Citado 2 vezes nas páginas 14 e 15.
CARDOSO, M. J. E. M. Calculation of Phase and Chemical Equilibria in
Eletrolyte Sistems. Tese (Doutorado) — Department of Chemical Engineering.
Technical University of Denmark; DK-2800 Lyngby, Denmark, 1988. Citado na página 32.
CHEN, C.-C. et al. Local Composition Model for Excess Gibbs Energy of Electrolyte
Systems. Part I: Single Solvent, Single Completely Dissociated Electrolyte Systems.
AIChE Journal, American Institute of Chemical Engineers, v. 28, n. 4, p. 588–596, jul.
1982. ISSN 1547-5905. Disponível em: <http://doi.wiley.com/10.1002/aic.690280410>.
Citado na página 44.
CHEN, C.-C.; SONG, Y. Generalized Electrolyte-NRTL Model for Mixed-
Solvent Electrolyte Systems. AIChE Journal, American Institute of Chemical
Engineers, v. 50, n. 8, p. 1928–1941, ago. 2004. ISSN 1547-5905. Disponível em:
<http://doi.wiley.com/10.1002/aic.10151>. Citado na página 32.
CHIAVONE-FILHO, O. Phase Behavior of Aqueous Glycol Ether Mixtures: (1)
Vapor-Liquid Equilibria (2) Salt Solubility. Tese (Doutorado) — Department of
Chemical Engineering. Technical University of Denmark; DK-2800 Lyngby, Denmark,
1993. Citado 2 vezes nas páginas 32 e 96.
CHIAVONE-FILHO, O.; PROUST, P.; RASMUSSEN, P. Vapor-Liquid Equilibria
for Glycol Ether + Water Systems. Journal of Chemical & Engineering Data,
ACS Publications, v. 38, n. 1, p. 128–131, jan. 1993. ISSN 0021-9568. Disponível em:
<http://pubs.acs.org/doi/abs/10.1021/je00009a031>. Citado na página 29.
CHIAVONE-FILHO, O.; RASMUSSEN, P. Solubilities of Salts in Mixed Solvents. Journal
of Chemical & Engineering Data, ACS Publications, v. 38, n. 3, p. 367–369, jul. 1993.
ISSN 0021-9568. Disponível em: <http://pubs.acs.org/doi/abs/10.1021/je00011a009>.
Citado 2 vezes nas páginas 28 e 40.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Referências

105

. Modeling of salt solubilities in mixed solvents. Brazilian Journal of Chemical
Engineering, Brazilian Society of Chemical Engineering, v. 17, p. 117–131, jun. 2000.
ISSN 0104-6632. Disponível em: <http://dx.doi.org/10.1590/S0104-66322000000200001>.
Citado 4 vezes nas páginas 33, 95, 96 e 97.

CLARKE, E. C. W.; GLEW, D. N. Evaluation of Thermodynamic Functions from
Equilibrium Constants. Transactions of the Faraday Society, RSC Pub, v. 62, p.
539–547, 1966. Disponível em: <http://dx.doi.org/10.1039/TF9666200539>. Citado na
página 47.
COHEN, E. R. et al. (Ed.). Quantities, Units and Symbols in Physical Chemistry.
3rd. ed. Cambridge, GBR: RSC Pub, 2007. ISBN 978-0-85404-433-7. Disponível em:
<http://amazon.com/o/ASIN/0854044337/>. Citado na página 19.

DAHL, S.; MACEDO, E. A. The MHV2 Model: A UNIFAC-Based Equation
of State Model for Vapor-Liquid and Liquid-Liquid Equilibria of Mixtures with
Strong Electrolytes. Industrial & Engineering Chemistry Research, ACS
Publications, v. 31, n. 4, p. 1195–1201, abr. 1992. ISSN 0888-5885. Disponível em:
<http://pubs.acs.org/doi/abs/10.1021/ie00004a033>. Citado na página 32.

DEBYE, P.; HÜCKEL, E. The theory of electrolytes. I. Lowering of freezing point and
related phenomena. Physikalische Zeitschrift, S. Hirzel Verlag, v. 24, n. 9, p. 185–206,
maio 1923. Citado 2 vezes nas páginas 23 e 24.
ECLIPSE.ORG. Eclipse - The Eclipse Foundation open source community
website. Disponível em: <http://eclipse.org/home/index.php>. Acesso em: 21 jan. 2015.
Citado 3 vezes nas páginas 34, 53 e 101.

FIGUEIREDO, C. S. et al. Salt solubility data for sodium chloride and mono ethylene
glycol aqueous systems from 293.15 to 403.15 K. Fluid Phase Equilibria, Elsevier
Science Publishers B. V., 2014 (em Publicação). ISSN 0378-3812. Citado 2 vezes nas
páginas 28 e 40.

FØSBOL, P. L.; THOMSEN, K.; STENBY, E. H. Modeling of the Mixed Solvent
Electrolyte System CO2-Na2CO3-NaHCO3-Monoethylene Glycol-Water. Industrial &
Engineering Chemistry Research, ACS Publications, v. 48, n. 9, p. 4565–4578, maio
2009. ISSN 0888-5885. Disponível em: <http://pubs.acs.org/doi/abs/10.1021/ie801168e>.
Citado na página 32.
GALANTE, A. Jaqueta da plataforma de Mexilhão segue para a Bacia de
Campos - Poder Naval. 2009. Disponível em: <http://www.naval.com.br/blog/2009/
11/23/jaqueta-da-plataforma-de-mexilhao-segue-para-a-bacia-de-campos/>. Acesso em:
21 jan. 2015. Citado na página 4.
GCC.GNU.ORG/C++. GCC, the GNU Compiler Collection- GNU Project -
Free Software Foundation (FSF). Disponível em: <https://gcc.gnu.org/>. Acesso
em: 21 jan. 2015. Citado na página 33.
GCC.GNU.ORG/FORTRAN. GNU Fortran- GNU Project - Free Software
Foundation (FSF). Disponível em: <https://gcc.gnu.org/fortran/>. Acesso em: 21 jan.
2015. Citado na página 33.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

106

Referências

GREEN, D. W.; PERRY, R. H. Perry’s Chemical Engineers’ Handbook, Eighth
Edition. 8th. ed. New York, NY, USA: McGraw-Hill, 2007. ISBN 978-0-07-142294-9.
Disponível em: <http://amazon.com/o/ASIN/0071422943/>. Citado na página 42.
GRENTHE, I.; PLYASUNOV, A. On the use of semiempirical electrolyte theories for
modeling of solution chemical data. Pure and Applied Chemistry, International
Union of Pure and Applied Chemistry, v. 69, n. 5, p. 951–958, jul. 1997. ISSN 0033-4545.
Disponível em: <http://iupac.org/publications/pac/69/5/0951/>. Citado na página 32.
GUGGENHEIM, E. L. The speciﬁc thermodynamic properties of aqueous solutions
of strong electrolytes. Philosophical Magazine Series 7, Taylor & Francis, v. 19,
n. 127, p. 588–643, 1935. Disponível em: <http://www.tandfonline.com/doi/abs/10.1080/
14786443508561403>. Citado na página 24.
HAMER, W. J.; WU, Y.-C. Osmotic Coeﬃcients and Mean Activity Coeﬃcients of
Uni-univalent Electrolytes in Water at 25 °C. Journal of Physical and Chemical
Reference Data, AIP Publishing, v. 1, n. 4, p. 1047–1100, out. 1972. ISSN 0047-2689.
Disponível em: <http://link.aip.org/link/?JPR/1/1047/1>. Citado 3 vezes nas páginas
92, 93 e 94.
ILIUTA, M. C.; THOMSEN, K.; RASMUSSEN, P. Extended UNIQUAC model
for correlation and prediction of vapour-liquid-solid equilibria in aqueous salt
systems containing non-electrolytes. Part A. Methanol-water-salt systems. Chemical
Engineering Science, Elsevier Science Publishers B. V., v. 55, n. 14, p. 2673–2686, abr.
2000. ISSN 0009-2509. Disponível em: <http://linkinghub.elsevier.com/retrieve/pii/
S0009250999005345>. Citado na página 32.
ISBIN, H. S.; KOBE, K. A. The Solubility of Some Salts in Ethylenediamine,
Monoethanolamine and Ethylene Glycol1. Journal of the American Chemical
Society, ACS Publications, v. 67, n. 3, p. 464–465, mar. 1945. ISSN 0002-7863. Disponível
em: <http://pubs.acs.org/doi/abs/10.1021/ja01219a029>. Citado 2 vezes nas páginas 28
e 40.
JOUYBAN, A.; SOLTANPOUR, S.; CHAN, H.-K. A simple relationship between
dielectric constant of mixed solvents with solvent composition and temperature.
International Journal of Pharmaceutics, Elsevier Science Publishers B. V.,
v. 269, n. 2, p. 353–360, jan. 2004. ISSN 0378-5173. Disponível em: <http:
//linkinghub.elsevier.com/retrieve/pii/S0378517303005118>. Citado na página 42.
KONTOGEORGIS, G. M.; FOLAS, G. K. Thermodynamic Models for Industrial
Applications: From Classical and Advanced Mixing Rules to Association
Theories. Chichester, GBR: Wiley, 2010. ISBN 978-0-470-69726-9. Disponível em:
<http://amazon.com/o/ASIN/0470697261/>. Citado na página 22.
KOSINSKI, J. J. et al. Modeling acid-base equilibria and phase behavior in
mixed-solvent electrolyte systems. Fluid Phase Equilibria, Elsevier Science
Publishers B. V., v. 256, n. 1-2, p. 34–41, ago. 2007. ISSN 0378-3812. Disponível em:
<http://linkinghub.elsevier.com/retrieve/pii/S0378381206004973>. Citado na página 32.
KRAUS, K. A.; RARIDON, R. J.; BALDWIN, W. H. Properties of Organic-Water
Mixtures. I. Activity Coeﬃcients of Sodium Chloride, Potassium Chloride, and Barium
Nitrate in Saturated Water Mixtures of Glycol, Glycerol, and Their Acetates. Model

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Referências

107

Solutions for Hyperﬁltration Membranes. Journal of the American Chemical
Society, ACS Publications, v. 86, n. 13, p. 2571–2576, jul. 1964. ISSN 0022-3654.
Disponível em: <http://pubs.acs.org/doi/abs/10.1021/ja01067a010>. Citado 3 vezes nas
páginas 28, 40 e 65.

LEE, L. L. A molecular theory of Setchenov’s salting-out principle and applications
in mixed-solvent electrolyte solutions. Fluid Phase Equilibria, Elsevier Science
Publishers B. V., v. 131, n. 1-2, p. 67–82, maio 1997. ISSN 0378-3812. Disponível em:
<http://linkinghub.elsevier.com/retrieve/pii/S0378381296031986>. Citado na página 30.
LIDE, D. R. (Ed.). CRC Handbook of Chemistry and Physics, 90th Edition (CRC
Handbook of Chemistry & Physics). 90. ed. Boca Raton, FL, USA: CRC Press, 2009.
ISBN 978-1-4200-9084-0. Disponível em: <http://amazon.com/o/ASIN/1420090844/>.
Citado 4 vezes nas páginas 9, 27, 40 e 48.
LINKE, W. F.; SEIDELL, A. SOLUBILITIEWS INORGANIC AND METAL-
ORGANIC COMPOUNDS A - Ir: A Compilation of Solubility Data from
the Periodical Literature, VOLUME I, FOURTH EDITION. 4th. ed. Princeton,
NJ, USA: Van Nostrand, 1958. Citado na página 27.

. SOLUBILITIEWS INORGANIC AND METAL-ORGANIC

COMPOUNDS K - Z: A Compilation of Solubility Data from the Periodical
Literature, VOLUME II, FOURTH EDITION. 4th. ed. Washington, DC, USA:
American Chemical Society, 1965. Citado 2 vezes nas páginas 27 e 40.

LIU, Y.; WATANASIRI, S. Representation of Liquid-Liquid Equilibrium of Mixed-Solvent
Electrolyte Systems Using the Extended Electrolyte NRTL Model. Fluid Phase
Equilibria, Elsevier Science Publishers B. V., v. 116, n. 1-2, p. 193–200, mar.
1996. ISSN 0378-3812. Disponível em: <http://linkinghub.elsevier.com/retrieve/pii/
0378381295028870>. Citado na página 32.

LORIMER, J. W. Thermodynamics of solubility in mixed solvent systems.
Pure and Applied Chemistry, International Union of Pure and Applied
Chemistry, v. 65, n. 2, p. 183–191, jul. 1993. ISSN 0033-4545. Disponível em:
<http://iupac.org/publications/pac/65/2/0183/>. Citado 9 vezes nas páginas xvi, 29,
31, 32, 33, 43, 46, 47 e 101.
MARCUS, Y. Ion Solvation. Chichester, GBR: Wiley, 1985. ISBN 978-0-471-90756-5.
Disponível em: <http://amazon.com/o/ASIN/0471907561/>. Citado na página 48.
MATHWORKS.COM/MATLAB. MATLAB - The Language of Technical
Computing - B. Disponível em: <http://www.mathworks.com/products/matlab/>.
Acesso em: 21 jan. 2015. Citado na página 34.
MATHWORKS.COM/SIMULINK. Simulink - Simulation and Model-Based
Design. Disponível em: <http://www.mathworks.com/products/simulink/>. Acesso em:
21 jan. 2015. Citado na página 34.
MATPLOTLIB.ORG. matplotlib: python plotting - Matplotlib 1.4.2
documentation. Disponível em: <http://matplotlib.org/>. Acesso em: 21 jan. 2015.
Citado 2 vezes nas páginas 34 e 53.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

108

Referências

MOURA, N. R. d. Desaﬁos Tecnológicos para o Gás Natural. 2007. Disponível
em: <http://sites.petrobras.com.br/minisite/premiotecnologia/pdf/TecnologiaGas_
DesaﬁosTecnologicos-GasNatural.pdf>. Acesso em: 21 jan. 2015. Citado na página 6.
NAUMANN, M. P. Oportunidades na Logística de Exploração de Petróleo,
Gás e Biocombustíveis. In: 9º Encontro da Arquitetura e da Engenharia
Consultiva de São Paulo. Santos, SP, BRA: [s.n.], 2009. Disponível em:
<http://www.sinaenco.com.br/downloads/Petrobras.pdf>. Acesso em: 21 jan. 2015.
Citado na página 4.
NAZZER, C.; KEOGH, J. Advances in Glycol Reclamation Technology. In: Oﬀshore
Technology Conference. Houston, TX, USA: [s.n.], 2006. ISBN 978-1-55563-253-3.
Disponível em: <http://dx.doi.org/10.4043/18010-MS>. Citado 4 vezes nas páginas 10,
11, 12 e 13.
NICOLAISEN, H. Phase equilibria in aqueous electrolyte solutions. Tese
(Doutorado) — Department of Chemical Engineering. Technical University of Denmark;
DK-2800 Lyngby, Denmark, 1994. Citado na página 32.
NUMPY.ORG. NumPy - NumPy. Disponível em: <http://www.numpy.org/>. Acesso
em: 21 jan. 2015. Citado 2 vezes nas páginas 34 e 53.
OLIVEIRA, J. A. F. et al. Levenberg-Marquardt method applied to the determination
of vapor-liquid equilibrium model parameters. Latin American Applied
Research, v. 44, n. 4, out. 2014. ISSN 0327-0793. Disponível em: <http:
//www.laar.uns.edu.ar/indexes/i44_04.htm>. Citado 2 vezes nas páginas 39 e 115.

. Modelagem e Simulação da Solubilidade de Sais em Mistura de Solventes em
Sistemas Aquosos com dois Sais Fortes e Monoetileno Glicol. In: XVIII COBEQ/V
CBTERMO/EBA. Foz do Iguaçu, PR, BRA: [s.n.], 2010. Citado na página 30.
PETROBRAS. Atividade de Produção de Gás e Condensado no Campo
de Mexilhão, Bacia de Santos : EIA – Estudo de Impacto Ambiental.
2007. Disponível em: <http://licenciamento.ibama.gov.br/Petroleo/Sistema%20de%
20Producao%20de%20Gas%20Natural%20e%20Condensados%20-%20Campo%20de%
20Mexilhao%20-%20Bacia%20de%20Santos/EIA%20Mexilh%C3%A3o/>. Acesso em: 21
jan. 2015. Citado 3 vezes nas páginas 3, 5 e 39.
PINHO, S. P.; MACEDO, E. A. REPRESENTATION OF SALT SOLUBILITY IN
MIXED SOLVENTS: A COMPARATION OF THERMODYNAMIC MODELS. Fluid
Phase Equilibria, Elsevier Science Publishers B. V., v. 116, n. 1-2, p. 209–216, mar.
1996. ISSN 0378-3812. Disponível em: <http://linkinghub.elsevier.com/retrieve/pii/
0378381295028897>. Citado 2 vezes nas páginas 28 e 32.

. Solubility of NaCl, NaBr, and KCl in Water, Methanol, Ethanol, and
Their Mixed Solvents. Journal of Chemical & Engineering Data, ACS
Publications, v. 50, n. 1, p. 29–32, jan. 2005. ISSN 0021-9568. Disponível em:
<http://pubs.acs.org/doi/abs/10.1021/je049922y>. Citado na página 28.
PITZER, K. S. Thermodynamics of Electrolytes. I. Theoretical Basis and
General Equations. The Journal of Physical Chemistry, ACS Publications,
v. 77, n. 2, p. 268–277, jan. 1973. ISSN 0022-3654. Disponível em: <http:

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Referências

109

//pubs.acs.org/doi/abs/10.1021/j100621a026>. Citado 4 vezes nas páginas 33, 43, 48
e 101.

. Thermodynamics (Mcgraw Hill Series in Advanced Chemistry). 3rd.

ed. New York, NY, USA: McGraw-Hill, 1995. ISBN 978-0-07-050221-5. Disponível em:
<http://amazon.com/o/ASIN/0070502218/>. Citado na página 33.
PRAUSNITZ, J. M.; LICHTENTHALER, R. N.; AZEVEDO, E. G. d. Molecular
Thermodynamics of Fluid-Phase Equilibria (3rd Edition). 3rd. ed. Upper Saddle
River, NJ, USA: Prentice Hall PTR, 1999. ISBN 978-0-13-977745-5. Disponível em:
<http://amazon.com/o/ASIN/0139777458/>. Citado 7 vezes nas páginas 21, 22, 24, 25,
26, 33 e 48.
PYTHON.ORG. Welcome to Python.org. Disponível em: <https://www.python.org/>.
Acesso em: 21 jan. 2015. Citado 3 vezes nas páginas 34, 53 e 101.
QT-PROJECT.ORG. Category:LanguageBindings -> PySide | Qt Wiki | Qt
Project. Disponível em: <http://qt-project.org/wiki/PySide>. Acesso em: 21 jan. 2015.
Citado 2 vezes nas páginas 34 e 53.

RENON, H. Models for excess properties of electrolyte solutions: molecular bases and
classiﬁcation, needs and trends for new developments. Fluid Phase Equilibria, Elsevier
Science Publishers B. V., v. 116, n. 1-2, p. 217–224, mar. 1996. ISSN 0378-3812. Disponível
em: <http://linkinghub.elsevier.com/retrieve/pii/0378381295028900>. Citado na página
32.
ROGUEWAVE.COM. IMSL Numerical Libraries | Rogue Wave. Disponível em:
<http://www.roguewave.com/products-services/imsl-numerical-libraries>. Acesso em: 21
jan. 2015. Citado na página 33.

SANDENGEN, K.; KAASA, B. Estimation of Monoethylene Glycol (MEG) Content in
Water + MEG + NaCl + NaHCO3 Solutions. Journal of Chemical & Engineering
Data, ACS Publications, v. 51, n. 2, p. 443–447, mar. 2006. ISSN 0021-9568. Disponível
em: <http://pubs.acs.org/doi/abs/10.1021/je0503711>. Citado na página 28.
SANDLER, S. I. Models for Thermodynamic and Phase Equilibria Calculations
(Chemical Industries). New York, NY, USA: Marcell Dekker, 1993. ISBN 978-0-8247-
9130-8. Disponível em: <http://amazon.com/o/ASIN/0824791304/>. Citado na página
33.
SCILAB.ORG. Home - Scilab. Disponível em: <http://www.scilab.org/>. Acesso em:
21 jan. 2015. Citado na página 34.
SCIPY.ORG. SciPy - SciPy. Disponível em: <http://www.scipy.org/>. Acesso em: 21
jan. 2015. Citado 2 vezes nas páginas 34 e 53.

SILVESTER, L. F.; PITZER, K. S. Thermodynamics of Electrolytes. 8. High-
Temperature Properties, Including Enthalpy and Heat Capacity, with Application
to Sodium Chloride. The Journal of Physical Chemistry, ACS Publications,
v. 81, n. 19, p. 1822–1828, set. 1977. ISSN 0022-3654. Disponível em: <http:
//pubs.acs.org/doi/abs/10.1021/j100534a007>. Citado na página 45.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

110

Referências

SMITH, J. M.; VAN NESS, H.; ABBOTT, M. Introduction to Chemical Engineering
Thermodynamics (The Mcgraw-Hill Chemical Engineering Series). 7th. ed.
Boston, MA, USA: McGraw-Hill, 2005. ISBN 978-0-07-310445-4. Disponível em:
<http://amazon.com/o/ASIN/0073104450/>. Citado na página 33.
STATOIL. Gas Hydrates as a resource : Technology Readiness Level. 2011.
Disponível em: <http://nﬁpweb.org/oneday2011/Gas%20hydrates,%20Technology%
20Readiness%20Level.pdf>. Acesso em: 21 jan. 2015. Citado na página 7.
THOMPSON, A.; TAYLOR, B. N. Guide for the Use of the International System
of Units (SI). NIST Special Publication 811 (2008 Edition). Gaithersburg, MD,
USA, 2008. Disponível em: <http://physics.nist.gov/cuu/pdf/sp811.pdf>. Citado na
página 19.
THOMSEN, K. Aqueous electrolytes: model parameters and process simulation.
Tese (Doutorado) — Department of Chemical Engineering. Technical University of
Denmark; DK-2800 Lyngby, Denmark, 1997. Citado na página 32.
THOMSEN, K.; ILIUTA, M. C.; RASMUSSEN, P. Extended UNIQUAC model
for correlation and prediction of vapor-liquid-liquid-solid equilibria in aqueous
salt systems containing non-electrolytes. Part B. Alcohol (ethanol, propanols,
butanols)-water-salt systems. Chemical Engineering Science, Elsevier Science
Publishers B. V., v. 59, n. 17, p. 3631–3647, set. 2004. ISSN 0009-2509. Disponível em:
<http://linkinghub.elsevier.com/retrieve/pii/S000925090400329X>. Citado na página 32.
TRIMBLE, H. M. Solubilities of Salts in Ethylene Glycol and in Its Mixtures with Water.
Industrial & Engineering Chemistry, ACS Publications, v. 23, n. 2, p. 165–167,
fev. 1931. ISSN 0019-7866. Disponível em: <http://pubs.acs.org/doi/abs/10.1021/
ie50254a016>. Citado 2 vezes nas páginas 28 e 40.
TSIERKEZOS, N. G.; MOLINOU, I. E. Thermodynamic Properties of Water + Ethylene
Glycol at 283.15, 293.15, 303.15, and 313.15 K. Journal of Chemical & Engineering
Data, ACS Publications, v. 43, n. 6, p. 989–993, nov. 1998. ISSN 0021-9568. Disponível
em: <http://pubs.acs.org/doi/abs/10.1021/je9800914>. Citado na página 28.
UBUNTU.COM. The leading OS for PC, tablet, phone and cloud | Ubuntu.
Disponível em: <http://www.ubuntu.com/>. Acesso em: 21 jan. 2015. Citado 4 vezes
nas páginas 34, 53, 101 e 121.
WALAS, S. M. Phase Equilibria in Chemical Engineering. Boston, MA, USA:
Butterworth, 1985. ISBN 978-0-409-95162-2. Disponível em: <http://amazon.com/o/
ASIN/0409951625/>. Citado na página 33.
WANG, P. et al. Modeling phase equilibria and speciation in mixed-solvent
electrolyte systems: II. Liquid-liquid equilibria and properties of associating
electrolyte solutions. Journal of Molecular Liquids, Elsevier Science Publishers
B. V., v. 125, n. 1, p. 37–44, mar. 2006. ISSN 0167-7322. Disponível em:
<http://linkinghub.elsevier.com/retrieve/pii/S0167732205002060>. Citado na página 32.
WANG, P.; ANDERKO, A.; YOUNG, R. D. A speciation-based model for mixed-
solvent electrolyte systems. Fluid Phase Equilibria, Elsevier Science Publishers
B. V., v. 203, n. 1-2, p. 141–176, dez. 2002. ISSN 0378-3812. Disponível em:
<http://linkinghub.elsevier.com/retrieve/pii/S0378381202001784>. Citado na página 32.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

Referências

111

WINDOWS.MICROSOFT.COM. Windows - Microsoft Windows. Disponível em:
<http://windows.microsoft.com>. Acesso em: 21 jan. 2015. Citado 4 vezes nas páginas
34, 53, 101 e 121.
ZEMAITIS JR., J. F. et al. Handbook of Aqueous Electrolyte Thermodynamics:
Theory & Application. New York, NY, USA: Wiley-AIChE, 1986. ISBN 978-0-8169-
0350-4. Disponível em: <http://amazon.com/o/ASIN/0816903506/>. Citado 4 vezes nas
páginas xxi, 31, 33 e 94.
ZHOU, Y. et al. Compositions, Densities, and Refractive Indices for the Ternary Systems
Ethylene Glycol + NaCl + H2O, Ethylene Glycol + KCl + H2O, Ethylene Glycol + RbCl
+ H2O, and Ethylene Glycol + CsCl + H2O at 298.15 K. Journal of Chemical &
Engineering Data, ACS Publications, v. 55, n. 3, p. 1289–1294, 2010. Disponível em:
<http://pubs.acs.org/doi/abs/10.1021/je900630n>. Citado 4 vezes nas páginas 28, 40,
83 e 86.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

APÊNDICES

APÊNDICE A – Artigo sobre ELV

115

Este apêndice reproduz o artigo publicado no periódico: Latin American Applied
Research, sobre regressão de dados de ELV (OLIVEIRA et al., 2014). O programa usado
neste artigo, VLE Regression, encontra-se no Apêndice C. Segue o artigo:

LEVENBERG-MARQUARDT METHOD APPLIED TO THE DETERMINATION OF VAPOR-LIQUID EQUILIBRIUM MODEL PARAMETERS  J.A.F. OLIVEIRA†, M.M.L. DUARTE†, E.L. FOLETTO‡,*   and    O. CHIAVONE-FILHO† † Chemical Eng. Department, Federal University of Rio Grande do Norte, Natal, 59066-800, Brazil ‡ Chemical Eng. Department, Federal University of Santa Maria, Santa Maria, 97105-900, Brazil.  * efoletto@gmail.com  Abstract− In order to correlate and optimize ex-perimental data either from the laboratory or indus-try, one needs a robust method of data regression. Among the non-linear parameter estimation meth-ods it may be pointed out of Levenberg, which ap-plies the conversion of an arbitrary matrix into a positive definite one. Later, Marquardt applied the same procedure, calculating λ parameter in an it-erative form. The Levenberg-Marquardt algorithm is described and two routine for correlating vapor-liquid equilibrium data for pure component and mixtures, based on this efficient method, have been applied. The routines have been written with an in-terface very accessible for both users and program-mers, using Python language. The flexibility of the developed programs for introducing the desired de-tails is quite interesting for both process simulators and modeling properties. Furthermore, for mixtures with electrolytes, it was obtained a coherent and compatible relation for the structural parameters of the salt species, with the aid of the method and the graphical interface designed. Keywords− Nonlinear Regression, Levemberg-Marquardt Method, Vapor-Liquid Equilibria, Mixed Solvents Electrolyte Systems. I. INTRODUCTION The phenomena and properties involved in the chemical processes present, usually, non-linear behavior. There-fore, it is needed a robust method of non-linear regres-sion for providing the required correlation of the ex-perimental data collected, either from the laboratory or from the industry.  Bard (1974) pointed out three methods of parameter estimation, i.e., least squares, maximum likelihood and Bayesian. The method of least squares is the oldest and most widely used estimation procedure. It can be ap-plied directly to a deterministic model, without any knowledge being taken of the probability distribution of the observations. This feature satisfies quite well the propose of correlating most of the desired thermody-namic properties and process variables.  For solving these unconstrained problems, the Levenberg-Marquardt method has proven very reliable results. In this work the Levenberg-Marquardt algoritm is described in a simple form.  This parameter estimation method has been repro-duced and applied for the correlation of vapor-liquid equilibrium (VLE) data using activity coefficient and equation of state approaches (Lazzús, 2010; Camacho-Camacho et al., 2007). For the first case, an evaluation of the thermodynamic consistency of the data can be provided, since activity coefficient models fulfill the ex-act definition of partial molar excess Gibbs energy.  Systematic evaluation of thermodynamic properties of solutions of sodium chloride (NaCl) in water, e.g., boiling point and osmotic coefficient, with an extensive experimental database, was provided by Clarke and Glew (1985). VLE calculation for mixed solvents elec-trolyte systems have been applied using functional group activity coefficient model, i.e., UNIFAC (Kikic et al., 1991). It was taken into account the electrostatic term with Debye-Huckel term, normalized according to the theory of Mc-Millan-Mayer. However, the estimated parameters present scattering and large order of magni-tude. Loehe and Donohue (1997) described a survey of the literature models to determine thermodynamic prop-erties of aqueous systems with strong electrolytes. Thomsen et al. (2004) have presented a systematic modeling work with mixed electrolytes and mixed sol-vents systems for solid-liquid-vapor equilibrium data, using UNIQUAC also. Haghtalab and Peyvandi (2009) have proposed a new version of UNIQUAC model for electrolyte solutions that requires just two fitted interac-tion parameters per binary aqueous system. The struc-tural parameters of the ionic species were evaluated considering solvation for the determination of the radii.   This study aimed to describe the Levenberg-Marquardt computational procedure for estimation of vapor-liquid equilibrium model parameters. Validations of the method are present for pure component vapor pressure and binary VLE data. Application to strong electrolytes in mixed solvents systems has also been performed, using UNIQUAC model. It is proposed a new form to determine structural UNIQUAC parameters of the ions that is compatible with the solvent species parameters. II. METHODS A. Levenberg-Marquardt Method The method presented by Levenberg (1944) utilizes a conversion of an arbitrary matrix into a positive definite one. This method rests on the observation that if P is any positive definite matrix, then Ai + λP is positive definite for λ sufficiently large, no matter what Ai. Marquardt (1963) suggested an iterative algorithm for the selection of λ.  The importance of working with a definite positive matrix is to satisfy the necessary and sufficient condi-tions of minimization in the data regression, where the least square of the residuals (ei) is to be found. 116

APÊNDICE A. Artigo sobre ELV

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

B. Levenberg-Marquardt Algorithm In this section the Levenberg-Marquardt algorithm ap-plied for a nonlinear parameter estimation is described in four phases. Initialization: (i) Enter minρ (a minimum value of the step length ρ, e.g. 10-7), ε (a positive small number, e.g. 10-7), y (vector of the dependent variables), X (matrix of the independent variables) and 1θ (vector of the initial guess of the parameters to be estimated). Set 1=J and 01.0=λ (Marquardt parameter); (ii) Calculate e (vector of the residuals) and ()11θΦ=Φ (objective function), where ()θ−=,Xfyeiii and ∑=Φiie2; (iii) Calculate q (gradient of Φ) and A (approxima-tion of the Hessian matrix of the function Φ), where ∑∂θ∂=∂θΦ∂=jijjiieeq21 and ∑⎟⎟⎠⎞⎜⎜⎝⎛∂θ∂⎟⎟⎠⎞⎜⎜⎝⎛∂θ∂=kjkikijeeA2; (iv) Calculate ⎪⎩⎪⎨⎧=⇒≠==⇒===⇒≠ijijijijijijAPAjiPAjiPjiP0,10,0 (v) Calculate PAλ+, reminding that these values may be directly evaluated by: ()⎪⎩⎪⎨⎧λ+=λ+⇒≠=λ=λ+⇒===λ+⇒≠λ+10,0,ijijijijijijijijijijijijAPAAjiPAAjiAPAjiPA (vi) Calculate ()qPA1−λ+−=ν (vector in the direc-tion of the proposed step), ν+θ=θ1)1( and ())1()1(θΦ=Φ, where ()1−λ+PA and ν are evaluated by the Cholesky method, see, e.g., Fox (1964), which is specific for the inversion of a definite positive matrix; (vii) If 1)1(Φ<Φ accept )1(2θ=θ, replace λ by max(0.1λ,ε) and go to the step (xxi). Or else, continue from the step (viii); (viii) ComputeJ−=ρ2)1(, ()νρ+θΦ=Ψ)1(1)1( and ν=γTq. With these values ()[])1()1(2)1(*2Ψ−Φ+γργρ=ρ is calculated; (ix) If 1)1(Φ<Ψ, then continue from the step (x). Else, go to the step (xvi); Extrapolation of ρ: (x) Set J equal to the higher integer number that do not overcome the half of J; (xi) If 0*≤ρ set J−=ρ1*2; (xii) If )1(*1.1ρ>ρ continue on the step (xiii). Else, set )1(ρ=ρ and go to the step (xx);  (xiii) Compute ()νρ+θΦ=Ψ*1)2( (xiv) If )1()2(Ψ<Ψ continue on the step (xv). Else, set )1(ρ=ρ and go to the step (xx); (xv) Set *ρ=ρ and go to the step (xx); Interpolation of ρ: (xvi) Set ()[]*)1()1(;75.0min;25.0maxρρρ=ρ; (xvii) If minρ≤ρ go to the step (xx). Else, continue on the step (xviii);  (xviii) Compute ()νρ+θΦ=Ψ1)2( and set 1+=JJ; (xix) If 1)2(Φ<Ψ go to the step (xx). Else, set ρ=ρ)1( and ())2()1(2)1(*2Ψ−Φ+γργρ=ρ, and return to the step (xvi);  (xx) Calculate νρ+θ=θ12; Termination: (xxi) The criterion of termination is tested, using 1θ and 2θ, as an example suggested by Marquardt (1963), is given according to the following equa-tion: ljjjiji,...,2,1...,,1=ε≤θ−θ+  where ()3,41010−−+θ=εjij.  If the criterion is satisfied for all parameters, itera-tions are terminated and 2θ is accepted as the so-lution *θ. Otherwise, set λ=λ10 and 21θ=θ, and return to the step (ii). C. Vapor-Liquid Equilibrium Data Regression In order to demonstrate the applicability of the imple-mented Levenberg-Marquardt method, two programs for correlating vapor-liquid equilibrium data have been developed. Antoine Constants Estimation The first program allows data correlation of vapor pres-sure and temperature for pure components, using the Antoine equation. In Eq. (1) we have that Psat is the va-por pressure, T is the saturation temperature, and A, B and C are the adjusted Antoine constants. This form of the Antoine equation is usual in the literature; however the user may, easily, apply a modified version of the correlation both in terms of the logarithm base and units.  ()()CTBAP+−=CºmmHglogsat10 (1)  To perform the data regression, the following objec-tive function (OF) is to be minimized, which is the de-fined by the absolute residual in terms of vapor pres-sure.  ()2calcdexptlMIN∑−==iPPOF (2) The program requires initial guesses of A, B and C pa-APÊNDICE A. Artigo sobre ELV

117

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

rameters to be estimated, name of the substance, number of data points and list of the experimental pairs of vapor pressure and saturation temperature. Indication of the units and the literature source from which the data has been retrieved is also requested. An output is provided where information about the iterations performed during the execution is registered, allowing the detection and identification of an eventual error. After convergence, the values of the estimated constants are displayed to-gether with respective interval confidences, standard deviations and correlation matrix of the parameters. The program also provides the relative and absolute devia-tions in terms of vapor pressure and the estimation of the normal boiling point, at 760 mmHg, using the ob-tained correlation. Results for propyl acetate have been compared with Boublik et al. (1984) and validated the implemented program. The Antoine correlation for the propyl acetate has presented relative deviation (ΔP) of 0.04% and estimated the following parameters with cor-responding confidence intervals: A = 7.03008±0.03391, B = 1290.200±19.505 and C = 209.466±2.161.  Reduction and consistency test of vapor-liquid equilib-rium data for binary systems The second program developed is to accomplish the cor-relation of vapor-liquid equilibrium data for mixtures, using activity coefficient models presented in the litera-ture (Prausnitz et al., 1999), i.e. Margules 2-suffixes, Margules 3-suffixes, Van Laar, Wilson and NRTL (Non-Random Two Liquids). Therefore, data regression consists of the corresponding parameter estimation of the activity coefficient model. In the case that the VLE data set is complete, i.e. presents the values of tempera-ture, total pressure, liquid and vapor compositions, the correlation tests also the thermodynamic consistency of the experimental data set. This is due to the fact that the activity coefficient models (γi) respect the exact thermo-dynamic definition of partial molar excess Gibbs en-ergy.  ()RTGnRTGnEinPTiEiji=⎥⎦⎤⎢⎣⎡∂∂≡γ≠,,ln (3)  Thus, the Euler theorem may be applied, i.e. the ad-ditive property, together with the fundamental equation for GE, resulting in the so-called Gibbs-Duhem relation, see Prausnitz et al. (1999). This is the base of the ther-modynamic consistency test of an experimental phase equilibrium data set. We may find in the literature, in general, two tests for thermodynamic consistency of VLE data, i.e. area test and deviation test. In our case, we have applied the deviation test which is in fact a data correlation followed by the analysis of the deviations (see Fredenslund et al., 1977). We may describe, easily, the VLE data correlation of a binary system by writing the total pressure equation (Barker, 1953), and neglect-ing the nonidealities of the vapor phase, which is a rea-sonable simplification for low pressures and nonasso-ciating components.  ()sat221sat111calcd1PxPxPγ−+γ= (4)  Table 1. Correlation and consistency test of the vapor-liquid equilibrium data for the n-heptane(1) + ethyl butyrate(2) at 100 ºC (Kojima and Tochigi, 1979). Model A B ΔP (%) Δy1** Margules 0.5563  1.36 0.0057 2- suffixes     Margules 0.7486 0.4059 0.87 0.0097 3- suffixes     Van Laar 0.4664 0.5769 0.76 0.0096 Wilson 0.3928 1.1612 1.02 0.0089 NTRL* 1.2171 -0.4020 0.98 0.0091 * C is the random parameter and has been set to 0.3, as default value. ** The values of the absolute average deviation are lower than 0.01 (01.01<Δy), indicating that the data are considered to be consistent, according to Fredenslund et al. (1977).   It may be pointed out that the activity coefficients depend on the temperature, liquid mole fraction and their parameters, which are adjusted from phase equilib-rium data reduction. To give an illustration, Eq. (5) shows the simple Margules 2-suffixes gamma model, for both components.  212221ln;lnAxAx=γ=γ (5)  Therefore, the data reduction for the mixture is simi-lar to the Antoine correlation, and may also be repre-sented by Eq. (2), which defines the objective function in terms of the pressure. For the mixture the differences are that the saturation pressure is replaced by the total pressure and the parameters come from the activity co-efficient model instead of the Antoine equation. After the data regression, the vapor composition may be evaluated, according to Eq. (6).  ()sat221sat111sat111calcd1,1PxPxPxyγ−+γγ= (6)  The vapor-liquid equilibrium data set for the n-heptane(1) + ethyl butyrate(2) system at 100 ºC pre-sented by Kojima and Tochigi (1979) has been used to test the nonlinear regression method implemented. The developed program allows parameter estimation of the five activity coefficient models listed at Table 1. It may be observed that all models have fitted satisfactorily the experimental data. Furthermore, the deviations pre-sented indicate that the experimental data is consistent. Concerning the operation of the program for correlating vapor-liquid equilibrium data of mixtures, it may be pointed out that all information relative to the system is given by the input file. The model is chosen during the execution of the program, together with the initial guess of the gamma coefficients and the Marquardt parameter. An output file is also created. Similar to the Antoine program, this output file contains information related to the iterations realized, during the execution of the Levenberg-Marquardt method. After convergence, the values of the estimated pa-rameters together with confidence intervals are pre-sented together with the correlation matrix and standard deviations. Furthermore, the dependent variables are properly compared, and for the case of isothermic data, the percent average pressure deviation and the absolute average mole fraction of the vapor phase deviation are 118

APÊNDICE A. Artigo sobre ELV

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

displayed, from which a thermodynamic consistence evaluation of the equilibrium data is prompt provided. Vapor-liquid equilibrium correlation for mixtures with electrolytes The Levenberg-Marquardt method was also applied for two aqueous ternary mixtures with methanol and NaCl and ethanol and NaCl with the second program. The corresponding binary systems have also been correlated. The UNIQUAC activity coefficient model (Abrams and Prausnitz, 1975) was applied in its original form and considering NaCl as one molecular species, i.e., neglect-ing the dissociation.  Table 2 reports structural parameters used for the studied species. It should be pointed out that structural parameters of the salt species, i.e., surface area and vol-ume parameters were determined from the values of the water and a molar mass ratio. Two goals have been achieved using this approach. One was to provide data fitting capability with a reasonable order of magnitude of the structural parameters. Secondly, compatibility with the interaction parameters estimated for non-electrolyte binary mixtures are encountered. This is also an important feature for predictability of the model and group contribution applications like UNIFAC (Kikic et al., 1991). Values of r and q for ionic species have been fitted by Macedo et al. (1990). Another approach en-countered in the literature is the increment of the pa-rameters from the ionic radii by considering solvation. However, the use of these two methods demands esti-mation of new solvent-solvent parameters and thereby compatibility requirement is not fulfilled. By the other hand, using the values of r and q calculated from the values of water and a ratio of the molar masses, as pre-sented in Table 2, it was obtained the desired compati-bility and simultaneously good correlation capability, eliminating the problem of low structural values due to the size of the ion for UNIQUAC equation.  Table 3 presents the estimated UNIQUAC interac-tion parameters for the species studied. It should be pointed out that the non-electrolyte binary systems have been correlated initial and separately and then with these predetermined values the salt-solvent constants were estimated from the corresponding experimental data. All calculations have presented absolute average deviation in terms of vapor mole fraction lower than 0.01 and relative average deviation in terms of pressure less than 2%. These deviations indicate the consistency of the experimental data and also the quality of the pa-rameters that gather many experimental points and dif-ferent sources.  Figures 1 and 2 illustrate the quality of the correla-tion obtained for the aqueous ternary systems with methanol and NaCl at 314.6 K and with ethanol and NaCl at 700 mmHg, respectively. Table 2: Structural parameters for UNIQUAC model. Species i Methanol Ethanol Water NaCl ri 1.4311 2.1055 0.9200 2.9845a qi 1.4320 1.9720 1.4000 4.5417b ()wateriwateriMMrra=;()wateriwateriMMqqb= Table 3: Estimated UNIQUAC interaction parameters (aij) in kelvin for the studied systems with methanol (MeOH), ethanol (EtOH), water (H2O) and sodium chloride (NaCl) i  \  j MeOH EtOH H2O NaCl MeOH 0.00 432.85a -103.32b -932.37d EtOH -261.57a 0.00 -12.47c -878.07d H2O 150.07b 166.12c 0.00 -925.33d NaCl 5817.00d 4722.55d 53.67d 0.00 aParameters estimated from methanol+ethanol VLE data (Niesen et. al., 1986; Kurihara et al., 1993). bParameters estimated from methanol+water VLE data (Soujanya et. al., 2010; Yao et. al., 1999; Kurihara et al., 1993). cParameters estimated from ethanol+water VLE data (Pemberton and Mash, 1978; Niesen et. al., 1986; Kurihara et al., 1993, 1995; Arce et. al., 1996; Navarro-Espinosa et al., 2010; Lai et al. 2014). dParameters estimated from water+NaCl, methanol+water+NaCl and ethanol+water+NaCl VLE data (Clarke and Glew, 1985; Gmehling, 1997; Yang and Lee, 1998; Jödecke et al., 2005), fixing MeOH+EtOH, MeOH+H2O and EtOH+H2O parameters determined previouslya,b,c.   Fig. 1. Vapor-liquid equilibrium diagrams for metha-nol(1)+water(2)+NaCl(3) at 314.6 K; solid symbols experi-mental (Jödecke et. al., 2005) and open symbols: UNIQUAC this work: (cid:122) and (cid:123), x´1 =0.0328; (cid:83) and (cid:85), x´1=0.0789; (cid:132) and (cid:133), x´1=0.216; (cid:84) and (cid:86), x´1=0.466.   Fig. 2. VLE y-x diagram for the system ethanol(1)+water (2)+NaCl(3) at 700 mmHg; 32 experimental points with salt mole fraction in the range of 0.001-0.1; (cid:122) experimental data (Gmehling, 1997); (cid:123) calculated values with UNIQUAC (this work).  APÊNDICE A. Artigo sobre ELV

119

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

III. CONCLUSIONS The coherence of the developed programs has been veri-fied via comparison with the parameters estimated for the same data set, confirming the reliability of the Levenberg-Marquardt routines implemented.  The results of the correlation program for mixtures are also efficient and analysis of the deviations allows the evaluation of the thermodynamic consistence of the experimental data. This qualification of the data may be useful for their application, i.e. for the development of models, and design and operation of processes.  The developed tool of calculation may be applied in problems of simulation and optimization of processes, using inclusive the visual recourses, which facilitates the interaction with the users. Furthermore, new correla-tion programs may also be developed to describe other thermodynamic and physical-chemistry properties, since Levenberg-Marquardt has been properly implemented.  These new salt species structural parameters demon-strated also to be flexible for the data correlation and coherent to respect to order of magnitude. The electro-static contribution has not been considered for VLE cal-culations. The original form of the UNIQUAC model demonstrated to be feasible with the molecular approach for strong electrolyte species in mixed solvents systems. NOMENCLATURE aij UNIQUAC interaction parameters A, B, C Antoine constants or activity coefficient pa-rameters A approximation of the Hessian matrix of the function Φ calcd calculated value e vector of the residuals ei residue of point i, ()θ−=,Xfyeiii exptl experimental value EiGG ,E molar excess Gibbs energy and partial mo-lar excess Gibbs energy of species i M number of experimental data points or atomic mass or molecular mass mi molality of species i n, ni total number of moles and number of moles of species i NRTL Non Randon Two-Liquid OF objective function P total pressure P any positive definite matrix satiP vapor pressure of species i q gradient of Φ or UNIQUAC surface area parameter r, q volume and surface area parameter R universal ideal gas constant T temperature VLE Vapor-Liquid Equilibrium X matrix of the independent variables iiyx, mole fraction of the component i in the liq-uid and vapor phase  'ix salt free mole fraction of the component i in the liquid phase y vector of the dependent variables  mole fraction of the component i in the va-por phase  Greek letters  ΔP percent average deviation, defined as ()∑=−MiPPPM1exptl,icalcd,iexptl,i//100 Δy1 absolute average deviation, defined as ∑=−MiyyM1calcd,i1,exptl,i1,/1 ε a positive small number iγ activity coefficient of the component i θ vector of the parameters 1θ vector of the parameters, initial guess iθ vector of the parameters at iteration i ρ value of the step length λ Marquadt parameter ν vector in the direction of the proposed step Φ objective function 1Φ objective function at the iteration 1 )1(Ψ objective function at νρ+θ)1(1 REFERENCES Abrams, D.S. and J.M. Prausnitz, “Statistical thermody-namics of liquid mixtures: a new expression for the excess Gibbs energy of partly or completely miscible systems,” AIChE J., 21, 116-128 (1975). Arce, A., J. Martínez-Ageitos and A. Soto, “VLE for water + ethanol + 1-octanol mixtures. Experimen-tal measurements and correlations,” Fluid Phase Equil., 122, 117-129 (1996). Bard, Y., Nonlinear Parameter Estimation, Academic Press, New York (1974). Barker, J.A., “Determination of Activity Coefficients from Pressure Total Measurements,” Austral. J. Chem., 6, 207-210 (1953). Boublik, T., V. Fried and E. Hála, The Vapor Pressure of Pure Substances, Elsevier, Amsterdam (1984). Camacho-Camacho, L.E., L.A. Galicia-Luna, O. Eli-zalde-Solis and Z. Martınez-Ramırez, “New iso-thermal vapor–liquid equilibria for the CO2 + n-nonane, and CO2 + n-undecane systems,” Fluid Phase Equilibria, 259, 45–50 (2007). Clarke, E.C. and D.N. Glew, “Evaluation of the Ther-modynamic Functions for Aqueous Sodium Chlo-ride from Equilibrium and Calorimetric Measure-ments below 154 ºC,” J. Phys. Chem. Ref. Data, 14, 2, 489–610 (1985). Fox, L., An Introduction to Numerical Linear Algebra, Oxford Univ. Press (Clarendon), London and New 120

APÊNDICE A. Artigo sobre ELV

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

York (1964). Fredenslund, A., J. Gmehling and P. Rasmussen, Vapor-Liquid Equilibria Using UNIFAC, Elsevier, Am-sterdan (1977). Gmehling, J., Dortmund Data Bank (DDB) – electrolytes (ELE). Oldenburg, Germany: DDBST GmbH (1997). Haghtalab, A. and K. Peyvandi, “Electrolyte-UNIQUAC-NRF model for the correlation of the mean activity coefficient of electrolyte solutions,” Fluid Phase Equilibria, 281, 163–171 (2009). Jödecke, M., A.P.S. Kamps and G. Maurer, “Experi-mental Investigation of the Influence of NaCl on the Vapor-Liquid Equilibrium of CH3OH + H2O,” J. Chem. Eng. Data, 50, 138-141 (2005). Kikic, I., M. Fermeglia and P. Rasmussen, “UNIFAC Prediction of Vapor-Liquid Equilibria in Mixed Solvent-Salt Systems,” Chemical Eng. Science, 46, 2775-2780 (1991). Kojima, K. and K. Tochigi, Prediction of Vapor-Liquid Equilibria by the ASOG, Elsevier, Amsterdam (1979). Kurihara, K. M. Nakamichi and K. Kojima, “Isobaric vapor-liquid equilibria for methanol + ethanol + water and the three constituent binary systems,” J. Chem. Eng. Data, 38, 446-449 (1993). Kurihara, K., T. Minoura, K. Takeda and K. Kojima, “Isothermal Vapor-Liquid Equilibria for Methanol + Ethanol+Water, Methanol+Water, and Ethanol + Water,” J. Chem. Eng. Data, 40, 679-684 (1995). Lai, H.S., Y. Lin and C.-H. Tu, “Isobaric (vapor + liq-uid) equilibria for the ternary system of (ethanol + water + 1,3-propanediol) and three constituent bi-nary systems at P = 101.3 kPa,” J. Chem. Ther-mod., 68, 13-19 (2014). Lazzús, J.A., “Optimization of activity coefficient mod-els to describe vapor–liquid equilibrium of (alco-hol + water) mixtures using a particle swarm algo-rithm,” Comp. and Mathem. with Applicat., 60, 2260–2269 (2010). Levenberg, K., “A method for the solution of certain nonlinear problems in least squares,” Quart. Appl. Math., 2, 164-168 (1944). Loehe, J.R. and M.D. Donohue, “Recent advances in modeling thermodynamic properties of aqueous strong electrolyte systems,” AIChE J., 43, 1, 180–195 (1997). Macedo, E.A., P. Skovborg and P. Rasmussen, “Calcu-lation of phase equilibria for solutions of strong eletrolytes in solvent-water mixtures,” Chem. Eng. Sci., 45, 875-882 (1990). Maquardt, D.W., “An algorithm for least squares esti-mation of nonlinear parameters,” SIAM J., 11, 431-441 (1963). Navarro-Espinosa, I.R., C.A. Cardona and J.A. López, “Experimental measurements of vapor–liquid equilibria at low pressure: Systems containing al-cohols, esters and organic acids,” Fluid Phase Equil., 287, 141-145 (2010). Niesen, V., A. Palavra, A.J. Kidnay and V.F. Yesavage, “An apparatus for vapor-liquid equilibrium at ele-vated temperatures and pressures and selected re-sults for the water-ethanol and methanol-ethanol systems,” Fluid Phase Equil., 31, 283-298 (1986). Pemberton, R.C. and C.J. Mash, “Thermodynamic properties of aqueous non-electrolyte mixtures II. Vapour pressures and excess Gibbs energies for water + ethanol at 303.15 to 363.15 K determined by an accurate static method,” J. Chem. Thermo-dynamics, 10, 867-888 (1978). Prausnitz, J.M., R.N. Lichtenthaler and E.G. Azevêdo, Molecular Thermodynamics of Fluid Phase Equi-libria, Prentice-Hall (1999). Soujanya, J., B. Satyavathi and T.E. Vittal Prasad, “Ex-perimental (vapour + liquid) equilibrium data of (methanol + water + glycerol) and (methanol + glycerol) systems at atmospheric and sub-atmospheric pressures,” J. Chem. Thermod., 42, 621-624 (2010). Thomsen, K., M.C. Iliuta and P. Rasmussen, “Extended UNIQUAC model for correlation and prediction of vapor–liquid–liquid–solid equilibria in aqueous salt systems containing non-electrolytes. Part B. Alcohol (ethanol, propanols, butanols)–water–salt systems,” Chem. Eng. Sci., 59, 3631–3647 (2004). Yang, S. and C.S. Lee, “Vapor-Liquid Equilibria of Wa-ter + Methanol in the Presence of Mixed Salts,” J. Chem. Eng. Data, 43, 558-561 (1998). Yao, J., H. Li and S. Han, “Vapor–liquid equilibrium data for methanol–water–NaCl at 45°C,” Fluid Phase Equil., 162, 253-260 (1999). APÊNDICE B – Requisitos para Executar os

Programas Desenvolvidos

121

Os programas desenvolvidos podem ser executados nos principais sistemas operaci-
onais: Windows® (windows.microsoft.com), Ubuntu® (ubuntu.com) e, também, em Mac
OS X® (apple.com). As seções seguintes apresentam os requisitos necessários em cada
sistema operacional juntamente com um exemplo.

B.1 Requisitos Gerais

Os requisitos gerais para a execução dos programas desenvolvidos são:
a) Python versão 2.7 (<https://www.python.org/>);
b) NumPy (<http://www.numpy.org/>);
c) SciPy (<http://scipy.org/>);
d) Matplotlib (<http://matplotlib.org/>);
e) Qt e PySide (<http://qt-project.org/>).

B.2 Requisitos para o Ubuntu®
B.2.1 Instalação e conﬁguração

Todos os itens dos requisitos gerais (seção B.1) e especíﬁcos são instalados e

conﬁgurados mediante os comandos, executados em linha de comando, a seguir:

a) sudo apt-get install python-numpy python-scipy;
b) sudo apt-get install python-matplotlib python-pyside.

B.2.2 Compilação e execução

Antes de executar o programa é necessário compilar o arquivo Form.ui para gerar
o arquivo ui_Form.py e compilar o arquivo Form.qrc para gerar o arquivo Form_rc.py.
Isto é feito em linha de comando, no diretório principal de cada programa, por meio dos
comandos:

a) python-uic Form.ui -o ui_Form.py (para ambos os programas);
b) python-rcc Form.qrc -o Form_rc.py (apenas para o programa JAFOSSMS).

122

APÊNDICE B. Requisitos para Executar os Programas Desenvolvidos

Depois destas etapas os programas podem ser executados, também, em linha de comando,
por meio dos comandos:

a) python VLEregression.py (para o programa VLE Regression);
b) python JAFOSSMS.py (para o programa JAFOSSMS).

B.2.3 Exemplo

No Ubuntu® 14.04 LTS (32bits), foram instalados e conﬁgurados os requisitos
citados na seção B.1 e, também, os citados na seção B.2. Após a compilação dos arqui-
vos Form.ui e Form.qrc (apenas para o programa JAFOSSMS), os programas foram
executados, o que é ilustrado na Figura 61(a) e na Figura 61(b), a seguir:

Figura 61 – Programas VLE Regression e JAFOSSMS no Ubuntu® 14.04 LTS.

(a) Programa VLE Regression.

(b) Programa JAFOSSMS.

Fonte: O autor.

B.3 Requisitos para o Windows®
B.3.1 Instalação e conﬁguração dos requisitos

Primeiramente, deve-se instalar todos os itens dos requisitos gerais (seção B.1),
cujos executáveis podem ser encontrados nos respectivos portais. Após isso, é necessário, a
instalação das seguintes bibliotecas Python, todas encontradas em <http://www.lfd.uci.
edu/~gohlke/pythonlibs/>:

a) setuptools;
b) six;
c) python-dateutil;
d) pyparsing.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE B. Requisitos para Executar os Programas Desenvolvidos

123

Em seguida, para facilitar a execução dos programas, adicione a variável de ambiente Path,
os caminhos:

a) C:\Python27\;
b) C:\Python27\Scripts\;
c) C:\Python27\Lib\site-packages\PySide\.

B.3.2 Compilação e execução

Antes de executar o programa é necessário compilar o arquivo Form.ui para gerar
o arquivo ui_Form.py e compilar o arquivo Form.qrc para gerar o arquivo Form_rc.py.
Isto é feito em linha de comando, no diretório principal de cada programa, por meio dos
comandos:

a) python-uic Form.ui -o ui_Form.py (para ambos os programas);
b) python-rcc Form.qrc -o Form_rc.py (apenas para o programa JAFOSSMS).
Depois destas etapas os programas podem ser executados, também, em linha de comando,
por meio dos comandos:

a) python VLEregression.py (para o programa VLE Regression);
b) python JAFOSSMS.py (para o programa JAFOSSMS).

B.3.3 Exemplo

No Windows® 7 Home Basic (32bits), foram instalados e conﬁgurados os requisitos

citados na seção B.1, ou seja, instalou-se, na ordem:

a) python-2.7.8.msi;
b) numpy-1.9.0-win32-superpack-python2.7.exe;
c) scipy-0.14.0-win32-superpack-python2.7.exe;
d) matplotlib-1.4.0.win32-py2.7.exe;
e) qt-opensource-windows-x86-mingw482\_opengpodeml-5.3.1.exe;
f) PySide-1.2.2.win32-py2.7.exe.

Em seguida foram instalados ou requisitos citados na seção B.3, ou seja, instalou-se, na
ordem:

a) setuptools-3.8.1.win32-py2.7.exe;
b) six-1.7.3.win32-py2.7.exe;
c) python-dateutil-2.2.win32-py2.7.exe;
d) pyparsing-2.0.2.win32-py2.7.exe.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

124

APÊNDICE B. Requisitos para Executar os Programas Desenvolvidos

Após a conﬁguração da variável de ambiente Path e a compilação dos arquivos Form.ui e
Form.qrc (apenas para o programa JAFOSSMS), os programas foram executados, o que
é ilustrado na Figura 62(a) e na Figura 62(b), a seguir:

Figura 62 – Programas VLE Regression e JAFOSSMS no Windows® 7 Home

Basic.

(a) Programa VLE Regression.

(b) Programa JAFOSSMS.

Fonte: O autor.

B.4 Requisitos para o Mac OS X®
B.4.1 Instalação e conﬁguração

Todos os itens dos requisitos gerais (seção B.1) e especíﬁcos são instalados e
conﬁgurados mediante os instaladores encontrados nos respectivos portais. Podendo, ser
utilizados, alternativamente aos arquivos .dmg e .pkg, os instaladores brew, easy_install
e pip.

B.4.2 Compilação e execução

Antes de executar o programa é necessário compilar o arquivo Form.ui para gerar
o arquivo ui_Form.py e compilar o arquivo Form.qrc para gerar o arquivo Form_rc.py.
Isto é feito em linha de comando, no diretório principal de cada programa, por meio dos
comandos:

a) python-uic Form.ui -o ui_Form.py (para ambos os programas);
b) python-rcc Form.qrc -o Form_rc.py (apenas para o programa JAFOSSMS).
Depois destas etapas os programas podem ser executados, também, em linha de comando,
por meio dos comandos:

a) python VLEregression.py (para o programa VLE Regression);
b) python JAFOSSMS.py (para o programa JAFOSSMS).

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE B. Requisitos para Executar os Programas Desenvolvidos

125

B.4.3 Exemplo

No Mac OS X® 10.6 Snow Leopard (32bits), foram instalados e conﬁgurados os
requisitos citados na seção B.1 e, também, os citados na seção B.4, ou seja, instalou-se, na
ordem:

a) python-2.7.8-macosx10.6.dmg;
b) scipy-0.14.0-py2.7-python.org-macosx10.6.dmg;
c) numpy-1.8.0-py2.7-python.org-macosx10.6.dmg;
d) matplotlib-1.3.1-py2.7-python.org-macosx10.6.dmg;
e) qt-opensource-mac-4.8.6-1.dmg;
f) pyside-1.1.1-qt48-py27apple.pkg.

Após a compilação dos arquivos Form.ui e Form.qrc (apenas para o programa JAFOSSMS),
os programas foram executados, o que é ilustrado na Figura 63(a) e na Figura 63(b), a
seguir:

Figura 63 – Programas VLE Regression e JAFOSSMS no Mac OS X®

10.6 Snow Leopard.

(a) Programa VLE Regression.

(b) Programa JAFOSSMS.

Fonte: O autor.

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

APÊNDICE C – Programa VLE Regression

127

Neste apêndice, primeiramente, apresenta-se os códigos da interface gráﬁca do
usuário (GUI), da biblioteca de modelos termodinâmicos e do programa principal. E, por
último, explica-se a formatação do arquivo com dados de entrada. Todos estes itens, juntos,
constituem o programa VLE Regression.

Os códigos apresentados aqui permitem recriar, a partir do conteúdo impresso, o
arquivo original. Para que isso seja possível, é necessário que o texto impresso (incluindo
os espaços à esquerda, na exata quantidade) seja gravado na forma de arquivo de texto
sem formatação, com os respectivos nomes (exceto os de dados de entrada, onde, apenas,
sugere-se que tenham a extensão .dat) e, OBRIGATORIAMENTE, com codiﬁcação
UTF-8.

C.1 Interface Gráﬁca do Usuário

Form.ui

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33

<?xml version="1.0" encoding="UTF-8"?>
<ui version="4.0">
<class>Form</class>
<widget class="QWidget" name="Form">
<property name="geometry">
<rect>
<x>0</x>
<y>0</y>
<width>800</width>
<height>600</height>
</rect>
</property>
<property name="windowTitle">
<string>VLE Regression</string>
</property>
<layout class="QVBoxLayout" name="verticalLayout">
<item>
<widget class="QLabel" name="label_Description">
<property name="text">
<string>Regression of VLE data to calculate binary parameters (Aij) of the UNIQUAC model
</string>
</property>
</widget>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_1">
<item>
<widget class="QLabel" name="label_Datafile">
<property name="text">
<string>Datafile:</string>
</property>
<property name="buddy">
<cstring>lineEdit_Datafile</cstring>

128

APÊNDICE C. Programa VLE Regression

34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93

</property>
</widget>
</item>
<item>
<widget class="QLineEdit" name="lineEdit_Datafile"/>
</item>
<item>
<widget class="QPushButton" name="pushButton_Browse">
<property name="text">
<string>&amp;Browse</string>
</property>
</widget>
</item>
</layout>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_2">
<item>
<widget class="QCheckBox" name="checkBox_FixedAij">
<property name="text">
<string>Use &amp;Fixed Aij</string>
</property>
</widget>
</item>
<item>
<widget class="QLineEdit" name="lineEdit_FixedAij">
<property name="enabled">
<bool>false</bool>
</property>
</widget>
</item>
</layout>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_3">
<item>
<widget class="QCheckBox" name="checkBox_TRange">
<property name="text">
<string>&amp;Use only experimental data in the temperature range (°C):</string>
</property>
</widget>
</item>
<item>
<widget class="QLabel" name="label_TMin">
<property name="enabled">
<bool>false</bool>
</property>
<property name="text">
<string>Mi&amp;nimum =</string>
</property>
<property name="buddy">
<cstring>lineEdit_TMin</cstring>
</property>
</widget>
</item>
<item>
<widget class="QLineEdit" name="lineEdit_TMin">
<property name="enabled">
<bool>false</bool>
</property>

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE C. Programa VLE Regression

129

94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153

</widget>
</item>
<item>
<widget class="QLabel" name="label_TMax">
<property name="enabled">
<bool>false</bool>
</property>
<property name="text">
<string>Ma&amp;ximum =</string>
</property>
<property name="buddy">
<cstring>lineEdit_TMax</cstring>
</property>
</widget>
</item>
<item>
<widget class="QLineEdit" name="lineEdit_TMax">
<property name="enabled">
<bool>false</bool>
</property>
</widget>
</item>
</layout>
</item>
<item>
<widget class="QTextEdit" name="textEdit"/>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_4">
<item>
<widget class="QPushButton" name="pushButton_Run">
<property name="text">
<string>&amp;Run</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>40</width>
<height>20</height>
</size>
</property>
</spacer>
</item>
<item>
<widget class="QPushButton" name="pushButton_Exit">
<property name="text">
<string>&amp;Exit</string>
</property>
</widget>
</item>
</layout>
</item>
</layout>
</widget>

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

130

APÊNDICE C. Programa VLE Regression

154
155
156
157
158
159
160
161
162
163
164
165
166
167
168

<tabstops>
<tabstop>lineEdit_Datafile</tabstop>
<tabstop>pushButton_Browse</tabstop>
<tabstop>checkBox_FixedAij</tabstop>
<tabstop>lineEdit_FixedAij</tabstop>
<tabstop>checkBox_TRange</tabstop>
<tabstop>lineEdit_TMin</tabstop>
<tabstop>lineEdit_TMax</tabstop>
<tabstop>textEdit</tabstop>
<tabstop>pushButton_Run</tabstop>
<tabstop>pushButton_Exit</tabstop>
</tabstops>
<resources/>
<connections/>
</ui>

C.2 Código Fonte da Biblioteca de Modelos Termodinâmicos

ThermodynamicModels.py

def UNIQUAC(r,q,a,x,T):

from numpy import inner,outer,log,exp,array
J = outer(1./inner(r,x),r)
L = outer(1./inner(q,x),q)
lnGammaC = 1-J+log(J)-5*q*(1-J/L+log(J/L))
tau = exp(outer(-1./T,a).reshape(T.shape+a.shape))
s = array([inner(xL_i,tau_i.T) for xL_i,tau_i in zip(x*L,tau)])
lnGammaR = q*(1-log(s)-array([inner(xLs_i,tau_i) for xLs_i,tau_i in zip(x*L/s,tau)]))
return exp(lnGammaC+lnGammaR)

C.3 Código Fonte do Programa Principal

VLEregression.py

#!/usr/bin/env python
# -*- coding: utf8 -*-
from __future__ import division
from PySide.QtGui import QApplication, QDialog, QFileDialog
from PySide.QtCore import QFile, QTextStream
import sys
from numpy import *
import matplotlib.pyplot as plt

import ui_Form
import ThermodynamicModels
from numpy.f2py.auxfuncs import isarray

class Form(QDialog, ui_Form.Ui_Form):

def __init__(self):

super(Form, self).__init__()
self.setupUi(self)
self.textEdit.setStyleSheet(’font: 8pt \"Courier\";’)
self.checkBox_FixedAij.stateChanged.connect(self.toggleCheckBox_FixedAij)
self.checkBox_TRange.stateChanged.connect(self.toggleCheckBox_TRange)
self.pushButton_Browse.clicked.connect(self.browse)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

1
2
3
4
5
6
7
8
9

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22

APÊNDICE C. Programa VLE Regression

131

self.pushButton_Run.clicked.connect(self.runCalculations)
self.pushButton_Exit.clicked.connect(self.exitProgram)
self.show()

def toggleCheckBox_FixedAij(self):

flag = self.checkBox_FixedAij.isChecked()
self.lineEdit_FixedAij.setEnabled(flag)

def toggleCheckBox_TRange(self):

flag = self.checkBox_TRange.isChecked()
self.label_TMin.setEnabled(flag)
self.label_TMax.setEnabled(flag)
self.lineEdit_TMin.setEnabled(flag)
self.lineEdit_TMax.setEnabled(flag)

def browse(self):

self.textEdit.clear()
fName, _ = QFileDialog.getOpenFileName(self, ’Filename of the dataset’, ’.’,

’Dataset (*.dat);;All files (*.*)’)

if fName:

self.lineEdit_Datafile.setText(fName)

return

def runCalculations(self):

fName =self.lineEdit_Datafile.text()
if fName.strip() == ’’:

return

if not QFile(fName).exists:

return

self.nl_regression(fName)

def exitProgram(self):

self.close()

def printText(self, text):

self.textEdit.insertPlainText(text.decode(’utf-8’))

def nl_regression(self,fName):
import scipy.stats as stats
import scipy.optimize as optimize
self.textEdit.clear()
def readData(stream):

return stream.readLine().split(’#’)[0].split()

f=QFile(fName)
f.open(QFile.ReadOnly | QFile.Truncate | QFile.Text)
stream = QTextStream(f)
self.printText(’Datafile: {}\n\n’.format(fName))
Comp = readData(stream)
NComp = len(Comp)
self.printText(’VLE System: ’)
for i in range(NComp-1):

self.printText(’({}){} + ’.format(i+1, Comp[i]))
self.printText(’({}){}\n\n’.format(NComp, Comp[-1]))
EqAntoine, r, q = [], [], []
for i in range(NComp):

EqAntoine_i = []
NEqs = int(readData(stream)[0])
if NEqs == 0:

EqAntoine.append(0.)

else:

23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

132

APÊNDICE C. Programa VLE Regression

for j in range(NEqs): EqAntoine_i.append(map(float, readData(stream)))
EqAntoine.append(EqAntoine_i)

for eq in EqAntoine:

if eq != 0.:

if len(eq)>1:
T0 = None
for i in range(len(eq)-1):

T1, T2, T3, T4 = eq[i][-2], eq[i][-1], eq[i+1][-2], eq[i+1][-1]
if i>0:

eq[i-1][-1] = T0

T0 = (T2*(T4-T3)+T3*(T2-T1))/((T4-T3)+(T2-T1))

eq[-2][-1] = T0
eq[-1][-2] = T0

for i in range(NComp):

line = map(float,readData(stream))
r.append(line[0]);

q.append(line[1])

r, q = array(r), array(q)
x, y, PExp, TExp = [], [], [], []
for i in range(NComp):

x.append([])
y.append([])

self.printText(’Reference of data:\n’)
NRef, Refs = 1, []
while not stream.atEnd():

notUse = int(readData(stream)[0])
ref = stream.readLine().split(’#’)[0].strip()
SysOrder = map(lambda x: int(x)-1,readData(stream))
NPoints = SysOrder.pop()+1
SysType = len(SysOrder)
NOutOfRange = 0
for _ in range(NPoints):

line = map(float,readData(stream))
if notUse:

continue

if self.checkBox_TRange.isChecked():

if line[-1] < float(self.lineEdit_TMin.text()) or line[-1] > float(

self.lineEdit_TMax.text()):

NOutOfRange += 1
continue

for i in range(SysType-1):

x[SysOrder[i]].append(line[i])
y[SysOrder[i]].append(line[i+SysType-1])

x[SysOrder[SysType-1]].append(1.-sum(line[0:SysType-1]))
y[SysOrder[SysType-1]].append(1.-sum(line[SysType-1:2*SysType-2]))
for i in set(range(NComp))-set(SysOrder):

x[i].append(0.)
y[i].append(0.)

PExp.append(line[-2])
TExp.append(line[-1])
Refs.append(NRef)

if notUse:

txtNoUsed = ’ (>> NOT USED <<)’

else:

txtNoUsed =’’

if SysType < 1:

self.printText(’\n=> ERROR: SysType < 2’)

elif SysType == 2:

self.printText(’{:<35}’.format(’({}) Binary VLE System {}:’.format(NRef,

tuple(array(SysOrder)+1))))

elif SysType == 3:

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142

APÊNDICE C. Programa VLE Regression

133

143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202

self.printText(’{:<35}’.format(’({}) Ternary VLE System {}:’.format(NRef,

tuple(array(SysOrder)+1))))

elif SysType == 4:

self.printText(’{:<35}’.format(’({}) Quaternary VLE System {}:’.format(NRef,

tuple(array(SysOrder)+1))))

elif SysType > 4:

self.printText(’{:<35}’.format(’({}) {}-nary VLE System {}:’.format(SysType,

tuple(NRef,array(SysOrder)+1))))

self.printText(’{:4g} - {:4g} (out of T range) = {:4g} points => {}{}\n’.format(

NPoints, NOutOfRange, NPoints-NOutOfRange, ref, txtNoUsed))

NRef += 1

f.close()
x, y = array(x).T, array(y).T
PExp, TExp, NRef = array(PExp), array(TExp), array(NRef)
PSat = []
for T in TExp:
PSat_i = []
for i in range(NComp):

if type(EqAntoine[i])==float: PSat_i.append(0.)
else:

eqUsed = False
for eq in EqAntoine[i]:
A, B, C, T1, T2 = eq
if T1<=T<T2:

PSat_i.append(10**(A-B/(C+T)))
eqUsed = True; break

if eqUsed: continue
self.printText(’\n=> ERROR: Impossible to calculate PSat’)
self.printText(’ without Antoine Equation ({}) for T = {} °C.’ \

.format(Comp[i], T))

return

PSat.append(PSat_i)

PSat = array(PSat)
TExp += 273.15 # °C => K
theta_fixed_i, theta_fixed = [], []
def f_LCtoI(l,c,n):

a = l*n+c
return a-a//(n+1)-1

def f_ItoLC(i,n):

l = i//(n-1); c = i%(n-1)
if c>=l:
c+=1

return l, c

if self.checkBox_FixedAij.isChecked():

for value in self.lineEdit_FixedAij.text().split(’,’):

lin, col, num = map(eval, value.split())
theta_fixed_i.append(f_LCtoI(lin-1, col-1, NComp))
theta_fixed.append(num)

theta_i = sorted(set(range(NComp*(NComp-1)))-set(theta_fixed_i))
def f(X, *theta):

for i, num in zip(theta_i, theta): a[f_ItoLC(i, NComp)] = num
gamma = ThermodynamicModels.UNIQUAC(r, q, a, X, TExp)
return array(map(sum, X*gamma*PSat))

def plus_minus(a,b):
return a-b, a+b

theta0 = (random.rand(NComp*(NComp-1)-len(theta_fixed))*2000-1000.).astype(int).astype(

float)

N, P = x.shape[0], theta0.shape[0]
a = zeros((NComp, NComp))
for i, num in zip(theta_fixed_i, theta_fixed):

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

134

APÊNDICE C. Programa VLE Regression

203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262

a[f_ItoLC(i,NComp)] = num
self.printText(’\nAij = [[’)
idx = 0
for i in range(NComp):

for j in range(NComp):

if i == j: self.printText(’{:^10}’.format(0))
else:

k = f_LCtoI(i,j,NComp)
if k in theta_fixed_i:

self.printText(’{:^10}’.format(’{:7.2f}’.format(theta_fixed[

theta_fixed_i.index(k)])))

else:

self.printText(’{:^10}’.format(’theta[{}]’.format(idx)))
idx += 1

if i < NComp-1:

self.printText(’]\n

[’)

self.printText(’]]\n\nInitial Guess:\nAij = [[’)
l = 0
for i in range(NComp):

for j in range(NComp):

if i == j: self.printText(’{:^10}’.format(0))
else:

k = f_LCtoI(i, j, NComp)
if k in theta_fixed_i:

self.printText(’{:^10}’.format(’{:7.2f}’.format(theta_fixed[

theta_fixed_i.index(k)])))

else:

self.printText(’{:^10}’.format(’{:7.2f}’.format(theta0[l])))
l += 1

if i < NComp-1:

self.printText(’]\n

[’)

self.printText(’]]\n’)
try:

theta_optimum, cov_theta_optimum, _, errmsg, _ = optimize.curve_fit(f, x, PExp, theta0,

full_output=1)

except:

self.printText(’\n=> NOT CONVERGED: {}\n’.format(sys.exc_info()[0]))
self.printText(’\n=> TRY RUNNING AGAIN OR ADD/REMOVE ELV SYSTEMS !!!’)
return

self.printText(’\n=> CONVERGED: {}\n\nSolution:\nAij = [[’.format(errmsg))
for i in range(NComp):

for j in range(NComp):

self.printText(’{:^10}’.format(’{:7.2f}’.format(a[i,j])))

if i < NComp-1:

self.printText(’]\n

[’)

self.printText(’]]\n’)
if type(cov_theta_optimum) == float:

self.printText(’\n=> COVARIANCE MATRIX IS INFINITE!\n’)
return

PExp_optimum = f(x, *theta_optimum)
# Total Sum of Squares (TSS)
TSS_corrected = ((PExp-PExp.mean())**2).sum()
TSS_uncorrected = (PExp**2).sum()
# Residual Sum of Squares (RSS) or Sum of Squared Residuals (SSR) or
# Sum of Squared Errors of Prediction (SSE)
RSS = ((PExp-PExp_optimum)**2).sum()
# Explained Sum of Squares (ESS)
ESS_uncorrected = TSS_uncorrected-RSS
# Mean Total Sum of Squares
MST_corrected = TSS_corrected/(N-1)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE C. Programa VLE Regression

135

# Mean Residual Sum of Squares
MSR = RSS/(N-P)
# Mean Explained Sum of Squares
MSE_uncorrected = ESS_uncorrected/P
alpha = 0.05
F_critical_uncorrected = stats.f.isf(alpha, N-P, P)
F_value_uncorrected = MSE_uncorrected/MSR
Pr_F_value_uncorrected = stats.f.sf(F_value_uncorrected, N-P, P)
s = sqrt(MSR)
R2 = 1-RSS/TSS_corrected
R2_bar = 1-MSR/MST_corrected
ASE = sqrt(cov_theta_optimum.diagonal())
corr_theta_optimum = (cov_theta_optimum/ASE).T/ASE
t_critical = stats.t.isf(alpha/2, N-P)
t_value = theta_optimum/ASE
Pr_tvalue = stats.t.sf(abs(t_value), N-P)*2
CI_theta = plus_minus(theta_optimum, t_critical*ASE)
self.printText(’\nNon-Linear Least Squares Summary Statistics\n\n’)
self.printText(’Function: y = {0}\n\n’.format(’UNIQUAC’))
self.printText(’Source
| Sum of Squares

| DF

| Mean Square

|’

’ F-value

| Pr(>F)\n’)

self.printText(’Regression

| {0:4d} | {1:16.6f} | {2:16.6f} | {3:12.6f} |’
’ {4:8.6f}\n’.format(P, ESS_uncorrected, MSE_uncorrected, F_value_uncorrected,
Pr_F_value_uncorrected))

self.printText(’Residual

| {0:4d} | {1:16.6f} | {2:16.6f} |\n’.format(N-P, RSS,

MSR))

self.printText(’ Uncorrected Total | {0:4d} | {1:16.6f} | \n’.format(N, TSS_uncorrected))
self.printText(’ (Corrected Total) | {0:4d} | {1:16.6f} | \n\n’.format(N-1, TSS_corrected))
self.printText(’alpha = {0:8.6f}
self.printText(’s = {0:8.6f}

t-critical = {1:8.6f}\n\n’.format(alpha, t_critical))
R-sq = {1:8.6f} R-sq(adj) = {2:8.6f}\n\n’.format(s, R2,

R2_bar))

self.printText(’Parameter | Estimate

| Asymptotic
’ Pr(>|t|) | Asymptotic {0:2.0%}\n’.format(1-alpha))
| Std. Error

self.printText(’

|

’

| Confidence Interval\n’)

self.printText(’

|

’

| Lower

for i in range(P):

|

| Upper\n’)

| t-value

|

|

|’

|’

|’

self.printText(’{0:10s}| {1:16.6f} | {2:20.6f} | {3:12.6f} | {4:8.6f} | {5:23.6f} |’

’ {6:23.6f}\n’.format(’theta[{0}]’.format(i), theta_optimum[i], ASE[i], t_value[i],
Pr_tvalue[i], CI_theta[0][i], CI_theta[1][i]))

self.printText(’\nParameter | Correlation Matrix\n
for i in range(P):

’)

self.printText(’{0:11s}’.format(’| theta[{0}]’.format(i)))

for i in range(P):

self.printText(’\n{0:10s}’.format(’theta[{0}]’.format(i)))
for j in range(P):

self.printText(’| {0:9.6f}’.format(corr_theta_optimum[i][j]))

Gamma = ThermodynamicModels.UNIQUAC(r, q, a, x, TExp)
PCalc = array(map(sum, x*Gamma*PSat))
dP = abs(PExp-PCalc)
yCalc = ((x*Gamma*PSat).T/array(map(sum,x*ThermodynamicModels.UNIQUAC(r,q,a,x,TExp)*

PSat))).T

dy = abs(y-yCalc)
sum_dyRel, yNull = [],[]
for i in range(NComp-1):
sum_dyRel.append(0.)
yNull.append(0)
for i in range(N):

for j in range(NComp-1):

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322

136

APÊNDICE C. Programa VLE Regression

if y[i,j] == 0.:
yNull[j] += 1

else:

sum_dyRel[j] += dy[i,j]/y[i,j]

for i in range(NComp-1):

self.printText(’\n\nMaximum deviation of y{} = {:8.6f}\n’.format(i+1, max(dy[:,i])))
self.printText(’Average absolute deviation of y{} = {:8.6f}\n’.format(i+1,

sum(dy[:, i])/N))

self.printText(’Average relative deviation of y{} ({} null points) = {:5.2%}’.format(

i+1, yNull[i], sum_dyRel[i]/N))

self.printText(’\n\nMaximum deviation of Pressure = {:7.2f}\n’.format(max(dP)))
self.printText(’Average absolute deviation of Pressure = {:7.2f}\n’.format(sum(dP)/N))
self.printText(’Average relative deviation of Pressure = {:5.2%}\n\nReference ’.format(

sum(dP/PExp)/N))

for i in range(NComp-1):
self.printText(’| x{}
for i in range(NComp-1):

’.format(i+1))

self.printText(’| y{0}Exp

- y{0}Calc

self.printText(’| PExp
for i in range(N):

- PCalc

=

= abs(dy{0}) ’.format(i+1))
abs(dP) (mmHg) | TExp (°C)\n’)

self.printText(’{:^10}’.format(Refs[i]))
for j in range(NComp-1): self.printText(’| {:8.6f} ’.format(x[i, j]))
for j in range(NComp-1):

self.printText(’| {:8.6f} - {:8.6f} = {:8.6f} ’. \

format(y[i,j], yCalc[i,j], dy[i,j]))
self.printText(’| {:9.2f} - {:9.2f} = {:9.2f}

| {:7.3f}\n’. \

format(PExp[i], PCalc[i], dP[i], TExp[i]-273.15))

self.printText(’\n Gamma1
for i in range(NComp-1):

| ’)

self.printText(’Gamma{}

| ’.format(i+2))

for i in range(NComp):

self.printText(’PSat{}

| ’.format(i+1))

self.printText(’PExp
for i in range(N):

| T (°C)\n’)

for j in range(NComp):

self.printText(’{:9.5f} |’.format(Gamma[i,j]))

for j in range(NComp):

self.printText(’{:9.2f} |’.format(PSat[i,j]))

self.printText(’{:7.2f} | {:7.3f}\n’.format(PExp[i], TExp[i]-173.15))

return

def main():

app = QApplication(sys.argv)
_ = Form()
sys.exit(app.exec_())

if __name__ == ’__main__’:

main()

323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372

C.4 Arquivo com Dados de Entrada

Para melhor compreensão do formato do arquivo com dados de entrada, e também
como base para a criação de novos arquivos, á apresentado, a seguir, uma listagem do

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE C. Programa VLE Regression

137

arquivo Dados.dat que contém os dados para o metanol e o etanol:

Dados.dat

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38

# Taverage=(T2*(T4-T3)+T3*(T2-T1))/((T4-T3)+(T2-T1))

# Taverage=(T2*(T4-T3)+T3*(T2-T1))/((T4-T3)+(T2-T1))

# Index1 Index2 Index3 NumberOfPoints

Methanol Ethanol
2 # DDB Componente Number (CN) 110
8.08097 1582.27 239.700 15 100
7.97010 1521.23 233.970 65 214
2 # DDB Componente Number (CN) 11
8.20417 1642.89 230.341 -57 80
7.68117 1332.04 199.177 77 243
1.4311 1.4320 # DDB CN 110
2.1055 1.9720 # DDB CN 11
0 # noUse (0 to use and 1 don’T use)
"Niesen et. al., Fluid Phase Equilibria 1986, 31, 283" # Reference
1 2 12
0.161 0.225 1848.90 100. # x1 y1 P(mmHg) T(°C).
0.428 0.529 2086.67 100. # Used P(mmHg)=(760/101.325)*P(kPa)
0.591 0.691 2262.19 100.
0.828 0.878 2488.70 100.
0.948 0.967 2601.96 100.
1.000 1.000 2647.72 100.
0.000 0.000 5701.97 140.
0.420 0.502 6658.30 140.
0.580 0.646 7060.33 140.
0.829 0.865 7717.38 140.
0.950 0.959 7998.66 140.
1.000 1.000 8127.67 140.
0 # noUse (se and 1 don’T use)
"Kurihara et al., J. Chem. Eng. Data 1993, 38, 446"
1 2 11
# Index1 Index2 Index3 NumberOfPoints
0.074 0.119 760. 77.11 # x1 y1 P(mmHg) T(°C).
0.113 0.177 760. 76.48 # Used P(mmHg)=(760/101.325)*P(kPa) and T(°C)=T(K)-273.15
0.195 0.292 760. 75.21
0.238 0.349 760. 74.53
0.329 0.459 760. 73.20
0.424 0.561 760. 71.83
0.529 0.663 760. 70.35
0.581 0.709 760. 69.68
0.682 0.792 760. 68.32
0.717 0.818 760. 67.91
0.935 0.963 760. 65.26

# Reference

Neste arquivo, a separação entre itens deve ser feita com espaços ou tabulações e,
os comentários devem ser precedidos pelo caractere #. A linha 1 informa os componentes
presentes. As linhas de 2 a 7 informam para cada componente, primeiro, o número de
equações de Antoine utilizadas para cada componente e, em seguida, as respectivas
constantes destas equações com sua faixa de temperatura. Caso queira-se desprezar a
pressão de saturação, usa-se o valor 0 para número de equações. Portando, caso isto seja
usado, não se acrescenta as linhas que corresponderiam as respectivas equações de Antoine
para este componente. As linhas 8 e 9 informam os parâmetro r e q do modelo UNIQUAC.
A seguir são informados os dados de equilíbrio, isto é feito da seguinte forma: na primeira
linha (linhas 10 e 25) é utilizada o valor 0 caso os dados desta referência devam ser usados,
senão, usa-se 1; na segunda linha (linhas 11 e 26) cita-se a referência bibliográﬁca dos

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

138

APÊNDICE C. Programa VLE Regression

dados; na terceira linha (12 e 27) informa-se os índices relativos aos componentes (1 para
metanol e 2 para etanol, neste exemplo) presentes nos dados de equilíbrio e em que ordem
eles aparecem e, o número de pontos experimentais; as linhas seguintes (de 13 a 24 e de
28 a 38) informam os dados experimentais, propriamente ditos, iniciando pelos dados da
composição de equilíbrio da fase líquida e depois da fase vapor, cada fase com menos
um componente (que será calculado em função dos dados informados) e na ordem com
que foram apresentados pelos índices na linha anterior, e terminando com a pressão (em
mmHg) e com a temperatura (em °C). Todos os dados numéricos de ponto ﬂutuante devem
utilizar ponto (.) como ponto decimal.

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D – Programa JAFOSSMS

139

Neste apêndice, primeiramente, apresenta-se o ícone do programa (Figura 64) e os
códigos do arquivo Qt Resource, da interface gráﬁca, do widget do matplotlib (componente
da GUI, especiﬁcamente: a área do gráﬁco) e do programa principal. E, por último,
explica-se a formatação dos arquivos com dados de entrada. Todos estes itens, juntos,
constituem o programa JAFOSSMS.

Os códigos apresentados aqui permitem recriar, a partir do conteúdo impresso, o
arquivo original. Para que isso seja possível, é necessário que o texto impresso (incluindo
os espaços à esquerda, na exata quantidade) seja gravado na forma de arquivo de texto
sem formatação, com os respectivos nomes (exceto os de dados de entrada, onde, apenas,
sugere-se que tenham as extensões .in e .dat respectivamente para principal e para
especíﬁco) e, OBRIGATORIAMENTE, com codiﬁcação UTF-8.

D.1 Ícone do Programa

A Figura 64 ilustra a imagem do ícone do programa JAFOSSMS. Esta, para poder
ser utilizada no programa JAFOSSMS, deverá ser copiada e gravada como arquivo de
imagem do tipo Portable Network Graphics (PNG) com tamanho de 512x512 pontos e,
com nome: JAFOSSMS.png.

Figura 64 – Ícone do Programa JAFOSSMS.

Fonte: O autor.

140
D.2 Código Fonte do Arquivo Qt Resource

APÊNDICE D. Programa JAFOSSMS

Form.qrc

<RCC>

<qresource>

<file>JAFOSSMS.png</file>

</qresource>

</RCC>

D.3 Código Fonte da Interface Gráﬁca do Usuário

Form.ui

<?xml version="1.0" encoding="UTF-8"?>
<ui version="4.0">
<class>Form</class>
<widget class="QWidget" name="Form">
<property name="geometry">
<rect>
<x>0</x>
<y>0</y>
<width>835</width>
<height>445</height>
</rect>
</property>
<property name="sizePolicy">
<sizepolicy hsizetype="Minimum" vsizetype="Minimum">
<horstretch>0</horstretch>
<verstretch>0</verstretch>
</sizepolicy>
</property>
<property name="windowTitle">
<string>JAFOSSMS - Solubilidade de Sais em Mistura de Solventes</string>
</property>
<property name="windowIcon">
<iconset resource="Form.qrc">
<normaloff>:/JAFOSSMS.png</normaloff>:/JAFOSSMS.png</iconset>

</property>
<layout class="QVBoxLayout" name="verticalLayout_Form">
<item>
<widget class="QTabWidget" name="tabWidget">
<property name="currentIndex">
<number>0</number>
</property>
<widget class="QWidget" name="tab_GeneralReport">
<attribute name="title">
<string>RELA&amp;TÓRIO GERAL</string>
</attribute>
<layout class="QVBoxLayout" name="verticalLayout_GeneralReport">
<item>
<widget class="QTextEdit" name="textEdit_GeneralReport"/>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_GeneralReport" stretch="4,1,0">
<item>
<widget class="QPushButton" name="pushButton_SaveGeneralReport">
<property name="text">
<string>Gra&amp;var Relatório Geral</string>

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

1
2
3
4
5

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45

APÊNDICE D. Programa JAFOSSMS

141

46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105

</property>
</widget>
</item>
<item>
<widget class="QSlider" name="horizontalSlider_GeneralReport">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Slider_GeneralReport"/>
</item>
</layout>
</item>
</layout>
</widget>
<widget class="QWidget" name="tab_SingleSolvent">
<attribute name="title">
<string>SOLVENTE &amp;SIMPLES</string>
</attribute>
<layout class="QVBoxLayout" name="verticalLayout_SingleSolvent">
<item>
<layout class="QGridLayout" name="gridLayout_Plot1">
<item row="0" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot1_y">
<item>
<widget class="QLabel" name="label_Plot1_y_1">
<property name="text">
<string>Ordenada:</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot1_y_C">
<item>
<property name="text">
<string>Molalidade</string>
</property>
</item>
<item>
<property name="text">
<string>Molaridade</string>
</property>
</item>
<item>
<property name="text">
<string>Fração Molar</string>
</property>
</item>
<item>
<property name="text">
<string>Fração Mássica</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot1_y_2">
<property name="text">

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

142

APÊNDICE D. Programa JAFOSSMS

106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165

<string>do Sal em</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot1_y_solv">
<item>
<property name="text">
<string>MEG</string>
</property>
</item>
<item>
<property name="text">
<string>Água</string>
</property>
</item>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot1_y">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
<item row="0" column="0" rowspan="2">
<widget class="QPushButton" name="pushButton_Plot1">
<property name="sizePolicy">
<sizepolicy hsizetype="Minimum" vsizetype="Expanding">
<horstretch>0</horstretch>
<verstretch>0</verstretch>
</sizepolicy>
</property>
<property name="text">
<string>Gráfico &amp;1</string>
</property>
</widget>
</item>
<item row="1" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot1_x">
<item>
<widget class="QLabel" name="label_Plot1_x">
<property name="text">
<string>Abscissa: Temperatura em</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot1_x_T">
<item>
<property name="text">
<string>Kelvins</string>

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

143

166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225

</property>
</item>
<item>
<property name="text">
<string>Graus Celsius</string>
</property>
</item>
<item>
<property name="text">
<string>Graus Rankine</string>
</property>
</item>
<item>
<property name="text">
<string>Graus Fahrenheit</string>
</property>
</item>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot1_x">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
</layout>
</item>
<item>
<spacer name="verticalSpacer_SingleSolvent">
<property name="orientation">
<enum>Qt::Vertical</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</widget>
<widget class="QWidget" name="tab_MixedSolvents">
<attribute name="title">
<string>&amp;MISTURA DE SOLVENTES</string>
</attribute>
<layout class="QVBoxLayout" name="verticalLayout_MixedSolvents">
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Isotherms">
<item>
<widget class="QLabel" name="label_Isotherms_1">

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

144

APÊNDICE D. Programa JAFOSSMS

226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285

<property name="text">
<string>&amp;Isotermas para</string>
</property>
<property name="buddy">
<cstring>lineEdit_Isotherms</cstring>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Isotherms_mode">
<item>
<property name="text">
<string>Cálculo Normal / Regressão</string>
</property>
</item>
<item>
<property name="text">
<string>Predição</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Isotherms_2">
<property name="text">
<string>em</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Isotherms_T">
<item>
<property name="text">
<string>Kelvins</string>
</property>
</item>
<item>
<property name="text">
<string>Graus Celsius</string>
</property>
</item>
<item>
<property name="text">
<string>Graus Rankine</string>
</property>
</item>
<item>
<property name="text">
<string>Graus Fahrenheit</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLineEdit" name="lineEdit_Isotherms"/>
</item>
<item>
<widget class="QPushButton" name="pushButton_Isotherms_Choose">
<property name="text">
<string>&amp;Escolher</string>

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

145

286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345

</property>
</widget>
</item>
</layout>
</item>
<item>
<widget class="QGroupBox" name="groupBox_Plots">
<property name="title">
<string>Gráficos:</string>
</property>
<layout class="QVBoxLayout" name="verticalLayout_Plots">
<item>
<layout class="QGridLayout" name="gridLayout_Plot2">
<item row="0" column="0" rowspan="2">
<widget class="QPushButton" name="pushButton_Plot2">
<property name="sizePolicy">
<sizepolicy hsizetype="Minimum" vsizetype="Expanding">
<horstretch>0</horstretch>
<verstretch>0</verstretch>
</sizepolicy>
</property>
<property name="text">
<string>Gráfico &amp;2</string>
</property>
</widget>
</item>
<item row="1" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot2_x">
<item>
<widget class="QLabel" name="label_Plot2_x_1">
<property name="text">
<string>Abscissa: Fração</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot2_x_C_SF">
<item>
<property name="text">
<string>Molar</string>
</property>
</item>
<item>
<property name="text">
<string>Mássica</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot2_x_2">
<property name="text">
<string>do</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot2_x_solv">
<item>
<property name="text">

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

146

APÊNDICE D. Programa JAFOSSMS

346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405

<string>MEG</string>
</property>
</item>
<item>
<property name="text">
<string>Água</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot2_x_3">
<property name="text">
<string>Livre de Sal</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot2_x">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
<item row="0" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot2_y">
<item>
<widget class="QLabel" name="label_Plot2_y_1">
<property name="text">
<string>Ordenada: </string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot2_y_C">
<item>
<property name="text">
<string>Molalidade</string>
</property>
</item>
<item>
<property name="text">
<string>Molaridade</string>
</property>
</item>
<item>
<property name="text">
<string>Fração Molar</string>
</property>
</item>
<item>
<property name="text">

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

147

406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465

<string>Fração Mássica</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot2_y_2">
<property name="text">
<string>do Sal em Mistura de Solventes</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot2_y">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
</layout>
</item>
<item>
<widget class="Line" name="line_Plots_1">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<layout class="QGridLayout" name="gridLayout_Plot3">
<item row="0" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot3_y">
<item>
<widget class="QLabel" name="label_Plot3_y_1">
<property name="text">
<string>Ordenada: </string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot3_y_F">
<item>
<property name="text">
<string>Coeficiente de Atividade</string>
</property>
</item>
<item>
<property name="text">
<string>Logaritmo do Coeficiente de Atividade</string>
</property>
</item>
</widget>

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

148

APÊNDICE D. Programa JAFOSSMS

466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525

</item>
<item>
<widget class="QLabel" name="label_Plot3_y_2">
<property name="text">
<string>do Sal em Mistura de Solventes</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot3_y">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
<item row="0" column="0" rowspan="2">
<widget class="QPushButton" name="pushButton_Plot3">
<property name="sizePolicy">
<sizepolicy hsizetype="Minimum" vsizetype="Expanding">
<horstretch>0</horstretch>
<verstretch>0</verstretch>
</sizepolicy>
</property>
<property name="text">
<string>Gráfico &amp;3</string>
</property>
</widget>
</item>
<item row="1" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot3_x">
<item>
<widget class="QLabel" name="label_Plot3_x_1">
<property name="text">
<string>Abscissa: Fração</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot3_x_C_SF">
<item>
<property name="text">
<string>Molar</string>
</property>
</item>
<item>
<property name="text">
<string>Mássica</string>
</property>
</item>
</widget>
</item>
<item>

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

149

526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585

<widget class="QLabel" name="label_Plot3_x_2">
<property name="text">
<string>do</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot3_x_solv">
<item>
<property name="text">
<string>MEG</string>
</property>
</item>
<item>
<property name="text">
<string>Água</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot3_x_3">
<property name="text">
<string>Livre de Sal</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot3_x">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
</layout>
</item>
<item>
<widget class="Line" name="line_Plots_2">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<layout class="QGridLayout" name="gridLayout_Plot4">
<item row="0" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot4_y">
<item>
<widget class="QLabel" name="label_Plot4_y_1">
<property name="text">
<string>Ordenada: </string>
</property>

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

150

APÊNDICE D. Programa JAFOSSMS

586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645

</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot4_y_F_E">
<item>
<property name="text">
<string>Potencial Químico Padrão de Excesso</string>
</property>
</item>
<item>
<property name="text">
<string>Logaritmo de Excesso do Coeficiente de Atividade</string>
</property>
</item>
<item>
<property name="text">
<string>Logaritmo de Excesso da Molalidade</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot4_y_2">
<property name="text">
<string>do Sal em Mistura de Solventes</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot4_y">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</item>
<item row="0" column="0" rowspan="2">
<widget class="QPushButton" name="pushButton_Plot4">
<property name="sizePolicy">
<sizepolicy hsizetype="Minimum" vsizetype="Expanding">
<horstretch>0</horstretch>
<verstretch>0</verstretch>
</sizepolicy>
</property>
<property name="text">
<string>Gráfico &amp;4</string>
</property>
</widget>
</item>
<item row="1" column="1">
<layout class="QHBoxLayout" name="horizontalLayout_Plot4_x">
<item>
<widget class="QLabel" name="label_Plot4_x_1">

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

151

646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705

<property name="text">
<string>Abscissa: Fração</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot4_x_C_SF">
<item>
<property name="text">
<string>Molar</string>
</property>
</item>
<item>
<property name="text">
<string>Mássica</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot4_x_2">
<property name="text">
<string>do</string>
</property>
</widget>
</item>
<item>
<widget class="QComboBox" name="comboBox_Plot4_x_solv">
<item>
<property name="text">
<string>MEG</string>
</property>
</item>
<item>
<property name="text">
<string>Água</string>
</property>
</item>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Plot4_x_3">
<property name="text">
<string>Livre de Sal</string>
</property>
</widget>
</item>
<item>
<spacer name="horizontalSpacer_Plot4_x">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

152

APÊNDICE D. Programa JAFOSSMS

706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765

</layout>
</item>
</layout>
</item>
</layout>
</widget>
</item>
<item>
<spacer name="verticalSpacer_MixedSolvents">
<property name="orientation">
<enum>Qt::Vertical</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
</layout>
</widget>
<widget class="QWidget" name="tab_GraphicAndStatistics">
<attribute name="title">
<string>&amp;GRÁFICO E ESTATÍSTICAS</string>
</attribute>
<layout class="QVBoxLayout" name="verticalLayout_GraphicAndStatistics">
<item>
<widget class="QSplitter" name="splitter_GraphicAndStatistics">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<widget class="QWidget" name="layoutWidget">
<layout class="QVBoxLayout" name="verticalLayout_Graphic">
<item>
<widget class="MplWidget" name="mplWidget_Graphic" native="true">
<property name="sizePolicy">
<sizepolicy hsizetype="Expanding" vsizetype="Expanding">
<horstretch>0</horstretch>
<verstretch>0</verstretch>
</sizepolicy>
</property>
</widget>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Graphic">
<item>
<layout class="QVBoxLayout" name="verticalLayout_Graphic_1">
<item>
<widget class="QCheckBox" name="checkBox_Graphic_NavigationToolbar">
<property name="text">
<string>Barra de &amp;Navegação</string>
</property>
</widget>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Graphic_Legend">
<item>
<widget class="QCheckBox" name="checkBox_Graphic_Legend">
<property name="text">

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

153

766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825

<string>&amp;Legenda:</string>
</property>
</widget>
</item>
<item>
<widget class="QSlider" name="horizontalSlider_Graphic_Legend">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Slider_Graphic_Legend"/>
</item>
</layout>
</item>
</layout>
</item>
<item>
<spacer name="horizontalSpacer_Graphic">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
<property name="sizeHint" stdset="0">
<size>
<width>0</width>
<height>0</height>
</size>
</property>
</spacer>
</item>
<item>
<layout class="QVBoxLayout" name="verticalLayout_Graphic_2">
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Graphic_AxesTicks">
<item>
<widget class="QLabel" name="label_Graphic_AxesTicks">
<property name="text">
<string>Mar&amp;cas nos Eixos:</string>
</property>
<property name="buddy">
<cstring>horizontalSlider_Graphic_AxesTicks</cstring>
</property>
</widget>
</item>
<item>
<widget class="QSlider" name="horizontalSlider_Graphic_AxesTicks">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Slider_Graphic_AxesTicks"/>
</item>
</layout>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Graphic_AxesLabels">
<item>

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

154

APÊNDICE D. Programa JAFOSSMS

826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885

<widget class="QLabel" name="label_Graphic_AxesLabels">
<property name="text">
<string>Rótulos dos &amp;Eixos:</string>
</property>
<property name="buddy">
<cstring>horizontalSlider_Graphic_AxesLabels</cstring>
</property>
</widget>
</item>
<item>
<widget class="QSlider" name="horizontalSlider_Graphic_AxesLabels">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Slider_Graphic_AxesLabels"/>
</item>
</layout>
</item>
</layout>
</item>
</layout>
</item>
</layout>
</widget>
<widget class="QWidget" name="layoutWidget">
<layout class="QVBoxLayout" name="verticalLayout_Statistics">
<item>
<widget class="QTextEdit" name="textEdit_Statistics"/>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Statistics" stretch="4,1,0">
<item>
<widget class="QPushButton" name="pushButton_SaveStatistics">
<property name="text">
<string>Gra&amp;var Estatísticas</string>
</property>
</widget>
</item>
<item>
<widget class="QSlider" name="horizontalSlider_Statistics">
<property name="orientation">
<enum>Qt::Horizontal</enum>
</property>
</widget>
</item>
<item>
<widget class="QLabel" name="label_Slider_Statistics"/>
</item>
</layout>
</item>
</layout>
</widget>
</widget>
</item>
</layout>
</widget>
</widget>

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

155

886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945

</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Datafile">
<item>
<widget class="QLabel" name="label_Datafile">
<property name="text">
<string>Arquivo com &amp;Dados de Entrada:</string>
</property>
<property name="buddy">
<cstring>lineEdit_Datafile</cstring>
</property>
</widget>
</item>
<item>
<widget class="QLineEdit" name="lineEdit_Datafile"/>
</item>
<item>
<widget class="QPushButton" name="pushButton_Datafile_Browse">
<property name="text">
<string>&amp;Procurar</string>
</property>
</widget>
</item>
</layout>
</item>
<item>
<layout class="QHBoxLayout" name="horizontalLayout_Run_Exit">
<item>
<widget class="QPushButton" name="pushButton_Run">
<property name="text">
<string>E&amp;xecutar</string>
</property>
</widget>
</item>
<item>
<widget class="QPushButton" name="pushButton_Exit">
<property name="text">
<string>Sai&amp;r</string>
</property>
</widget>
</item>
</layout>
</item>
</layout>
</widget>
<customwidgets>
<customwidget>
<class>MplWidget</class>
<extends>QWidget</extends>
<header>mplwidget.h</header>
<container>1</container>
</customwidget>
</customwidgets>
<tabstops>
<tabstop>tabWidget</tabstop>
<tabstop>textEdit_GeneralReport</tabstop>
<tabstop>pushButton_SaveGeneralReport</tabstop>
<tabstop>horizontalSlider_GeneralReport</tabstop>
<tabstop>pushButton_Plot1</tabstop>
<tabstop>comboBox_Plot1_y_C</tabstop>

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

156

APÊNDICE D. Programa JAFOSSMS

<tabstop>comboBox_Plot1_y_solv</tabstop>
<tabstop>comboBox_Plot1_x_T</tabstop>
<tabstop>comboBox_Isotherms_mode</tabstop>
<tabstop>comboBox_Isotherms_T</tabstop>
<tabstop>lineEdit_Isotherms</tabstop>
<tabstop>pushButton_Isotherms_Choose</tabstop>
<tabstop>pushButton_Plot2</tabstop>
<tabstop>comboBox_Plot2_y_C</tabstop>
<tabstop>comboBox_Plot2_x_C_SF</tabstop>
<tabstop>comboBox_Plot2_x_solv</tabstop>
<tabstop>pushButton_Plot3</tabstop>
<tabstop>comboBox_Plot3_y_F</tabstop>
<tabstop>comboBox_Plot3_x_C_SF</tabstop>
<tabstop>comboBox_Plot3_x_solv</tabstop>
<tabstop>pushButton_Plot4</tabstop>
<tabstop>comboBox_Plot4_y_F_E</tabstop>
<tabstop>comboBox_Plot4_x_C_SF</tabstop>
<tabstop>comboBox_Plot4_x_solv</tabstop>
<tabstop>checkBox_Graphic_NavigationToolbar</tabstop>
<tabstop>checkBox_Graphic_Legend</tabstop>
<tabstop>horizontalSlider_Graphic_Legend</tabstop>
<tabstop>horizontalSlider_Graphic_AxesTicks</tabstop>
<tabstop>horizontalSlider_Graphic_AxesLabels</tabstop>
<tabstop>textEdit_Statistics</tabstop>
<tabstop>pushButton_SaveStatistics</tabstop>
<tabstop>horizontalSlider_Statistics</tabstop>
<tabstop>lineEdit_Datafile</tabstop>
<tabstop>pushButton_Datafile_Browse</tabstop>
<tabstop>pushButton_Run</tabstop>
<tabstop>pushButton_Exit</tabstop>
</tabstops>
<resources>
<include location="Form.qrc"/>
</resources>
<connections/>
</ui>

D.4 Código Fonte do widget do matplotlib

mplwidget.py

from matplotlib import use, rcParams
use("Qt4Agg")
rcParams[’mathtext.fontset’] = ’stix’
rcParams[’backend.qt4’] = ’PySide’
rcParams.update({’figure.autolayout’: True})
from matplotlib.backends.backend_qt4agg import (FigureCanvasQTAgg as FigureCanvas,

NavigationToolbar2QT as NavigationToolbar)

from matplotlib.figure import Figure
from PySide.QtGui import QWidget, QVBoxLayout

class MplCanvas(FigureCanvas):

def __init__(self):

self.fig = Figure()
self.ax = self.fig.add_subplot(111)
FigureCanvas.__init__(self, self.fig)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17

157

APÊNDICE D. Programa JAFOSSMS

FigureCanvas.updateGeometry(self)

class MplWidget(QWidget):

def __init__(self, parent = None):
QWidget.__init__(self, parent)
self.canvas = MplCanvas()
self.vbl = QVBoxLayout()
self.vbl.addWidget(self.canvas)
self.navbar = NavigationToolbar(self.canvas, self)
self.vbl.addWidget(self.navbar)
self.setLayout(self.vbl)

D.5 Código Fonte do Programa Principal

JAFOSSMS.py

#!/usr/bin/env python
# -*- coding: utf-8 -*-
from __future__ import division
from decimal import Decimal, Context
from numpy import abs, append, array, asarray, concatenate, exp, linspace, log, random, sqrt
from PySide.QtCore import QFile, QFileInfo, QRegExp, Qt, QTextStream, SLOT
from PySide.QtGui import (qApp, QApplication, QCheckBox, QDialog, QDialogButtonBox, QFileDialog,

QGridLayout, QRegExpValidator, QTextBlockFormat, QTextCharFormat, QTextDocument,
QTextTableFormat)

from scipy.optimize import curve_fit, fsolve
import matplotlib.lines as mlines
import matplotlib.patches as mpatches
import matplotlib.ticker as tkr
import re
import scipy.stats as stats
import sys
import ui_Form

ALIGN = { ’L’: Qt.AlignLeft, ’C’: Qt.AlignCenter, ’R’: Qt.AlignRight }
DP, COLORS = ’,’, ’rygcbm’
MARKERS = [[’o’, 8], [’*’, 10], [’s’, 7], [’d’, 9], [’^’, 8], [’p’, 9], [’v’, 8]]
REG_EXP = ’(([+-]?((\d*[’+DP+’]?\d+)|(\d+[’+DP+’]?\d*)))\s)*’
MODE, TYPES = [u’Regressão’, u’Predição’], [’str’, ’unicode’, ’int’, ’float’]
UNITS_T = [’K’, u’°C’, u’°R’, u’°F’]
M_H2O = 0.018015 # kg·mol^(-1) - LIDE e HAYNES, 2009
M_MEG = 0.062068 # kg·mol^(-1) - LIDE e HAYNES, 2009
R = 8.314472 # J·K^(-1)·mol^(-1) - LIDE e HAYNES, 2009

multAppend = lambda *_: map(lambda __: __[0].append(__[1]), zip(_[::2],_[1::2]))
multToArray = lambda *_: map(array, _)
strTo = lambda s, t: s if t == ’str’ else eval(t)(s.replace(DP, ’.’))
map_strTo = lambda l, t: map(strTo, l, [t]*len(l))
toStr = lambda x: unicode(x).replace(’.’, DP)
decimalPlaces0 = lambda x: -Decimal(str(x)).as_tuple().exponent
decimalPlaces = lambda x: decimalPlaces0(x) if decimalPlaces0(x) > 0 else 1
setDecimalPlaces = lambda x, N: toStr(Decimal(x).quantize(Decimal(10)**-N))
setDecimalPlacesPercent = lambda x, N: setDecimalPlaces(x*100, N)+’%’
significantFigures = lambda x, N: Context(prec=N).create_decimal(x)
setSignificantFigures = lambda x, N: toStr(setDecimalPlaces(significantFigures(x, N),

decimalPlaces(significantFigures(x, N))))

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

18
19
20
21
22
23
24
25
26
27
28
29
30

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40

158

APÊNDICE D. Programa JAFOSSMS

setSignificantFiguresPercent = lambda x, N: setSignificantFigures(x*100, N)+’%’

def f_gen(s):

i, n = 0, len(s)
while True:

yield s[i%n]
i += 1

def convertT(T, i):

=> Não converte

# Converte temperaturas de K para °C/°R/°F ou vice-versa
# i = 0/4
# i = 1/2/3 => Kelvins para graus Celsius/Rankine/Fahrenheit
# i = 5/6/7 => graus Celsius/Rankine/Fahrenheit para kelvins
return [T, T-273.15, T*1.8, T*1.8 - 459.67, T, T+273.15, T/1.8, (T+459.67) / 1.8][i]

class htlmlTags:

def __init__(self):

self.b = lambda s: ’<b>’+s+’</b>’
self.i = lambda s: ’<i>’+s+’</i>’
self.u = lambda s: ’<u>’+s+’</u>’
self.bi = lambda s: self.b(self.i(s))
self.bu = lambda s: self.b(self.u(s))
self.sub = lambda s: ’<sub>’+s+’</sub>’
self.sup = lambda s: ’<sup>’+s+’</sup>’
self.center = lambda s: ’<center>’+s+’</center>’
self.div = lambda s, bc, c: ’<div style="background-color:’+bc+’;color:’+c+’;">’+s+’</div>’
self.title = lambda s, bc, c: self.center(self.div(self.bu(s), bc, c))+’<br>’

class chooseIsotherms(QDialog):

def __init__(self, lineEdit, i_T, i_mode):
super(chooseIsotherms, self).__init__()
self.setWindowTitle(’Escolha as isotermas para a ’+MODE[i_mode])
self.lineEdit = lineEdit
T = list(convertT([T_reg, T_prd][i_mode], i_T))
T_set = set(map_strTo(lineEdit.text().split(), ’float’))
T_sorted = sorted(set(T) | T_set)
layout, self.checkBoxs, ncols = QGridLayout(), [], 3
for col in range(ncols):

row = 0
for T_ in T_sorted[col::ncols]:

n = T.count(T_)
checkBox = QCheckBox((toStr(T_)+’ ’+UNITS_T[i_T]+’ (’+(str(n) if n > 0 else
’nenhum’)+[’ ponto experimental’, ’ pontos experimentais’][n > 1]+’)’))

checkBox.setChecked(T_ in T_set)
self.checkBoxs.append(checkBox)
layout.addWidget(checkBox, row, col)
row += 1

buttonBox = QDialogButtonBox(QDialogButtonBox.Cancel | QDialogButtonBox.Ok)
layout.addWidget(buttonBox, row+1, 0, 1, ncols)
buttonBox.accepted.connect(self.accept)
buttonBox.rejected.connect(self.reject)
self.setLayout(layout)

def accept(self):

self.lineEdit.setText(’ ’.join([checkBox.text().split()[0] for checkBox in self.checkBoxs

if checkBox.isChecked()]))

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

APÊNDICE D. Programa JAFOSSMS

159

QDialog.accept(self)

def reject(self):

QDialog.reject(self)

class JAFOSSMS(QDialog, ui_Form.Ui_Form):

def __init__(self):

super(JAFOSSMS, self).__init__()
self.setupUi(self)
global canvas, h, comboBoxs, sliders
canvas, h = self.mplWidget_Graphic.canvas, htlmlTags()
comboBoxs = [self.comboBox_Plot1_x_T, self.comboBox_Plot1_y_C, self.comboBox_Plot1_y_solv,

self.comboBox_Isotherms_mode, self.comboBox_Isotherms_T, self.comboBox_Plot2_x_C_SF,
self.comboBox_Plot2_x_solv, self.comboBox_Plot2_y_C, self.comboBox_Plot3_x_C_SF,
self.comboBox_Plot3_x_solv, self.comboBox_Plot3_y_F, self.comboBox_Plot4_x_C_SF,
self.comboBox_Plot4_x_solv, self.comboBox_Plot4_y_F_E]

sliders = [self.horizontalSlider_GeneralReport,

self.horizontalSlider_Statistics,
self.horizontalSlider_Graphic_Legend, self.horizontalSlider_Graphic_AxesTicks,
self.horizontalSlider_Graphic_AxesLabels]

for slider, min_, max_ in zip(sliders, [6, 6, 8, 8, 10], [18, 18, 20, 20, 22]):

slider.setMinimum(min_)
slider.setMaximum(max_)

self.horizontalSlider_GeneralReport.valueChanged.connect(lambda: self.changeSize(0))
self.horizontalSlider_Statistics.valueChanged.connect(lambda: self.changeSize(1))
self.horizontalSlider_Graphic_Legend.valueChanged.connect(lambda: self.changeSize(2))
self.horizontalSlider_Graphic_AxesTicks.valueChanged.connect(lambda: self.changeSize(3))
self.horizontalSlider_Graphic_AxesLabels.valueChanged.connect(lambda: self.changeSize(4))
self.setAttribute(Qt.WA_DeleteOnClose)
self.setWindowFlags(Qt.WindowMinMaxButtonsHint|Qt.WindowCloseButtonHint)
self.initializeAll()
self.tableformat = QTextTableFormat()
self.tableformat.setCellPadding(2)
self.tableformat.setCellSpacing(1)
self.headerformat = QTextCharFormat()
self.brush = self.headerformat.background()
self.brush.setColor(Qt.lightGray)
self.brush.setStyle(Qt.SolidPattern)
self.headerformat.setBackground(self.brush)
self.headerformat.setVerticalAlignment(QTextCharFormat.AlignMiddle)
self.blockFormat = QTextBlockFormat()
self.blockFormat.setRightMargin(10)
self.blockFormat.setLeftMargin(10)
self.textDocument_GeneralReport = QTextDocument()
self.textDocument_Statistics = QTextDocument()
self.textEdit_GeneralReport.setDocument(self.textDocument_GeneralReport)
self.textEdit_GeneralReport.setFont(’Courier’)
self.textEdit_Statistics.setDocument(self.textDocument_Statistics)
self.textEdit_Statistics.setFont(’Courier’)
self.checkBox_Graphic_Legend.stateChanged.connect(lambda: self.changeSize(2))
self.checkBox_Graphic_NavigationToolbar.stateChanged.connect(self.showNavigationToolbar)
for comboBox in comboBoxs:

comboBox.currentIndexChanged.connect(self.clearGraphicsAndStatistics)

self.comboBox_Isotherms_mode.currentIndexChanged.connect(self.clearIsotherms)
self.comboBox_Isotherms_T.currentIndexChanged[int].connect(self.validateIsotherms)
validator = QRegExpValidator(QRegExp(REG_EXP), self.lineEdit_Isotherms)
self.lineEdit_Datafile.returnPressed.connect(self.existDatafile)
self.lineEdit_Isotherms.lostFocus.connect(lambda: self.validateIsotherms(last_i_T))
self.lineEdit_Isotherms.setValidator(validator)

101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

160

APÊNDICE D. Programa JAFOSSMS

161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220

self.pushButton_Datafile_Browse.clicked.connect(self.browse)
self.pushButton_Exit.clicked.connect(qApp, SLOT("quit()"))
self.pushButton_Isotherms_Choose.clicked.connect(self.chooseIsotherms)
self.pushButton_Plot1.clicked.connect(lambda: self.f_plot(0))
self.pushButton_Plot2.clicked.connect(lambda: self.f_plot(1))
self.pushButton_Plot3.clicked.connect(lambda: self.f_plot(2))
self.pushButton_Plot4.clicked.connect(lambda: self.f_plot(3))
self.pushButton_Run.clicked.connect(self.runCalculations)
self.pushButton_SaveGeneralReport.clicked.connect(self.saveGeneralReport)
self.pushButton_SaveStatistics.clicked.connect(self.saveStatistics)

def initializeAll(self):

global handles, labels, last_i_T
handles, labels, last_i_T = [], [], 0
self.textEdit_GeneralReport.clear()
for comboBox in comboBoxs:

comboBox.setCurrentIndex(0)
self.lineEdit_Isotherms.clear()
self.groupBox_Plots.setEnabled(False)
self.checkBox_Graphic_NavigationToolbar.setChecked(True)
self.checkBox_Graphic_Legend.setChecked(True)
for slider, size in zip(sliders, [12, 8, 12, 14, 16]):

slider.setValue(size)

self.label_Slider_GeneralReport,
self.pushButton_Run.setEnabled(False)
self.tabWidget.setEnabled(False)
self.tabWidget.setCurrentIndex(0)
self.tabWidget.setTabEnabled(3, False)

def clearIsotherms(self):

self.lineEdit_Isotherms.clear()

def chooseIsotherms(self):

dialog = chooseIsotherms(self.lineEdit_Isotherms, last_i_T,

self.comboBox_Isotherms_mode.currentIndex())

dialog.exec_()
self.validateIsotherms(last_i_T)

def validateIsotherms(self, i_T):

global last_i_T
T = array(sorted(set(map_strTo(self.lineEdit_Isotherms.text().split(), ’float’))))
T_in_kelvins = convertT(T, 4+last_i_T)
T_in_kelvins = T_in_kelvins[T_in_kelvins >= 0]
if i_T is None:

return T_in_kelvins

self.lineEdit_Isotherms.setText(’ ’.join(map(toStr, convertT(T_in_kelvins, i_T))))
self.groupBox_Plots.setEnabled(self.lineEdit_Isotherms.text() != ’’)
self.clearGraphicsAndStatistics()
last_i_T = i_T

def changeSize(self, i):

if i in [0, 1]:

te = [self.textEdit_GeneralReport, self.textEdit_Statistics][i]
label = [self.label_Slider_GeneralReport, self.label_Slider_Statistics][i]
slider = [self.horizontalSlider_GeneralReport, self.horizontalSlider_Statistics][i]
cursor = te.textCursor()
oldPosition = cursor.position()
te.selectAll()
size = slider.value()
te.setFontPointSize(size)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

161

221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280

label.setNum(size)
cursor.setPosition(oldPosition)
te.setTextCursor(cursor)

else:

size = self.horizontalSlider_Graphic_Legend.value()
leg = canvas.ax.legend(handles, labels, loc=0, fontsize=size, fancybox=True,

shadow=True)

leg.draggable(state=True, use_blit=True)
vis = self.checkBox_Graphic_Legend.isChecked()
canvas.ax.get_legend().set_visible(vis)
self.horizontalSlider_Graphic_Legend.setEnabled(vis)
self.label_Slider_Graphic_Legend.setEnabled(vis)
self.label_Slider_Graphic_Legend.setNum(size)
f_tkr_x = lambda x, pos: setDecimalPlaces(x, max(map(decimalPlaces,

canvas.ax.xaxis.get_ticklocs())))

f_tkr_y = lambda y, pos: setDecimalPlaces(y, max(map(decimalPlaces,

canvas.ax.yaxis.get_ticklocs())))

canvas.ax.xaxis.set_major_formatter(tkr.FuncFormatter(f_tkr_x))
canvas.ax.yaxis.set_major_formatter(tkr.FuncFormatter(f_tkr_y))
size = self.horizontalSlider_Graphic_AxesTicks.value()
canvas.ax.tick_params(axis=’both’, which=’major’, labelsize=size)
self.label_Slider_Graphic_AxesTicks.setNum(size)
size = self.horizontalSlider_Graphic_AxesLabels.value()
canvas.ax.xaxis.label.set_size(size)
canvas.ax.yaxis.label.set_size(size)
self.label_Slider_Graphic_AxesLabels.setNum(size)
canvas.draw()

def showNavigationToolbar(self):

if self.checkBox_Graphic_NavigationToolbar.isChecked():

self.mplWidget_Graphic.navbar.show()

else:

self.mplWidget_Graphic.navbar.hide()

def clearGraphicsAndStatistics(self):

self.tabWidget.setTabEnabled(3, False)

def existDatafile(self):

if QFile.exists(self.lineEdit_Datafile.text()):

self.initializeAll()
self.pushButton_Run.setEnabled(True)

def browse(self):

fileName = QFileDialog.getOpenFileName(self, ’Procurando Arquivo com Dados de Entrada’,

’.’, ’Dados de Entrada(*.in);;Todos os Arquivos (*.*)’)[0]

if fileName:

self.lineEdit_Datafile.setText(fileName)
self.initializeAll()
self.pushButton_Run.setEnabled(True)

def saveGeneralReport(self):

fileName = QFileDialog.getSaveFileName(self, u’Gravando Relatório Geral’, ’.’,

’Arquivo HTML (*.html);;Todos os Arquivos (*.*)’)[0]

if fileName:

data = QFile(fileName)
if data.open(QFile.WriteOnly | QFile.Text):

QTextStream(data) << self.textDocument_GeneralReport.toHtml(encoding=’utf-8’)

def saveStatistics(self):

fileName = QFileDialog.getSaveFileName(self, u’Gravando Estatísticas’, ’.’,

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

162

APÊNDICE D. Programa JAFOSSMS

281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340

’Arquivo HTML (*.html);;Todos os Arquivos (*.*)’)[0]

if fileName:

data = QFile(fileName)
if data.open(QFile.WriteOnly | QFile.Text):

QTextStream(data) << self.textDocument_Statistics.toHtml(encoding=’utf-8’)

def linearMixingRule(self, property_1, property_2, fraction_2):

# Regra de Mistura Binária Linear com a Fração
fraction_1 = 1-fraction_2
return fraction_1*property_1 + fraction_2*property_2

def excessProperty(self, property_real, property_ideal):

# Calcula uma Propriedade de Excesso
return property_real-property_ideal

def rho_and_epsilon_r_of_pures(self, T, i=0):

# Calcula as Densidades Absolutas e as Constantes Dielétricas
# dos solventes puros
# GREEN e PERRY, 2007
tau = 1 - T/647.096
rho_H2O = (17863 + 58606*tau**.35 - 95396*tau**(2/3) + 213890*tau - 141260*tau**(4/3)

) * M_H2O

rho_MEG = (1315 / (.25125**(1 + (1 - T/720)**.21868))) * M_MEG
if i:

return rho_H2O, rho_MEG

# ÅKERLÖF, 1932
epsilon_r_H2O = 10**(1.9051 - .00205*(T-293.15))
epsilon_r_MEG = 10**(1.5872 - .00224*(T-293.15))
return rho_H2O, rho_MEG, epsilon_r_H2O, epsilon_r_MEG

def rho_and_epsilon_r_of_mixing(self, rho_H2O, rho_MEG, epsilon_r_H2O, epsilon_r_MEG,

x_MEG_SF, T, i=0):

# Calcula a Densidade Absoluta e a Constante Dielétrica da
# mistura de solventes
x_H2O_SF = 1-x_MEG_SF
w_MEG_SF = x_MEG_SF*M_MEG / (x_H2O_SF*M_H2O + x_MEG_SF*M_MEG)
# Regra de Mistura
rho_H2O_MEG = 1/self.linearMixingRule(1/rho_H2O, 1/rho_MEG, w_MEG_SF)
if i:

return rho_H2O_MEG

# JOUYBAN, SOLTANPOUR e CHAN, 2004
epsilon_r_H2O_MEG = exp(x_H2O_SF*log(epsilon_r_H2O) + x_MEG_SF*log(epsilon_r_MEG) +

x_H2O_SF*x_MEG_SF/T * (153.6 + 57.3*(x_H2O_SF-x_MEG_SF)))

return rho_H2O_MEG, epsilon_r_H2O_MEG

def A_phi_H2O(self, T):

# Calcula a Constante de Debye-Hückel para a água
# => CHEN, BRITT, et al., 1982
return (-61.44534*exp((T-273.15)/273.15) + 2.864468*exp(2*(T-273.15)/273.15) + 183.5379*

log(T/273.15) - .6820223*(T-273.15) + .0007875695*(T**2 - 273.15**2) +
58.95788*(273.15/T))

def A_phi_solv(self, A_phi_H2O, rho_H2O, epsilon_r_H2O, rho_solv, epsilon_r_solv):

# Calcula Constante de Debye-Hückel para outros solventes
return ((rho_solv/rho_H2O)**0.5 * (epsilon_r_H2O/epsilon_r_solv)**1.5 * A_phi_H2O)

def Pitzer_parameters(self, T):

# Calcula os parâmetros do Modelo de Pitzer em H2O:
# => beta0_MX_H2O, beta1_MX_H2O e C_phi_MX_H2O
Tr = 298.15 # K

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

163

if MX == ’NaCl’: # SILVESTER e PITZER, 1977

q = array([[.0765, -777.03, -4.4706, .008946, -3.3158e-6], [.2664, 0, 0, 6.1608e-5,

1.0715e-6], [.00127, 33.317, 0.09421, -4.655e-5, 0]])

return (q[i,0] + q[i,1]*(1/T - 1/Tr) + q[i,2]*log(T/Tr) + q[i,3]*(T-Tr) +

q[i,4]*(T**2 - Tr**2) for i in range(3))

elif MX == ’KCl’: # ARCHER, 1999

b = array([[.413229483398493, -.0870121476114027, .101413736179231, -.0199822538522801,

-.0998120581680816, 0], [.206691413598171, .102544606022162, 0, 0, 0,
-.00188349608000903], [-.00133515934994478, 0, 0, .00234117693834228,
-.00075896583546707, 0]])

return (b[i,0] + 1e-2*b[i,1]*(T-Tr) + 1e-5*b[i,2]*(T-Tr)**2 + 1e2*b[i,3]/(T-225) +

1e3*b[i,4]/T + 1e6*b[i,5]/(T-225)**3 for i in range(3))

def Pitzer_parameters_in_mixtures(self, beta0_MX_H2O, beta1_MX_H2O, beta1_MX_MEG,

epsilon_r_H2O, epsilon_r_MEG, epsilon_r_H2O_MEG, C_phi_MX_H2O):

# Calcula os parâmetros do Modelo de Pitzer em mistura H2O-MEG:
# => beta0_MX_H2O_MEG, beta1_MX_H2O_MEG e C_phi_MX_H2O_MEG
# => LORIMER, 1993
A = log(beta1_MX_H2O/beta1_MX_MEG) / log(epsilon_r_H2O/epsilon_r_MEG)
B = log(beta1_MX_H2O) - A*log(epsilon_r_H2O)
return beta0_MX_H2O, exp(A*log(epsilon_r_H2O_MEG) + B), C_phi_MX_H2O

def ln_gamma_MX(self, b_MX, A_phi, beta0_MX, beta1_MX, C_phi_MX):

# Calcula o Coeficiente de Atividade pelo Modelo de Pitzer
# => PITZER, 1973
alpha, b_, b_M, b_X = 2, 1.2, nu_M*b_MX, nu_X*b_MX
I_b = (b_M*z_M**2 + b_X*z_X**2) / 2
sqrt_I_b = sqrt(I_b)
f_gamma_MX = -A_phi*(2/b_*log(1 + b_*sqrt_I_b) + sqrt_I_b/(1 + b_*sqrt_I_b))
B_gamma_MX = 2*(beta0_MX + beta1_MX*(1 - (1 + alpha*sqrt_I_b - .5*alpha**2*I_b)*exp(-alpha*

sqrt_I_b)) / (alpha**2*I_b))

C_gamma_MX = 1.5*C_phi_MX
return abs(z_M*z_X)*f_gamma_MX + 2*b_MX*nu_M*nu_X/nu*(B_gamma_MX + b_MX*sqrt(nu_M*nu_X)*

C_gamma_MX)

def ln_gamma_MX_in_MEG(self, ln_gamma_MX_in_H2O, b_MX_in_H2O, b_MX_in_MEG, T):

# Calcula o Coeficiente de Atividade do sal em MEG
# => LORIMER, 1993
return (ln_gamma_MX_in_H2O + log(b_MX_in_H2O/b_MX_in_MEG) - Delta_tr_G0_H2O_to_MEG /

(nu*R*T))

def b_MX_in_H2O_MEG(self, i, C_MX, C_H2O_MEG=None):

# Normaliza para Molalidade do Sal na mistura de solventes
# i = 0 => m_MX (g), m_H2O_MEG (g)
if i: # w_MX_in_H2O_MEG_MX

C_H2O_MEG = 1-C_MX

return C_MX/M_MX/C_H2O_MEG

def x_MEG_SF(self, i, C_H2O, C_MEG=None):

# Normaliza para Fração Molar de MEG Livre de Sal
# i = 0 => m_H2O (g), m_MEG (g)
if i:

if i == 1: # w_H2O_SF_in_H2O_MEG

C_MEG = 1-C_H2O

else: # w_MEG_SF_in_H2O_MEG

C_H2O, C_MEG = 1-C_H2O, C_H2O

return C_MEG/M_MEG / (C_H2O/M_H2O + C_MEG/M_MEG)

def convertC(self, b_MX_in_H2O_MEG, x_MEG_SF, T, i):

if i:

341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

164

APÊNDICE D. Programa JAFOSSMS

401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460

if i == 1: # Converte Molalidade para Molaridade

rho_H2O, rho_MEG = self.rho_and_epsilon_r_of_pures(T, 1)
rho_H2O_MEG = self.rho_and_epsilon_r_of_mixing(rho_H2O, rho_MEG, None, None,

x_MEG_SF, T, 1)

return b_MX_in_H2O_MEG*rho_H2O_MEG/1000

elif i == 2: # Converte Molalidade para Fração Molar

x_H2O_SF = 1-x_MEG_SF
return b_MX_in_H2O_MEG / (1/(x_H2O_SF*M_H2O + x_MEG_SF*M_MEG) +

b_MX_in_H2O_MEG)

else: # Converte Molalidade para Fração Mássica

return b_MX_in_H2O_MEG / (1/M_MX + b_MX_in_H2O_MEG)

return b_MX_in_H2O_MEG # Não converte

def convertC_SF(self, x_MEG_SF, i):

x_H2O_SF = 1-x_MEG_SF
if i: # Converte para Fração Mássica Livre de Sal

return x_MEG_SF / (x_H2O_SF*M_H2O/M_MEG + x_MEG_SF)

return x_MEG_SF # Não converte

def printText(self, text, i=0):

[self.textEdit_GeneralReport, self.textEdit_Statistics][i].textCursor().insertHtml(text)

def printVars(self, *args):

n = len(args)
r = n%3
i = int(r != 0)*int(args[-1] != 0)
for name, value, unit in zip(*[args[_:-3:3] for _ in range(3)]):

text = toStr(value) if type(value) == float else unicode(value)
self.printText(h.b(name)+’ = ’+text+(’ ’+unit)*bool(unit)+’<br>’, i)

name, value, unit = args[-3-r:n-r]
text = toStr(value) if type(value) == float else unicode(value)
self.printText(h.b(name)+’ = ’+text+(’ ’+unit)*bool(unit), i)

def createTable(self, nrows, ncols, nHeaderLines=1, mergedLines=[], brushedLines=[], i=0):

self.tableformat.setHeaderRowCount(nHeaderLines)
table = [self.textEdit_GeneralReport, self.textEdit_Statistics][i].textCursor().\

insertTable(nrows+1, ncols, self.tableformat)

for (r, c, nr, nc) in mergedLines:
table.mergeCells(r, c, nr, nc)

if brushedLines:

for (r, c) in brushedLines:

self.writeCell(table, r, c, ’’, format_=self.headerformat)

else:

for r in range(nHeaderLines):

for c in range(ncols):

self.writeCell(table, r, c, ’’, format_=self.headerformat)

return table

def writeCell(self, table, row, col, text, align=’C’, format_=None):

cell = table.cellAt(row, col)
if format_:

cell.setFormat(format_)

self.blockFormat.setAlignment(ALIGN[align])
cell.firstCursorPosition().setBlockFormat(self.blockFormat)
cellCursor = cell.firstCursorPosition()
cellCursor.insertHtml(text)

def writeLineInTable(self, table, row, col, line, align_orientation=’Rv’):

align_, orientation = align_orientation[0], align_orientation[1]
for i, text in enumerate(line):

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

165

461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520

if orientation == ’v’:

self.writeCell(table, row+i, col, text, align_)

else:

self.writeCell(table, row, col+i, text, align_)

def printVectors(self, *args):

n = len(args)-1
r = n%3
i = int(r != 0)*int(args[-1] != 0)
formats = args[0]
names, vectors, units = (args[_+1::3] for _ in range(3))
nrows, ncols = len(vectors[0]), len(vectors)
table = self.createTable(nrows, ncols, i=i)
for col in range(ncols):

text = ’<b>’+names[col]+(’ (’+units[col]+’)’)*bool(units[col])+’</b>’
self.writeCell(table, 0, col, text)
vector, format_ = vectors[col], formats[col]
align, type_, N = format_[0], format_[1], int(format_[2:])
# ’format_[0]’:
# ’L’ => esquerda
# ’C’ => centro
# ’R’ => direita
# ’format_[1]’:
# ’f’ => ’float’
# ’i’ => ’int’
# ’s’ => ’str’
# ’format_[2:]’:
# < 0 => ’float’ arredondado (’-N’ casas decimais);
#
# > 0 => ’float’ arredondado (’N’ dígitos significativos)
if type_ in [’f’, ’%’]:

0 => ’float’ não arrendondado;

if N < 0:
N = -N

elif N == 0:

N = max(map(decimalPlaces, vector))

elif N > 0:

N = max(map(lambda x: decimalPlaces(strTo(setSignificantFigures(x, N)),

’float’), vector))

for row, value in enumerate(vector):

if type_ == ’f’:

self.writeCell(table, row+1, col, setDecimalPlaces(value, N), align)

else:

self.writeCell(table, row+1, col, setDecimalPlacesPercent(value, N), align)

else:

for row, value in enumerate(vector):

self.writeCell(table, row+1, col, str(value), align)

def readDataFile(self, fileName):

f = QFile(fileName)
if f.open(QFile.ReadOnly | QFile.Truncate | QFile.Text):

inStream = QTextStream(f)
inStream.setCodec(’utf-8’)
lines = inStream.readAll().splitlines()

f.close()
values, vectors = [], []
for line in lines:

args = [arg.strip() for arg in line.split(’;’)]
type_ = args[0]
if type_:

for vector in vectors:

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

166

APÊNDICE D. Programa JAFOSSMS

521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580

if vector[0] in TYPES:

values.append(map_strTo(vector[3:], vector[0]))
if vector[2]:

values.append(vector[2])

vectors = []
if type_ in TYPES:

values.append(strTo(args[2], type_))
if args[3:4]:

values.append(args[3])

elif type_ == ’vectors’:

vectors.extend([[i] for i in args[1:]])

else:

for i, vector in enumerate(args[1:]):

vectors[i].append(vector)

for vector in vectors:

if vector[0] in TYPES:

values.append(map_strTo(vector[3:], vector[0]))
if vector[2]:

values.append(vector[2])

return values

def readDataset(self):

global ions, MX, z_M, z_X, nu_M, nu_X, M_MX, Delta_tr_G0_H2O_to_MEG
(ions, z_M, z_X, nu_M, nu_X, M_MX, units_M_MX, Delta_tr_G0_H2O_to_MEG,

units_Delta_tr_G0_H2O_to_MEG, data_filenames) = \

self.readDataFile(self.lineEdit_Datafile.text())

f = lambda s, nu: [s, ’(’+s+’)’][bool(re.search(r’\d’, s) and nu > 1)]+str(nu)*(nu > 1)
MX = f(ions[0], nu_M)+f(ions[1], nu_X)
global nu
nu, fileInfo = nu_M+nu_X, QFileInfo(self.lineEdit_Datafile.text())
self.printText(h.b(’Arquivo com Dados de Entrada’)+’: ’+fileInfo.fileName()+’<br>’)
self.printVars(’MX’, MX, ’’, h.i(’z’)+h.sub(ions[0]), z_M, ’’, h.i(’z’)+h.sub(ions[1]),

z_X, ’’, u’ν’+h.sub(ions[0]), nu_M, ’’, u’ν’+h.sub(ions[1]), nu_X, ’’, h.i(’M’)+
h.sub(MX), M_MX, units_M_MX, u’δ’+h.sub(’tr’)+h.i(’G’)+h.sup(’0’)+
h.sub(’H2O para MEG’), Delta_tr_G0_H2O_to_MEG, units_Delta_tr_G0_H2O_to_MEG)

global BibRef
global iBibRef_reg, x_MEG_SF_reg, b_MX_in_H2O_MEG_reg, T_reg
global iBibRef_prd, x_MEG_SF_prd, b_MX_in_H2O_MEG_prd, T_prd
BibRef, iBibRef, iBibRef_reg, iBibRef_prd = [], 0, [], []
(x_MEG_SF_reg, x_MEG_SF_prd, b_MX_in_H2O_MEG_reg, b_MX_in_H2O_MEG_prd, T_reg,

T_prd) = [], [], [], [], [], []
for data_filename in data_filenames:

self.printText(’<br>’)
data = self.readDataFile(fileInfo.path()+’/’+data_filename)
BibRef.append(data[0])
self.printText(’<br>’+h.b(’Arquivo de Dados’)+’: ’+data_filename+’<br>’+h.b(

u’Referência’)+’: ’+BibRef[-1])

dataType = data[1]
data = map(lambda _: asarray(_) if type(_) != str and type(_) != unicode else _, \

data[2:])

if dataType == 1:

# w_MEG_SF, m_H2O_MEG (g), m_MX (g), T (°C)
w_MEG_SF, m_H2O_MEG, units_m_H2O_MEG, m_MX, units_m_MX, T, units_T, use = data
self.printVectors([’Rf0’]*4+[’Ls0’], h.i(’w’)+"’"+h.sub(’MEG’), w_MEG_SF, ’’,
h.i(’m’)+h.sub(’H2O+MEG’), m_H2O_MEG, units_m_H2O_MEG, h.i(’m’)+h.sub(MX),
m_MX, units_m_MX, h.i(’T’), T, units_T, ’use’, use, ’’)

x_MEG_SF = self.x_MEG_SF(2, w_MEG_SF)
b_MX_in_H2O_MEG = self.b_MX_in_H2O_MEG(0, m_MX, m_H2O_MEG)
T += 273.15

elif dataType == 2:

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

167

581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640

# w_MEG_SF, w_MX, T (°C)
w_MEG_SF, w_MX, T, units_T, use = data
self.printVectors([’Rf0’]*3+[’Ls0’], h.i(’w’)+"’"+h.sub(’MEG’), w_MEG_SF, ’’,

h.i(’w’)+h.sub(MX), w_MX, ’’, h.i(’T’), T, units_T, ’use’, use, ’’)

x_MEG_SF = self.x_MEG_SF(2, w_MEG_SF)
b_MX_in_H2O_MEG
T += 273.15

= self.b_MX_in_H2O_MEG(1, w_MX)

elif dataType == 3:

# w_MX, m_H2O (g), m_MEG (g), T (°C)
w_MX, m_H2O, units_m_H2O, m_MEG, units_m_MEG, T, units_T, use = data
self.printVectors([’Rf0’]*4+[’Ls0’], h.i(’w’)+h.sub(MX), w_MX, ’’, h.i(’m’)+

h.sub(’H2O’), m_H2O, units_m_H2O, h.i(’m’)+h.sub(’MEG’), m_MEG, units_m_MEG,
h.i(’T’), T, units_T, ’use’, use,’’)
x_MEG_SF = self.x_MEG_SF(0, m_H2O, m_MEG)
b_MX_in_H2O_MEG = self.b_MX_in_H2O_MEG(1, w_MX)
T += 273.15

elif dataType == 4:

# w_H2O_SF, w_MX, T (K)
w_H2O_SF, w_MX, T, units_T, use = data
self.printVectors([’Rf0’]*3+[’Ls0’], h.i(’w’)+"’"+h.sub(’H2O’), w_H2O_SF, ’’,

h.i(’w’)+h.sub(MX), w_MX, ’’, h.i(’T’), T, units_T, ’use’, use, ’’)

x_MEG_SF = self.x_MEG_SF(1, w_H2O_SF)
b_MX_in_H2O_MEG = self.b_MX_in_H2O_MEG(1, w_MX)

elif dataType == 5:

# w_MEG_SF, w_MX, T (K)
w_MEG_SF, w_MX, T, units_T, use = data
self.printVectors([’Rf0’]*3+[’Ls0’], h.i(’w’)+"’"+h.sub(’MEG’), w_MEG_SF, ’’,

h.i(’w’)+h.sub(MX), w_MX, ’’, h.i(’T’), T, units_T, ’use’, use, ’’)

x_MEG_SF = self.x_MEG_SF(2, w_MEG_SF)
b_MX_in_H2O_MEG = self.b_MX_in_H2O_MEG(1, w_MX)

for x, b, t, u in zip(x_MEG_SF, b_MX_in_H2O_MEG, T, use):

if u == "REGR":

iBibRef_reg.append(iBibRef)
x_MEG_SF_reg = append(x_MEG_SF_reg, x)
b_MX_in_H2O_MEG_reg = append(b_MX_in_H2O_MEG_reg, b)
T_reg = append(T_reg, t)

elif u == "PRED":

iBibRef_prd.append(iBibRef)
x_MEG_SF_prd = append(x_MEG_SF_prd, x)
b_MX_in_H2O_MEG_prd = append(b_MX_in_H2O_MEG_prd, b)
T_prd = append(T_prd, t)

iBibRef += 1

def nl_regression(self, f_str, f_print, y_print, y_units, X, y, theta0):

self.printText(’<br>’+h.center(h.div(h.b(h.u(u’<br>RESUMO ESTATÍSTICO DOS MÍNIMOS ’

u’QUADRADOS NÃO LINEAR<br>’)), ’lightgray’, ’black’))+’<br>’)
self.printText(h.b(u’Função’)+’: ’+y_print+’ = ’+f_print+’<br>’)
if type(f_str) == tuple:

f, = f_str

else:

fstr = ’lambda ’+f_str
f = eval(fstr)

plusMinus = lambda a, b: (a-b, a+b)
theta_optimum, cov_theta_optimum = curve_fit(f, X, y, theta0)
N, P = X.shape[-1], theta_optimum.shape[-1]
y_optimum = f(X, *theta_optimum)
# Soma de Quadrados Total (TSS)
TSS_corrected, TSS_uncorrected = ((y-y.mean())**2).sum(), (y**2).sum()
# Soma de Quadrados dos Resíduos (RSS) ou Soma de Resíduos ao
# Quadrado (SSR) ou Soma de Erros de Predição ao Quadrado (SSE)

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

168

APÊNDICE D. Programa JAFOSSMS

641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700

RSS = ((y-y_optimum)**2).sum()
# Soma de Quadrados Explicada (ESS)
ESS_uncorrected = TSS_uncorrected-RSS
# Soma de Quadrados Total Média
MST_corrected = TSS_corrected/(N-1)
# Soma de Quadrados dos Resíduos Média
MSR = RSS/(N-P)
# Soma de Quadrados Explicada Média
MSE_uncorrected = ESS_uncorrected/P
alpha = 0.05
F_value_uncorrected = MSE_uncorrected/MSR
Pr_F_value_uncorrected = stats.f.sf(F_value_uncorrected, N-P, P)
s, R2, R2_bar = sqrt(MSR), 1-RSS/TSS_corrected, 1-MSR/MST_corrected
ASE = sqrt(cov_theta_optimum.diagonal())
corr_theta_optimum = (cov_theta_optimum/ASE).T/ASE
t_value, t_critical = theta_optimum/ASE, stats.t.isf(alpha/2., N-P)
Pr_tvalue = stats.t.sf(abs(t_value), N-P)*2.
CI_theta = plusMinus(theta_optimum, t_critical*ASE)
self.printVars(h.i(u’<br>α’), setSignificantFiguresPercent(alpha, 2), ’’)
table = self.createTable(4, 6)
self.writeLineInTable(table, 0, 0, map(h.b, [’Fonte’, ’GL’, ’Soma de Quadrados’,

u’Quadrado Médio’, h.i(’F’)+’-valor’, ’Pr(>’+h.i(’F’)+’)’]), ’Ch’ )
self.writeLineInTable(table, 1, 0, [u’Regressão’, u’Resíduo’, ’Total’,

’Total’+h.sub(’Corrigido’)], ’Cv’)

self.writeLineInTable(table, 1, 1, map(str, [P, N-P, N, N-1]))
self.writeLineInTable(table, 1, 2, map(lambda x: setSignificantFigures(x, 5),

[ESS_uncorrected, RSS, TSS_uncorrected, TSS_corrected]))

self.writeLineInTable(table, 1, 3, map(lambda x: setSignificantFigures(x, 5),

[MSE_uncorrected, MSR]))

self.writeCell(table, 1, 4, setSignificantFigures(F_value_uncorrected, 5), ’R’)
self.writeCell(table, 1, 5, setDecimalPlaces(Pr_F_value_uncorrected, 5), ’R’)
self.printVars(h.i(’s’), setSignificantFigures(s, 5), y_units, h.i(’R’)+h.sup(’2’),

setDecimalPlaces(R2, 5), ’’, h.i(’R’)+h.sup(’2’)+h.sub(’ajustado’),
setDecimalPlaces(R2_bar, 5), ’’, h.i(’<br>t’)+u’-crítico’,
setSignificantFigures(t_critical, 5) , ’’)

table = self.createTable(P+1, 7, 2, [(0, 0, 2, 1), (0, 1, 2, 1), (0, 2, 2, 1),

(0, 3, 2, 1), (0, 4, 2, 1), (0, 5, 1, 2)])

self.writeLineInTable(table, 1, 0, map(h.b, [u’Parâmetro’, ’Estimativa’, u’Erro Padrão<br>’

u’Assintótico’, h.i(’t’)+’-valor’, ’Pr(>|’+h.i(’t’)+’|)’, ’Inferior’, ’Superior’]),
’Ch’)

self.writeCell(table, 0, 5, h.b(u’Intervalo de Confiança<br>Assintótico ’+

setSignificantFigures((1-alpha)*100, 2)+’%’))

self.writeLineInTable(table, 2, 0, map(h.b, [u’θ’+h.sub(str(i)) for i in range(P)] ), ’Cv’)
for r in range(P):

N1 = decimalPlaces(significantFigures(t_critical, 5))
N2 = decimalPlaces(significantFigures(theta_optimum[r], 5))
self.writeLineInTable(table, r+2, 1, [setDecimalPlaces(theta_optimum[r], N2),

setDecimalPlaces(ASE[r], N2), setDecimalPlaces(t_value[r], N1),
setDecimalPlaces(Pr_tvalue[r], 5), setDecimalPlaces(CI_theta[0][r], N2),
setDecimalPlaces(CI_theta[1][r], N2)], ’Rh’)

self.printText(’<br><br>’+h.b(u’Matriz de Correlação Assintótica’)+’:’)
table = self.createTable(P, P+1, brushedLines=[(0, 0)])
self.writeCell(table, 0, 0, h.b(u’Parâmetro’))
self.writeLineInTable(table, 1, 0, map(h.b, [u’θ’+h.sub(str(i)) for i in range(P)] ), ’Cv’)
self.writeLineInTable(table, 0, 1, map(h.b, [u’θ’+h.sub(str(i)) for i in range(P)] ), ’Ch’)
for r in range(P):

for c in range(P):

self.writeCell(table, r+1, c+1, setDecimalPlaces(corr_theta_optimum[r][c], 5), ’R’)

self.printText(’<br><br>’)
self.calculateBasicStatistics(y_optimum, y, y_print, y_units)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

return f, theta_optimum

169

def calculateBasicStatistics(self, ycalc, yexp, y_print, y_units, i=0):

# Desvio Absoluto Médio
AAD = abs(yexp-ycalc).mean()
# Desvio Absoluto Máximo
maxAD = max(abs(yexp-ycalc))
self.printText(’Y = ’+y_print, i)
self.printVectors([’Rf-5’]*3+[’R%-2’], ’Y’+h.sub(’exp’), yexp, y_units, ’Y’+h.sub(’calc’),

ycalc, y_units, ’|Y’+h.sub(’exp’)+’-Y’+h.sub(’calc’)+’|’, abs(yexp-ycalc), y_units,
’|Y’+h.sub(’exp’)+’-Y’+h.sub(’calc’)+’|/Y’+h.sub(’exp’), abs((yexp-ycalc)/yexp), ’’, i)

Y = array([ [ye, yc] for ye, yc in zip(yexp, ycalc) if abs(ye*yc) > 1e-6 and

abs(yc/ye) < 10])

N, yexp, ycalc = len(yexp), Y.T[0], Y.T[1]
Nremoved = N-len(yexp)
# Desvio Relativo Absoluto Médio
AARD = abs((yexp-ycalc)/yexp).mean()
# Desvio Relativo Absoluto Máximo
maxARD = max(abs((yexp-ycalc)/yexp))
self.printVars(u’Desvio Absoluto Médio’, setDecimalPlaces(AAD, 5), y_units,

u’Desvio Absoluto Máximo’, setDecimalPlaces(maxAD, 5), y_units, i)

self.printText(’<br>’, i)
if Nremoved:

self.printVars(u’Desvio Relativo Absoluto Médio’+h.sup(’* ’), setDecimalPlacesPercent(

AARD, 2), ’’, u’Desvio Relativo Absoluto Máximo’+h.sup(’* ’),
setDecimalPlacesPercent(maxARD, 2), ’’, i)

if Nremoved == 1:

self.printText(’<br>* Foi desconsiderado 1 ponto experimental’, i)

else:

self.printText(’<br>* Foram desconsiderados ’+str(Nremoved)+

’ pontos experimentais’, i)

else:

self.printVars(u’Desvio Relativo Absoluto Médio’, setDecimalPlacesPercent(AARD, 2), ’’,
u’Desvio Relativo Absoluto Máximo’, setDecimalPlacesPercent(maxARD, 2), ’’, i)

return

def Molalities_in_SingleSolvents(self, T):

# Calcula as Molalidades do Sal em solventes simples
return f_b_MX_in_H2O(T, *theta_b_MX_in_H2O), f_b_MX_in_MEG(T, *theta_b_MX_in_MEG)

def f_excess(self, b_MX_in_H2O_MEG, x_MEG_SF, T):

# Calcula:
# mu0_MX_in_H2O_MEG_E_by_nuRT, ln_gamma_MX_in_H2O_MEG_E e
# ln_b_MX_in_H2O_MEG_E
b_MX_in_H2O, b_MX_in_MEG = self.Molalities_in_SingleSolvents(T)
A_phi_H2O = self.A_phi_H2O(T)
beta0_MX_H2O, beta1_MX_H2O, C_phi_MX_H2O = self.Pitzer_parameters(T)
ln_gamma_MX_in_H2O = self.ln_gamma_MX(b_MX_in_H2O, A_phi_H2O, beta0_MX_H2O, beta1_MX_H2O,

C_phi_MX_H2O)

ln_gamma_MX_in_MEG = self.ln_gamma_MX_in_MEG(ln_gamma_MX_in_H2O, b_MX_in_H2O, b_MX_in_MEG,

T)

rho_H2O, rho_MEG, epsilon_r_H2O, epsilon_r_MEG = self.rho_and_epsilon_r_of_pures(T)
A_phi_MEG, beta0_MX_MEG, C_phi_MX_MEG = self.A_phi_solv(A_phi_H2O, rho_H2O,

epsilon_r_H2O, rho_MEG, epsilon_r_MEG), beta0_MX_H2O, C_phi_MX_H2O

def fsolve_beta1_MX_MEG(beta1_MX_MEG):

return ln_gamma_MX_in_MEG - self.ln_gamma_MX(b_MX_in_MEG, A_phi_MEG, beta0_MX_MEG,

beta1_MX_MEG, C_phi_MX_MEG)

beta1_MX_MEG = fsolve(fsolve_beta1_MX_MEG, beta1_MX_H2O)
rho_H2O_MEG, epsilon_r_H2O_MEG = self.rho_and_epsilon_r_of_mixing(rho_H2O, rho_MEG,

epsilon_r_H2O, epsilon_r_MEG, x_MEG_SF, T)

701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

170

APÊNDICE D. Programa JAFOSSMS

761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820

A_phi_H2O_MEG = self.A_phi_solv(A_phi_H2O, rho_H2O, epsilon_r_H2O, rho_H2O_MEG,

epsilon_r_H2O_MEG)

beta0_MX_H2O_MEG, beta1_MX_H2O_MEG, C_phi_MX_H2O_MEG = self.Pitzer_parameters_in_mixtures(

beta0_MX_H2O, beta1_MX_H2O, beta1_MX_MEG, epsilon_r_H2O, epsilon_r_MEG,
epsilon_r_H2O_MEG, C_phi_MX_H2O)

ln_gamma_MX_in_H2O_MEG = self.ln_gamma_MX(b_MX_in_H2O_MEG, A_phi_H2O_MEG, beta0_MX_H2O_MEG,

beta1_MX_H2O_MEG, C_phi_MX_H2O_MEG)

ln_b_MX_in_H2O_MEG_id = self.linearMixingRule(log(b_MX_in_H2O), log(b_MX_in_MEG), x_MEG_SF)
ln_b_MX_in_H2O_MEG_E = self.excessProperty(log(b_MX_in_H2O_MEG), ln_b_MX_in_H2O_MEG_id)
ln_gamma_MX_in_H2O_MEG_id = self.linearMixingRule(ln_gamma_MX_in_H2O, ln_gamma_MX_in_MEG,

x_MEG_SF)

ln_gamma_MX_in_H2O_MEG_E = self.excessProperty(ln_gamma_MX_in_H2O_MEG,

ln_gamma_MX_in_H2O_MEG_id)

mu0_MX_in_H2O_MEG_E_by_nuRT = -ln_b_MX_in_H2O_MEG_E - ln_gamma_MX_in_H2O_MEG_E
return (mu0_MX_in_H2O_MEG_E_by_nuRT, ln_gamma_MX_in_H2O_MEG_E,

ln_b_MX_in_H2O_MEG_E, ln_gamma_MX_in_H2O_MEG)

def runCalculations(self):

if not QFile.exists(self.lineEdit_Datafile.text()):

self.pushButton_Run.setEnabled(False)
return

QApplication.setOverrideCursor(Qt.WaitCursor)
self.textEdit_GeneralReport.clear()
self.printText(h.title(u’<br>LEITURA, TRIAGEM E CONVERSÃO DAS UNIDADES DOS DADOS DE ’

u’EQUILÍBRIO<br>’, ’gray’, ’white’))

self.readDataset()
self.printText(’<br><br>’+h.b(u’DADOS DE EQUILÍBRIO ESCOLHIDOS PARA REGRESSÃO’)+’:’)
self.printVectors([’Rf-5’]*2+[’Rf-2’, ’Ls0’], h.i(’x’)+h.sub(’MEG’), x_MEG_SF_reg, ’’,
h.i(’b’)+h.sub(MX)+h.sup(’{H2O+MEG}’), b_MX_in_H2O_MEG_reg, u’mol·kg’+h.sup(’-1’),
h.i(’T’), T_reg, ’K’, u’Referência’, [BibRef[_] for _ in iBibRef_reg], ’’)

self.printText(h.b(’Total de pontos experimentais’)+’: ’+str(len(x_MEG_SF_reg)))
if x_MEG_SF_prd != []:

self.printText(’<br><br>’+h.b(u’DADOS DE EQUILÍBRIO ESCOLHIDOS PARA PREDICÃO’)+’:’)
self.printVectors([’Rf-5’]*2+[’Rf-2’, ’Ls0’], h.i(’x’)+h.sub(’MEG’), x_MEG_SF_prd, ’’,
h.i(’b’)+h.sub(MX)+h.sup(’{H2O+MEG}’), b_MX_in_H2O_MEG_prd, u’mol·kg’+h.sup(’-1’),
h.i(’T’), T_prd, ’K’, u’Referência’, [BibRef[_] for _ in iBibRef_prd], ’’)

self.printText(’<b>Total de pontos experimentais</b>: ’+str(len(x_MEG_SF_prd))+’’)

self.printText(’<br><br><br>’+h.title(u’<br>DADOS DE EQUILÍBRIO DE SOLUÇÕES DE ’+MX+’ EM ’

u’SOLVENTE SIMPLES PARA AJUSTE POR REGRESSÃO<br>’, ’gray’, ’white’))

global b_MX_in_H2O_reg, T_MX_in_H2O_reg, i_MX_in_H2O_reg
global b_MX_in_MEG_reg, T_MX_in_MEG_reg, i_MX_in_MEG_reg
b_MX_in_H2O_reg, T_MX_in_H2O_reg, i_MX_in_H2O_reg = [], [], []
b_MX_in_MEG_reg, T_MX_in_MEG_reg, i_MX_in_MEG_reg = [], [], []
for b, x , T , i in zip(b_MX_in_H2O_MEG_reg, x_MEG_SF_reg, T_reg, iBibRef_reg):

if x < 0.01:

multAppend(b_MX_in_H2O_reg, b, T_MX_in_H2O_reg, T, i_MX_in_H2O_reg, i)

elif x > 0.99:

multAppend(b_MX_in_MEG_reg, b, T_MX_in_MEG_reg, T, i_MX_in_MEG_reg, i)

(b_MX_in_H2O_reg, T_MX_in_H2O_reg, i_MX_in_H2O_reg, b_MX_in_MEG_reg, T_MX_in_MEG_reg,
i_MX_in_MEG_reg) = multToArray(b_MX_in_H2O_reg, T_MX_in_H2O_reg, i_MX_in_H2O_reg,
b_MX_in_MEG_reg, T_MX_in_MEG_reg, i_MX_in_MEG_reg)

self.printText(h.b(u’DADOS DE EQUILÍBRIO (H’+h.sub(’2’)+’O)’)+’:’)
self.printVectors([’Rf-5’, ’Rf-2’, ’Ls0’], h.i(’b’)+h.sub(MX)+h.sup(’{H2O}’),

b_MX_in_H2O_reg, u’mol·kg’+h.sup(’-1’), h.i(’T’), T_MX_in_H2O_reg, ’K’, u’Referência’,
[BibRef[_] for _ in i_MX_in_H2O_reg], ’’)

self.printText(h.b(’Total de pontos experimentais’)+’: ’+str(len(b_MX_in_H2O_reg)))
self.printText(u’<br><br><br>’+h.b(u’AJUSTE POR REGRESSÃO (H’+h.sub(’2’)+’O)’)+’:’)
fstr_b_MX_in_H2O = ’T, *theta: exp(theta[0]+theta[1]*T+theta[2]*log(T))’
fprint_b_MX_in_H2O = u’exp[θ’+h.sub(’0’)+u’ + θ’+h.sub(’1’)+u’·’+h.i(’T’)+u’ + θ’+h.sub(

’2’)+u’·ln(’+h.i(’T’)+’)]’

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

171

821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880

yprint_b_MX_in_H2O = h.i(’b’)+h.sub(MX)+h.sup(’{H2O}’)
global f_b_MX_in_H2O, theta_b_MX_in_H2O
f_b_MX_in_H2O, theta_b_MX_in_H2O = self.nl_regression(fstr_b_MX_in_H2O, fprint_b_MX_in_H2O,

yprint_b_MX_in_H2O, u’mol·kg’+h.sup(’-1’), T_MX_in_H2O_reg, b_MX_in_H2O_reg,
[1, .001, 1])

self.printText(’<br><br>’+h.b(u’DADOS DE EQUILÍBRIO (MEG)’)+’:’)
self.printVectors([’Rf-5’, ’Rf-2’, ’Ls0’], h.i(’b’)+h.sub(MX)+h.sup(’{MEG}’),

b_MX_in_MEG_reg, u’mol·kg’+h.sup(’-1’), h.i(’T’), T_MX_in_MEG_reg, ’K’, u’Referência’,
[BibRef[_] for _ in i_MX_in_MEG_reg], ’’)

self.printText(h.b(’Total de pontos experimentais’)+’: ’+str(len(b_MX_in_MEG_reg)))
self.printText(’<br><br><br>’+h.b(u’AJUSTE POR REGRESSÃO (MEG)’)+’:’)
fstr_b_MX_in_MEG = ’T, *theta: exp(theta[0]+theta[1]*T)’
fprint_b_MX_in_MEG = u’exp(θ’+h.sub(’0’)+u’ + θ’+h.sub(’1’)+u’·’+h.i(’T’)+’)’
yprint_b_MX_in_MEG = h.i(’b’)+h.sub(MX)+h.sup(’{MEG}’)
global f_b_MX_in_MEG, theta_b_MX_in_MEG
f_b_MX_in_MEG, theta_b_MX_in_MEG = self.nl_regression(fstr_b_MX_in_MEG, fprint_b_MX_in_MEG,
yprint_b_MX_in_MEG, u’mol·kg’+h.sup(’-1’), T_MX_in_MEG_reg, b_MX_in_MEG_reg, [1, .001])

global mu0_MX_in_H2O_MEG_E_by_nuRT_reg, ln_gamma_MX_in_H2O_MEG_E_reg
global ln_b_MX_in_H2O_MEG_E_reg, ln_gamma_MX_in_H2O_MEG_reg
(mu0_MX_in_H2O_MEG_E_by_nuRT_reg, ln_gamma_MX_in_H2O_MEG_E_reg,

ln_b_MX_in_H2O_MEG_E_reg, ln_gamma_MX_in_H2O_MEG_reg) = self.f_excess(

b_MX_in_H2O_MEG_reg, x_MEG_SF_reg, T_reg)

global mu0_MX_in_H2O_MEG_E_by_nuRT_prd, ln_gamma_MX_in_H2O_MEG_E_prd
global ln_b_MX_in_H2O_MEG_E_prd, ln_gamma_MX_in_H2O_MEG_prd
(mu0_MX_in_H2O_MEG_E_by_nuRT_prd, ln_gamma_MX_in_H2O_MEG_E_prd,

ln_b_MX_in_H2O_MEG_E_prd, ln_gamma_MX_in_H2O_MEG_prd) = self.f_excess(

b_MX_in_H2O_MEG_prd, x_MEG_SF_prd, T_prd)

self.printText(’<br><br>’+h.title(u’<br>DADOS DE EQUILÍBRIO DE SOLUÇÕES DE ’+MX+’ EM ’

u’MISTURA DE SOLVENTES PARA AJUSTE POR REGRESSÃO<br>’, ’gray’, ’white’))

def fstr_mu0_MX_in_H2O_MEG_E_by_nuRT(X,*a):

x,t,f=X[0],X[1],0
for i in range(0,len(a),2):

f += (a[i]+a[i+1]*t)*x**(i/2)

f *= x*(1-x)
return f

s0 = h.sub(MX)+h.sup(’{’+’H2O+MEG’+’}’)
s1 = ’x’+s0
fprint_mu0_MX_in_H2O_MEG_E_by_nuRT = s1+’(1-’+s1+u’)[θ’+h.sub(’0’)+u’+θ’+h.sub(’1’)+ \

u’T+(θ’+h.sub(’2’)+u’+θ’+h.sub(’3’)+’T)’+s1+u’+(θ’+h.sub(’4’)+u’+θ’+h.sub(’5’)+’T)’+ \
s1+h.sup(’2’)+’]’

yprint_mu0_MX_in_H2O_MEG_E_by_nuRT = u’[µ’+h.sup(’0’)+s0+’]’+h.sup(’E’)+u’/νRT’
global f_mu0_MX_in_H2O_MEG_E_by_nuRT, theta_mu0_MX_in_H2O_MEG_E_by_nuRT
self.printText(h.b(u’DADOS DE EQUILÍBRIO (H’+h.sub(’2’)+’O+MEG)’)+’:’)
self.printVectors([’Rf-5’]*2+[’Rf-2’, ’Ls0’], h.i(’x’)+h.sub(’MEG’), x_MEG_SF_reg, ’’,
h.i(’b’)+h.sub(MX)+h.sup(’{H2O+MEG}’), b_MX_in_H2O_MEG_reg, u’mol·kg’+h.sup(’-1’),
h.i(’T’), T_reg, ’K’, u’Referência’, [BibRef[_] for _ in iBibRef_reg], ’’)

self.printText(h.b(’Total de pontos experimentais’)+’: ’+str(len(x_MEG_SF_reg))+’<br>’)
theta0 = random.rand(6)*100-200
(f_mu0_MX_in_H2O_MEG_E_by_nuRT, theta_mu0_MX_in_H2O_MEG_E_by_nuRT) = self.nl_regression((

fstr_mu0_MX_in_H2O_MEG_E_by_nuRT, ), fprint_mu0_MX_in_H2O_MEG_E_by_nuRT,
yprint_mu0_MX_in_H2O_MEG_E_by_nuRT, ’’, array([x_MEG_SF_reg, T_reg]),
mu0_MX_in_H2O_MEG_E_by_nuRT_reg, theta0)

self.pushButton_Run.setEnabled(False)
self.tabWidget.setEnabled(True)
QApplication.restoreOverrideCursor()

def f_plot(self, i):

if i:

T_choice = self.validateIsotherms(None)
if len(T_choice) < 1:

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

172

APÊNDICE D. Programa JAFOSSMS

881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940

return

QApplication.setOverrideCursor(Qt.WaitCursor)
canvas.ax.clear()
self.textEdit_Statistics.clear()
self.printText(h.title(u’<br>RESUMO ESTATÍSTICO BÁSICO<br>’, ’gray’, ’white’), 1)
comboBoxs = [(self.comboBox_Plot1_y_C, self.comboBox_Plot1_y_solv,

self.comboBox_Plot1_y_C, self.comboBox_Plot1_x_T, self.comboBox_Plot1_y_solv),
(self.comboBox_Plot2_x_C_SF, self.comboBox_Plot2_x_solv,
self.comboBox_Plot2_y_C, self.comboBox_Isotherms_T, self.comboBox_Isotherms_mode),
(self.comboBox_Plot3_x_C_SF, self.comboBox_Plot3_x_solv,
self.comboBox_Plot3_y_F, self.comboBox_Isotherms_T, self.comboBox_Isotherms_mode),
(self.comboBox_Plot4_x_C_SF, self.comboBox_Plot4_x_solv,
self.comboBox_Plot4_y_F_E, self.comboBox_Isotherms_T, self.comboBox_Isotherms_mode)][i]

i_C, i_solv, i_F, i_T, i_mode = (_.currentIndex() for _ in comboBoxs)
solv = [’MEG’, ’H_2O’][i_solv]
ssolv = [’MEG’, ’H2O’][i_solv]
s0, s1, f_T = r’\{\rm{’, r’}\}}_{\rm{’+MX+’}}’, lambda _: convertT(_, i_T)
ss0 = h.sub(MX)
unitsC = lambda _: [r’\ \left(\rm{mol\cdot ’+[’kg’, ’L’][_%2]+’^{-1}}\\right)’, ’’][_//2]
uunitsC = lambda _: [u’mol·’+[’kg’, ’L’][_%2]+h.sup(’-1’), ’’][_//2]
if i:

s0 += ’H_2O+MEG’+s1
ss0 += h.sup(’{’+’H2O+MEG’+’}’)
f0_x = lambda _: self.convertC_SF(_, i_C)
f_x = [lambda _: f0_x(_), lambda _: 1-f0_x(_)][i_solv]
xLabel = ’xw’[i_C]+r"’_{\rm{"+solv+’}}’
if i == 1:

f_y = lambda *_: self.convertC(_[0], _[1], _[2], i_F)
yLabel = ’bcxw’[i_F]+’^{’+s0+unitsC(i_F)
y_print, y_units = ’bcxw’[i_F]+ss0, uunitsC(i_F)

elif i == 2:

f_y, yLabel = [lambda *_: exp(_[0]), lambda *_: _[0]][i_F], \

r’\ln\ ’*i_F+r’\gamma^{’+s0

y_print, y_units = ’ln ’*i_F+u’γ’+ss0, ’’

else:

f_y, yLabel = lambda *_: _[0], ’{\\left[\\’+[’mu^{0’, r’ln\ \gamma^{’,
r’ln\ b^{’][i_F]+s0+r’\right]}^{\rm{E}}’+r’ / {\nu RT}’*(not i_F)

y_print, y_units = ’[’+[u’µ’+h.sup(’0’), u’ln γ’, ’ln b’][i_F]+ \

ss0+’]’+h.sup(’E’)+u’/νRT’*(not i_F), ’’

else:

f_x = f_T
xLabel = r’T\ \left(\rm{’+UNITS_T[i_T]+r’}\right)’
f_y = lambda *_: self.convertC(_[0], _[1], _[2], i_F)
yLabel = ’bcxw’[i_F]+’^{’+s0+solv+s1+unitsC(i_F)
y_print, y_units = ’bcxw’[i_F]+ss0+h.sup(’{’+ssolv+’}’), uunitsC(i_F)

xLabel, yLabel = ’$’+xLabel+’$’, ’$’+yLabel+’$’
def selectPoints(x_all, T_all, T):

return array([x for _, x in enumerate(x_all) if abs(T_all[_]-T) < 0.05])

def minmaxPlot(x, sizeExpansion=5, onlyPositive=False):

xMin, xMax, n = min(x), max(x), 100/sizeExpansion
dx = abs(xMax-xMin) / n
if onlyPositive:

return (xMin-dx) * (xMin-dx > 0), xMax+dx

return xMin-dx, xMax+dx

global handles, labels
handles, labels = [], []
Ycurve, Ypoints, nPoints = array([]), array([]), 50
x_all, T_all, i_all = [(x_MEG_SF_reg, T_reg, iBibRef_reg), (x_MEG_SF_prd, T_prd,

iBibRef_prd)][i_mode]

color, marker = f_gen(COLORS), f_gen(MARKERS)

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS

173

941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000

if i:

if i_mode == 0 and i == 3 and i_F == 0 and set(T_choice).issubset(set(T_all)):

self.printText(u’Apresenta-se aqui uma estatística básica referente somente a{0} ’
u’isoterma{0} selecionada{0}. A estatística completa da regressão encontra-se ’
u’na aba "RELATÓRIO GERAL"<br><br>’.format(’s’*(len(T_choice) > 1)), 1)

xMin, xMax, yMin, yMax = 0, 1, None, None
x_MEG_SF_0 = linspace(xMin, xMax, nPoints)
def fsolve_b_MX_in_H2O_MEG(b_MX_in_H2O_MEG, mu0_MX_in_H2O_MEG_E_by_nuRT, x_MEG_SF, T):
return mu0_MX_in_H2O_MEG_E_by_nuRT-self.f_excess(b_MX_in_H2O_MEG, x_MEG_SF, T)[0]

Plots, MARKERs, iBibRefs = [], [], []
Plot = mlines.Line2D([], [], color=’k’, linestyle =’-’, lw=2)
handles.append(Plot)
labels.append(’Modelo JAFOSSMS’)
for j, Tj in enumerate(T_choice):

x_MEG_SF = concatenate((x_MEG_SF_0, selectPoints(x_all, T_all, Tj)))
mu0_MX_in_H2O_MEG_E_by_nuRT = f_mu0_MX_in_H2O_MEG_E_by_nuRT([x_MEG_SF, Tj],

*theta_mu0_MX_in_H2O_MEG_E_by_nuRT)

b_MX_in_H2O, b_MX_in_MEG = self.Molalities_in_SingleSolvents(Tj)
b_MX_in_H2O_MEG = fsolve(fsolve_b_MX_in_H2O_MEG, self.linearMixingRule(b_MX_in_H2O,

b_MX_in_MEG, x_MEG_SF), args=(mu0_MX_in_H2O_MEG_E_by_nuRT, x_MEG_SF, Tj))

if i == 1:

y = f_y(b_MX_in_H2O_MEG, x_MEG_SF, Tj)
y_all = [b_MX_in_H2O_MEG_reg, b_MX_in_H2O_MEG_prd][i_mode]

else:

k = 3-(3-i_F)*(i == 3)
y = f_y(self.f_excess(b_MX_in_H2O_MEG, x_MEG_SF, Tj)[k])
y_all = [(mu0_MX_in_H2O_MEG_E_by_nuRT_reg, ln_gamma_MX_in_H2O_MEG_E_reg,

ln_b_MX_in_H2O_MEG_E_reg, ln_gamma_MX_in_H2O_MEG_reg), (
mu0_MX_in_H2O_MEG_E_by_nuRT_prd, ln_gamma_MX_in_H2O_MEG_E_prd,
ln_b_MX_in_H2O_MEG_E_prd, ln_gamma_MX_in_H2O_MEG_prd)][i_mode][k]

yMin = min(yMin, min(y)) if yMin else min(y)
yMax = max(yMax, max(y)) if yMax else max(y)
x, T = f_x(x_MEG_SF), f_T(Tj)
COLOR = color.next()
xCurve, yCurve, xPoints = x[:nPoints], y[:nPoints], x[nPoints:]
canvas.ax.plot(xCurve, yCurve, COLOR+’-’, lw=2)
Plot = mpatches.Patch(color=COLOR)
handles.insert(j, Plot)
labels.insert(j, toStr(T)+’ ’+UNITS_T[i_T]+(’ (’+MODE[i_mode]+’)’)*(i_mode == 1

or i == 3 and i_F == 0 and set(T_choice).issubset(set(T_all))))

if len(xPoints):

yPoints = f_y(selectPoints(y_all, T_all, Tj), x_MEG_SF[nPoints:], Tj)
yMin, yMax= min(yMin, min(yPoints)), max(yMax, max(yPoints))
iPoints = selectPoints(i_all, T_all, Tj)
for k in list(set(iPoints)):

xPoints_k = [x_k for (x_k, i_k) in zip(xPoints, iPoints) if i_k == k]
yPoints_k = [y_k for (y_k, i_k) in zip(yPoints, iPoints) if i_k == k]
if k in iBibRefs:

MARKER = MARKERs[iBibRefs.index(k)]
Plot = mlines.Line2D([], [], color=’w’, marker=MARKER[0],

markersize=MARKER[1])

else:

MARKER = marker.next()
Plot = mlines.Line2D([], [], color=’w’, marker=MARKER[0],

markersize=MARKER[1])

multAppend(handles, Plot, labels, BibRef[k])
multAppend(MARKERs, MARKER, iBibRefs, k)

Plots.append([xPoints_k, yPoints_k, COLOR, MARKER])

yCurve = y[nPoints:]
Ycurve, Ypoints = concatenate((Ycurve, yCurve)), concatenate((Ypoints,

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

174

APÊNDICE D. Programa JAFOSSMS

yPoints))

for Plot in Plots:

canvas.ax.plot(Plot[0], Plot[1], Plot[2]+Plot[3][0], markersize=Plot[3][1])

else:

self.printText(u’A estatística completa da regressão encontra-se na aba "RELATÓRIO ’

’GERAL"<br><br>’, 1)

(b_MX_in_solv, T_MX_in_solv, i_MX_in_solv, f_b_MX_in_solv, theta_b_MX_in_solv, x_MEG_SF

) = [(b_MX_in_MEG_reg, T_MX_in_MEG_reg, i_MX_in_MEG_reg, f_b_MX_in_MEG,
theta_b_MX_in_MEG, 1), (b_MX_in_H2O_reg, T_MX_in_H2O_reg, i_MX_in_H2O_reg,
f_b_MX_in_H2O, theta_b_MX_in_H2O, 0)][i_solv]

xMin, xMax = minmaxPlot(T_MX_in_solv)
xMin *= (xMin > 0)
T = linspace(xMin, xMax, nPoints)
xCurve, yCurve = f_x(T), f_y(f_b_MX_in_solv(T, *theta_b_MX_in_solv), x_MEG_SF, T)
xMin, xMax, yMin, yMax = min(xCurve), max(xCurve), min(yCurve), max(yCurve)
labels.append(u’Regressão’)
COLOR = color.next()
Plot, = canvas.ax.plot(xCurve, yCurve, COLOR+’-’, lw=2)
handles.append(Plot)
iBibRef = list(set(i_MX_in_solv))
for j, k in enumerate(iBibRef):

T = array([T for T, _ in zip(T_MX_in_solv, i_MX_in_solv) if _ == k])
xPoints = f_x(T)
yPoints = f_y(array([b for b, _ in zip(b_MX_in_solv, i_MX_in_solv) if _ == k]

), x_MEG_SF, T)

xMin, xMax, yMin, yMax = (min(xMin, min(xPoints)), max(xMax, max(xPoints)),

min(yMin, min(yPoints)), max(yMax, max(yPoints)))

COLOR, MARKER = color.next(), marker.next()
Plot, = canvas.ax.plot(xPoints, yPoints, COLOR+MARKER[0], markersize=MARKER[1])
multAppend(handles, Plot, labels, BibRef[k])
yCurve = f_y(f_b_MX_in_solv(T, *theta_b_MX_in_solv), x_MEG_SF, T)
Ycurve, Ypoints = concatenate((Ycurve, yCurve)), concatenate((Ypoints, yPoints))

self.calculateBasicStatistics(Ycurve, Ypoints, y_print, y_units, 1)
self.changeSize(1)
canvas.ax.set_xlabel(xLabel)
canvas.ax.set_ylabel(yLabel)
canvas.ax.grid(True)
canvas.ax.set_xlim(minmaxPlot(array([xMin, xMax])))
canvas.ax.set_ylim(minmaxPlot(array([yMin, yMax])))
self.changeSize(2)
self.tabWidget.setTabEnabled(3, True)
self.tabWidget.setCurrentIndex(3)
QApplication.restoreOverrideCursor()

def main():

app = QApplication(sys.argv)
form = JAFOSSMS()
form.show()
sys.exit(app.exec_())

if __name__ == ’__main__’:

main()

1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

APÊNDICE D. Programa JAFOSSMS
D.6 Arquivo com Dados de Entrada

175

Nestes arquivos os itens em cada linha são separados por ponto e vírgula (;),
sendo que todos os espaços e tabulações imediatamente antes e imediatamente após o
ponto e vírgula são desconsiderados como informação, possuindo efeito apenas cosmético.
O primeiro item em cada linha signiﬁca o tipo da variável apresentada ou, caso seja
nulo (espaços e/ou tabulações), signiﬁca a continuação da informação referente a variável
anteriormente apresentada. Os tipos das variáveis podem ser: int, float, str e unicode,
ou ainda o tipo com aplicação especial: vectors, que é utilizado na citação de variáveis
que são vetores. Por meio deste tipo especial, declara-se os vetores nas colunas formadas
pela separação de idêntica quantidade de ponto e vírgula, sendo que na primeira linha de
cada coluna é citado o tipo do vetor, na segunda o nome do vetor, na terceira as unidades
dos dados contidos no vetor e, por último, nas linhas seguintes, os dados do vetor. Todos
os dados do tipo float devem utilizar vírgula (,) como ponto decimal.

D.6.1 Arquivo principal

Neste arquivo, as linhas de 1 a 5 informa o vetor ions, ou seja, o vetor com o nome
do cátion e do ânion. As linha 6 e 7 informam as variáveis respectivamente z_M e z_X,
ou seja, as cargas dos íons. As linha 8 e 9 informam as variáveis respectivamente nu_M
e nu_X, ou seja, os coeﬁcientes estequiométricos dos íons. As linha 10 e 11 informam as
variáveis respectivamente M_MX e Delta_tr_G0_H2O_to_MEG, ou seja, respectivamente a
massa molar de MX e a Energia Livre de Gibbs de Transferência da água para o MEG.
As linhas seguintes contém o vetor DataFilename com o nome dos arquivos com dados de
equilíbrio a serem utilizados.

Como exemplo, segue o arquivo de dados de entrada principal, utilizado nesta tese

de doutorado, para o KCl:

Principal.in

vectors ; str
; ions
;
; K
; Cl
; z_M ; 1
; z_X ; 1
; nu_M ; 1
; nu_X ; 1
; M_MX ; 74,5550 ; g·mol<sup>-1</sup>
; Delta_tr_G0_H2O_to_MEG ; 7000 ; J·mol<sup>-1</sup>

int
int
int
int
float
float
vectors ; str

; DataFilename
;
; data_KCl_Chiavone-Filho1993.dat
; data_KCl_Isbin1945.dat
; data_KCl_Kraus1964.dat
; data_KCl_Lide2009.dat

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18

José Augusto Furtado de Oliveira, Junho/2014

Tese de Doutorado. PPGEQ/UFRN

APÊNDICE D. Programa JAFOSSMS

176

19
20
21

; data_KCl_Linke1965.dat
; data_KCl_Trimble1931.dat
; data_KCl_Zhou2010.dat

D.6.2 Arquivo especíﬁco

Neste arquivo, a linha 1 informa a variável BibRef, ou seja, a variável que contém
a informação de referência bibliográﬁca dos sados experimentais presentes neste arquivo.
A linha 2 informa a variável DataType, ou seja, o número de referência das unidades dos
dados experimentais presentes no arquivo. As linhas seguintes contém o vetores com os
dados de equilíbrio contidos na respectivas variáveis citadas na linha 4.

Como exemplo, segue um dos arquivos de dados de entrada especíﬁco que contém

um conjunto de dados de equilíbrio, utilizado nesta tese de doutorado, para o KCl:

Experimentos.dat

1
2
3
4
5
6
7
8
9
10
11

; BibRef ; Trimble (1931)
; DataType ; 1

str
int
vectors ; float

; float

; float ; float ; str

; g

; g

; w_MEG_SF ; m_H2O_MEG ; m_KCl ; T
;
; °C
;
;
;
;
;
;

100 ; 37,18 ;
100 ; 28,16 ;
100 ; 19,80 ;
100 ; 13,43 ;
100 ; 8,40 ;
100 ; 5,37 ;

0,0000 ;
0,1933 ;
0,4010 ;
0,5898 ;
0,7942 ;
1,0000 ;

; usage
;

30 ; REGR
30 ; REGR
30 ; REGR
30 ; REGR
30 ; REGR
30 ; REGR

Tese de Doutorado. PPGEQ/UFRN

José Augusto Furtado de Oliveira, Junho/2014

